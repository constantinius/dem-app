var O=Object.defineProperty;var E=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var L=(a,t,e)=>t in a?O(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,U=(a,t)=>{for(var e in t||(t={}))W.call(t,e)&&L(a,e,t[e]);if(E)for(var e of E(t))G.call(t,e)&&L(a,e,t[e]);return a};import{c as V,G as A,W as R,a as q,o as K,T as Z,b as J,M as Q,d as X,V as Y,e as u,f as d,r as $,g as l,t as x,h as ee,i as g,w as h,v as te,j as w,k as c,F as I,l as H,m as b,p as ae,n as se,q as k,s as ie,u as le}from"./vendor.a0180028.js";const ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}};ne();const z=["band",1];function N(a,t,e){return["/",["-",a,["var",t]],["-",["var",e],["var",t]]]}function v(a,t){return["band",1,a,t]}function P(a){const t=1/a.length,e=[];e.push(0),e.push([0,0,0,0]);for(let o=0;o<a.length;++o)e.push(o*t),e.push(a[o]);return e.push(1),e.push([0,0,0,0]),e}function oe(a){return["-",a,["%",a,1]]}function D(a,t){return["abs",["-",a,t]]}function _(a,t,e){return oe(["/",["+",a,["var",t]],["var",e]])}function re(a,t,e="offset",o="spacing",s="min",n="max"){return["interpolate",["linear"],["*",["clamp",["+",D(_(["band",1],e,o),_(v(1,0),e,o)),D(_(["band",1],e,o),_(v(0,1),e,o))],0,1],N(z,s,n)],...P(a)]}function ue(a,t="vert",e="sunEl",o="sunAz"){const s=["*",3e-5,["var",t]],n=["*",2,["resolution"]],r=["*",s,v(-1,0)],i=["*",s,v(1,0)],f=["/",["-",i,r],n],T=["*",s,v(0,-1)],j=["*",s,v(0,1)],C=["/",["-",j,T],n],S=["atan",["^",["+",["^",f,2],["^",C,2]],.5]],B=["clamp",["atan",["-",0,f],C],-Math.PI,Math.PI],M=["*",Math.PI/180,["var",e]],F=["*",Math.PI/180,["var",o]],y=["+",["*",["sin",M],["cos",S]],["*",["*",["cos",M],["sin",S]],["cos",["-",F,B]]]];return["color",["*",255,y],["*",255,y],["*",255,y],["match",z,0,0,1]]}function de(a,t,e="min",o="max"){return["interpolate",["linear"],N(z,e,o),...P(a)]}var p=(a,t)=>{const e=a.__vccOpts||a;for(const[o,s]of t)e[o]=s;return e};const ce={props:{variables:Object,tiffUrl:String},async mounted(){await this.initiateMap()},computed:{renderVariables(){if(this.variables.visualization=="relief")return{vert:this.variables.vert,sunEl:this.variables.sunEl,sunAz:this.variables.sunAz};if(this.variables.visualization=="contours")return{offset:this.variables.offset,spacing:this.variables.spacing,min:this.variables.min,max:this.variables.max};if(this.variables.visualization=="shaded")return{min:this.variables.min,max:this.variables.max}},renderStyle(){if(this.variables.visualization=="relief")return ue(-9999,"vert","sunEl","sunAz");if(this.variables.visualization=="contours"){const a=V({colormap:this.variables.colorscale,format:"rgba",nshades:16});return re(a,-9999,"offset","spacing","min","max")}else if(this.variables.visualization=="shaded"){const a=V({colormap:this.variables.colorscale,format:"rgba",nshades:16});return de(a,-9999,"min","max")}}},watch:{"variables.visualization"(){this.demLayer.styleVariables_=this.renderVariables,this.demLayer.setStyle({color:this.renderStyle,variables:this.renderVariables})},"variables.colorscale"(){this.variables.visualization!=="relief"&&(this.demLayer.styleVariables_=this.renderVariables,this.demLayer.setStyle({color:this.renderStyle,variables:this.renderVariables}))},renderVariables(a){this.demLayer.updateStyleVariables(a)}},methods:{resetDemSource(){this.demSource=new A({normalize:!1,sources:[{url:this.tiffUrl,nodata:-9999}]}),this.demSource.setAttributions("European Environment Agency (EAA)"),this.demLayer&&this.demLayer.setSource(this.demSource)},resetDemLayer(){this.demLayer&&this.map.removeLayer(this.demLayer),this.demLayer=new R({source:this.source,style:{variables:this.renderVariables,color:this.renderStyle}}),this.map.addLayer(this.demLayer)},async initiateMap(){const a=await fetch("https://tiles.maps.eox.at/wmts/1.0.0/WMTSCapabilities.xml"),t=new q().read(await a.text()),e="s2cloudless-2020",o=t.Contents.Layer.filter(i=>i.Identifier===e)[0].Abstract,s=K(t,{layer:e,matrixSet:"EPSG:4326"}),n=new Z({source:new J(U({attributions:o},s))});this.source=new A({normalize:!1,sources:[{url:this.tiffUrl,nodata:-9999}]}),this.source.setAttributions("European Environment Agency (EAA)"),this.map=new Q({target:this.$refs.map,controls:X({attribution:!0}),layers:[n],view:new Y({projection:"EPSG:4326",center:[0,0],zoom:2})});const r=await this.source.getView();this.map.getView().fit(r.extent),this.resetDemLayer()}}},me={id:"map",ref:"map"};function ve(a,t,e,o,s,n){return u(),d("div",me,[$(a.$slots,"default")],512)}var fe=p(ce,[["render",ve]]);const he={props:{modelValue:Number,label:String,min:Number,max:Number,step:Number},methods:{handleInput(a){this.$emit("update:modelValue",parseInt(a.target.value))}}},be={class:"mui-textfield",style:{display:"flex"}},_e=["value","min","max","step"],pe=["value","min","max","step"];function ye(a,t,e,o,s,n){return u(),d("div",be,[l("input",{value:e.modelValue,type:"range",min:e.min,max:e.max,step:e.step,style:{cursor:"initial","flex-grow":"2"},onInput:t[0]||(t[0]=(...r)=>n.handleInput&&n.handleInput(...r))},null,40,_e),l("input",{value:e.modelValue,type:"number",min:e.min,max:e.max,step:e.step,style:{width:"auto","flex-grow":"0","margin-left":"20px"},onInput:t[1]||(t[1]=(...r)=>n.handleInput&&n.handleInput(...r))},null,40,pe),l("label",null,x(e.label),1)])}var Ve=p(he,[["render",ye],["__scopeId","data-v-1fb7a1ba"]]);const xe={props:{tiffUrl:String,variables:Object},components:{InputSlider:Ve},data(){return{availableColormaps:Object.keys(ee).sort()}},mounted(){this.renderColorscalePreview()},methods:{renderColorscalePreview(){const a=this.variables.colorscale,t=this.$refs["colormap-preview"];if(t){const e=t.getContext("2d"),o=48,s=V({colormap:a,nshades:o,format:"rgbaString"});t.width=480,t.height=90;for(let n=0;n<o;n++)e.fillStyle=s[n],e.fillRect(n*10,0,10,90)}}},watch:{"variables.visualization"(a){a!=="relief"&&this.$nextTick(()=>{this.renderColorscalePreview()})},"variables.colorscale"(){this.renderColorscalePreview()}}},m=a=>(ae("data-v-19943710"),a=a(),se(),a),ge={class:"container mui-panel mui-container mui-form"},we=m(()=>l("legend",null,"Visualization Settings",-1)),ze={class:"mui-textfield"},Ce=m(()=>l("label",null,"URL",-1)),Se={class:"mui-select"},Me=m(()=>l("option",{value:"relief"},"Relief",-1)),Ee=m(()=>l("option",{value:"contours"},"Contours",-1)),Le=m(()=>l("option",{value:"shaded"},"Shaded",-1)),Ue=[Me,Ee,Le],Ae=m(()=>l("label",null,"Mode",-1)),Ie={key:0},He={key:1},ke={class:"mui-row"},Ne={class:"mui-col-md-4"},Pe={class:"mui-select"},De=["value"],Te=m(()=>l("label",null," Colorscale ",-1)),je={class:"mui-col-md-8"},Be={ref:"colormap-preview",style:{width:"100%"}},Fe={key:2},Oe={class:"mui-row"},We={class:"mui-col-md-4"},Ge={class:"mui-select"},Re=["value"],qe=m(()=>l("label",null," Colorscale ",-1)),Ke={class:"mui-col-md-8"},Ze={ref:"colormap-preview",style:{width:"100%"}};function Je(a,t,e,o,s,n){const r=g("input-slider");return u(),d("div",ge,[we,l("div",ze,[Ce,h(l("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.tiffUrl=i),type:"text"},null,512),[[te,e.tiffUrl]])]),l("div",Se,[h(l("select",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.variables.visualization=i)},Ue,512),[[w,e.variables.visualization]]),Ae]),e.variables.visualization=="relief"?(u(),d("div",Ie,[c(r,{modelValue:e.variables.vert,"onUpdate:modelValue":t[2]||(t[2]=i=>e.variables.vert=i),label:"Vertical Exaggeration",min:1,max:5},null,8,["modelValue"]),c(r,{modelValue:e.variables.sunEl,"onUpdate:modelValue":t[3]||(t[3]=i=>e.variables.sunEl=i),label:"Sun Elevation",min:0,max:90},null,8,["modelValue"]),c(r,{modelValue:e.variables.sunAz,"onUpdate:modelValue":t[4]||(t[4]=i=>e.variables.sunAz=i),label:"Sun Azimuth",min:0,max:360},null,8,["modelValue"])])):e.variables.visualization=="contours"?(u(),d("div",He,[l("div",ke,[l("div",Ne,[l("div",Pe,[h(l("select",{"onUpdate:modelValue":t[5]||(t[5]=i=>e.variables.colorscale=i)},[(u(!0),d(I,null,H(s.availableColormaps,i=>(u(),d("option",{key:i,value:i},x(i),9,De))),128))],512),[[w,e.variables.colorscale]]),Te])]),l("div",je,[l("canvas",Be,null,512)])]),c(r,{modelValue:e.variables.offset,"onUpdate:modelValue":t[6]||(t[6]=i=>e.variables.offset=i),label:"Offset",min:0,max:200},null,8,["modelValue"]),c(r,{modelValue:e.variables.spacing,"onUpdate:modelValue":t[7]||(t[7]=i=>e.variables.spacing=i),label:"Spacing",min:0,max:500},null,8,["modelValue"]),c(r,{modelValue:e.variables.min,"onUpdate:modelValue":t[8]||(t[8]=i=>e.variables.min=i),label:"Elevation Minimum",min:0,max:8800},null,8,["modelValue"]),c(r,{modelValue:e.variables.max,"onUpdate:modelValue":t[9]||(t[9]=i=>e.variables.max=i),label:"Elevation Maximum",min:0,max:8800,step:10},null,8,["modelValue"])])):e.variables.visualization=="shaded"?(u(),d("div",Fe,[l("div",Oe,[l("div",We,[l("div",Ge,[h(l("select",{"onUpdate:modelValue":t[10]||(t[10]=i=>e.variables.colorscale=i)},[(u(!0),d(I,null,H(s.availableColormaps,i=>(u(),d("option",{key:i,value:i},x(i),9,Re))),128))],512),[[w,e.variables.colorscale]]),qe])]),l("div",Ke,[l("canvas",Ze,null,512)])]),c(r,{modelValue:e.variables.min,"onUpdate:modelValue":t[11]||(t[11]=i=>e.variables.min=i),label:"Elevation Minimum",min:0,max:8800},null,8,["modelValue"]),c(r,{modelValue:e.variables.max,"onUpdate:modelValue":t[12]||(t[12]=i=>e.variables.max=i),label:"Elevation Maximum",min:0,max:8800,step:10},null,8,["modelValue"])])):b("",!0)])}var Qe=p(xe,[["render",Je],["__scopeId","data-v-19943710"]]);const Xe={name:"App",components:{Map:fe,DemControl:Qe},data(){return{tiffUrl:"./src/assets/Copernicus_DSM_30_N03_00_E016_00_DEM.tif",variables:{visualization:"shaded",colorscale:"jet",min:360,max:700,offset:0,spacing:100,vert:1,sunEl:45,sunAz:45},showControls:window.innerWidth>700}}},Ye={id:"dem-control"},$e={class:"ol-control",style:{top:"0",right:"0"}},et=l("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M3,17V19H9V17H3M3,5V7H13V5H3M13,21V19H21V17H13V15H11V21H13M7,9V11H3V13H7V15H9V9H7M21,13V11H11V13H21M15,9H17V7H21V5H17V3H15V9Z"})],-1),tt=[et],at=l("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M20,14H4V10H20"})],-1),st=[at];function it(a,t,e,o,s,n){const r=g("DemControl"),i=g("Map");return u(),k(i,{variables:s.variables,tiffUrl:s.tiffUrl},{default:ie(()=>[l("aside",Ye,[l("div",$e,[s.showControls?b("",!0):(u(),d("button",{key:0,id:"expand-control",class:"mui-btn mui-btn--primary",onClick:t[0]||(t[0]=f=>s.showControls=!0)},tt))]),s.showControls?(u(),k(r,{key:0,variables:s.variables,tiffUrl:s.tiffUrl},null,8,["variables","tiffUrl"])):b("",!0),s.showControls?(u(),d("button",{key:1,id:"contract-control",class:"mui-btn",onClick:t[1]||(t[1]=f=>s.showControls=!1)},st)):b("",!0)])]),_:1},8,["variables","tiffUrl"])}var lt=p(Xe,[["render",it]]);le(lt).mount("#app");
