var B=Object.defineProperty;var E=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var L=(a,t,e)=>t in a?B(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,M=(a,t)=>{for(var e in t||(t={}))F.call(t,e)&&L(a,e,t[e]);if(E)for(var e of E(t))W.call(t,e)&&L(a,e,t[e]);return a};import{c as V,G as U,W as G,a as O,o as R,T as q,b as K,M as Z,d as J,V as Q,e as u,f as c,r as X,g as l,t as x,h as Y,i as w,w as h,v as $,j as g,k as m,F as A,l as I,m as b,p as ee,n as te,q as H,s as ae,u as se}from"./vendor.a0180028.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}};ie();function k(a,t,e){return["/",["-",a,["var",t]],["-",["var",e],["var",t]]]}function d(a=0,t=0){return a===0&&t===0?["band",1]:["band",1,a,t]}function le(a){return["-",a,["%",a,1]]}function N(a,t){return["abs",["-",a,t]]}function _(a,t,e){return le(["/",["+",a,["var",t]],["var",e]])}function ne(a,t,e="offset",o="spacing",s="min",n="max"){return["case",["between",d(),["var",s],["var",n]],["palette",["*",["*",["clamp",["+",N(_(d(),e,o),_(d(1,0),e,o)),N(_(d(),e,o),_(d(0,1),e,o))],0,1],k(d(),s,n)],a.length+1],[[0,0,0,0],...a]],["color",0,0,0,0]]}function oe(a,t="vert",e="sunEl",o="sunAz"){const s=["*",3e-5,["var",t]],n=["*",2,["resolution"]],r=["*",s,d(-1,0)],i=["*",s,d(1,0)],f=["/",["-",i,r],n],P=["*",s,d(0,-1)],D=["*",s,d(0,1)],z=["/",["-",D,P],n],S=["atan",["^",["+",["^",f,2],["^",z,2]],.5]],T=["clamp",["atan",["-",0,f],z],-Math.PI,Math.PI],C=["*",Math.PI/180,["var",e]],j=["*",Math.PI/180,["var",o]],y=["+",["*",["sin",C],["cos",S]],["*",["*",["cos",C],["sin",S]],["cos",["-",j,T]]]];return["color",["*",255,y],["*",255,y],["*",255,y],["match",d(),0,0,1]]}function re(a,t,e="min",o="max"){return["case",["between",d(),["var",e],["var",o]],["palette",["*",k(d(),e,o),a.length],a],["color",0,0,0,0]]}var p=(a,t)=>{const e=a.__vccOpts||a;for(const[o,s]of t)e[o]=s;return e};const ue={props:{variables:Object,tiffUrl:String},async mounted(){await this.initiateMap()},computed:{renderVariables(){if(this.variables.visualization=="relief")return{vert:this.variables.vert,sunEl:this.variables.sunEl,sunAz:this.variables.sunAz};if(this.variables.visualization=="contours")return{offset:this.variables.offset,spacing:this.variables.spacing,min:this.variables.min,max:this.variables.max};if(this.variables.visualization=="shaded")return{min:this.variables.min,max:this.variables.max}},renderStyle(){if(this.variables.visualization=="relief")return oe(-9999,"vert","sunEl","sunAz");if(this.variables.visualization=="contours"){const a=V({colormap:this.variables.colorscale,format:"rgba",nshades:16});return ne(a,-9999,"offset","spacing","min","max")}else if(this.variables.visualization=="shaded"){const a=V({colormap:this.variables.colorscale,format:"rgba",nshades:16});return re(a,-9999,"min","max")}}},watch:{"variables.visualization"(){this.demLayer.styleVariables_=this.renderVariables,this.demLayer.setStyle({color:this.renderStyle,variables:this.renderVariables})},"variables.colorscale"(){this.variables.visualization!=="relief"&&(this.demLayer.styleVariables_=this.renderVariables,this.demLayer.setStyle({color:this.renderStyle,variables:this.renderVariables}))},renderVariables(a){this.demLayer.updateStyleVariables(a)}},methods:{resetDemSource(){this.demSource=new U({normalize:!1,sources:[{url:this.tiffUrl,nodata:-9999}]}),this.demSource.setAttributions("European Environment Agency (EAA)"),this.demLayer&&this.demLayer.setSource(this.demSource)},resetDemLayer(){this.demLayer&&this.map.removeLayer(this.demLayer),this.demLayer=new G({source:this.source,style:{variables:this.renderVariables,color:this.renderStyle}}),this.map.addLayer(this.demLayer)},async initiateMap(){const a=await fetch("https://tiles.maps.eox.at/wmts/1.0.0/WMTSCapabilities.xml"),t=new O().read(await a.text()),e="s2cloudless-2020",o=t.Contents.Layer.filter(i=>i.Identifier===e)[0].Abstract,s=R(t,{layer:e,matrixSet:"EPSG:4326"}),n=new q({source:new K(M({attributions:o},s))});this.source=new U({normalize:!1,sources:[{url:this.tiffUrl,nodata:-9999}]}),this.source.setAttributions("European Environment Agency (EAA)"),this.map=new Z({target:this.$refs.map,controls:J({attribution:!0}),layers:[n],view:new Q({projection:"EPSG:4326",center:[0,0],zoom:2})});const r=await this.source.getView();this.map.getView().fit(r.extent),this.resetDemLayer()}}},de={id:"map",ref:"map"};function ce(a,t,e,o,s,n){return u(),c("div",de,[X(a.$slots,"default")],512)}var me=p(ue,[["render",ce]]);const ve={props:{modelValue:Number,label:String,min:Number,max:Number,step:Number},methods:{handleInput(a){this.$emit("update:modelValue",parseInt(a.target.value))}}},fe={class:"mui-textfield",style:{display:"flex"}},he=["value","min","max","step"],be=["value","min","max","step"];function _e(a,t,e,o,s,n){return u(),c("div",fe,[l("input",{value:e.modelValue,type:"range",min:e.min,max:e.max,step:e.step,style:{cursor:"initial","flex-grow":"2"},onInput:t[0]||(t[0]=(...r)=>n.handleInput&&n.handleInput(...r))},null,40,he),l("input",{value:e.modelValue,type:"number",min:e.min,max:e.max,step:e.step,style:{width:"auto","flex-grow":"0","margin-left":"20px"},onInput:t[1]||(t[1]=(...r)=>n.handleInput&&n.handleInput(...r))},null,40,be),l("label",null,x(e.label),1)])}var pe=p(ve,[["render",_e],["__scopeId","data-v-1fb7a1ba"]]);const ye={props:{tiffUrl:String,variables:Object},components:{InputSlider:pe},data(){return{availableColormaps:Object.keys(Y).sort()}},mounted(){this.renderColorscalePreview()},methods:{renderColorscalePreview(){const a=this.variables.colorscale,t=this.$refs["colormap-preview"];if(t){const e=t.getContext("2d"),o=48,s=V({colormap:a,nshades:o,format:"rgbaString"});t.width=480,t.height=90;for(let n=0;n<o;n++)e.fillStyle=s[n],e.fillRect(n*10,0,10,90)}}},watch:{"variables.visualization"(a){a!=="relief"&&this.$nextTick(()=>{this.renderColorscalePreview()})},"variables.colorscale"(){this.renderColorscalePreview()}}},v=a=>(ee("data-v-19943710"),a=a(),te(),a),Ve={class:"container mui-panel mui-container mui-form"},xe=v(()=>l("legend",null,"Visualization Settings",-1)),we={class:"mui-textfield"},ge=v(()=>l("label",null,"URL",-1)),ze={class:"mui-select"},Se=v(()=>l("option",{value:"relief"},"Relief",-1)),Ce=v(()=>l("option",{value:"contours"},"Contours",-1)),Ee=v(()=>l("option",{value:"shaded"},"Shaded",-1)),Le=[Se,Ce,Ee],Me=v(()=>l("label",null,"Mode",-1)),Ue={key:0},Ae={key:1},Ie={class:"mui-row"},He={class:"mui-col-md-4"},ke={class:"mui-select"},Ne=["value"],Pe=v(()=>l("label",null," Colorscale ",-1)),De={class:"mui-col-md-8"},Te={ref:"colormap-preview",style:{width:"100%"}},je={key:2},Be={class:"mui-row"},Fe={class:"mui-col-md-4"},We={class:"mui-select"},Ge=["value"],Oe=v(()=>l("label",null," Colorscale ",-1)),Re={class:"mui-col-md-8"},qe={ref:"colormap-preview",style:{width:"100%"}};function Ke(a,t,e,o,s,n){const r=w("input-slider");return u(),c("div",Ve,[xe,l("div",we,[ge,h(l("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.tiffUrl=i),type:"text"},null,512),[[$,e.tiffUrl]])]),l("div",ze,[h(l("select",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.variables.visualization=i)},Le,512),[[g,e.variables.visualization]]),Me]),e.variables.visualization=="relief"?(u(),c("div",Ue,[m(r,{modelValue:e.variables.vert,"onUpdate:modelValue":t[2]||(t[2]=i=>e.variables.vert=i),label:"Vertical Exaggeration",min:1,max:5},null,8,["modelValue"]),m(r,{modelValue:e.variables.sunEl,"onUpdate:modelValue":t[3]||(t[3]=i=>e.variables.sunEl=i),label:"Sun Elevation",min:0,max:90},null,8,["modelValue"]),m(r,{modelValue:e.variables.sunAz,"onUpdate:modelValue":t[4]||(t[4]=i=>e.variables.sunAz=i),label:"Sun Azimuth",min:0,max:360},null,8,["modelValue"])])):e.variables.visualization=="contours"?(u(),c("div",Ae,[l("div",Ie,[l("div",He,[l("div",ke,[h(l("select",{"onUpdate:modelValue":t[5]||(t[5]=i=>e.variables.colorscale=i)},[(u(!0),c(A,null,I(s.availableColormaps,i=>(u(),c("option",{key:i,value:i},x(i),9,Ne))),128))],512),[[g,e.variables.colorscale]]),Pe])]),l("div",De,[l("canvas",Te,null,512)])]),m(r,{modelValue:e.variables.offset,"onUpdate:modelValue":t[6]||(t[6]=i=>e.variables.offset=i),label:"Offset",min:0,max:200},null,8,["modelValue"]),m(r,{modelValue:e.variables.spacing,"onUpdate:modelValue":t[7]||(t[7]=i=>e.variables.spacing=i),label:"Spacing",min:0,max:500},null,8,["modelValue"]),m(r,{modelValue:e.variables.min,"onUpdate:modelValue":t[8]||(t[8]=i=>e.variables.min=i),label:"Elevation Minimum",min:0,max:8800},null,8,["modelValue"]),m(r,{modelValue:e.variables.max,"onUpdate:modelValue":t[9]||(t[9]=i=>e.variables.max=i),label:"Elevation Maximum",min:0,max:8800,step:10},null,8,["modelValue"])])):e.variables.visualization=="shaded"?(u(),c("div",je,[l("div",Be,[l("div",Fe,[l("div",We,[h(l("select",{"onUpdate:modelValue":t[10]||(t[10]=i=>e.variables.colorscale=i)},[(u(!0),c(A,null,I(s.availableColormaps,i=>(u(),c("option",{key:i,value:i},x(i),9,Ge))),128))],512),[[g,e.variables.colorscale]]),Oe])]),l("div",Re,[l("canvas",qe,null,512)])]),m(r,{modelValue:e.variables.min,"onUpdate:modelValue":t[11]||(t[11]=i=>e.variables.min=i),label:"Elevation Minimum",min:0,max:8800},null,8,["modelValue"]),m(r,{modelValue:e.variables.max,"onUpdate:modelValue":t[12]||(t[12]=i=>e.variables.max=i),label:"Elevation Maximum",min:0,max:8800,step:10},null,8,["modelValue"])])):b("",!0)])}var Ze=p(ye,[["render",Ke],["__scopeId","data-v-19943710"]]);const Je={name:"App",components:{Map:me,DemControl:Ze},data(){return{tiffUrl:"./src/assets/Copernicus_DSM_30_N03_00_E016_00_DEM.tif",variables:{visualization:"shaded",colorscale:"jet",min:360,max:700,offset:0,spacing:100,vert:1,sunEl:45,sunAz:45},showControls:window.innerWidth>700}}},Qe={id:"dem-control"},Xe={class:"ol-control",style:{top:"0",right:"0"}},Ye=l("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M3,17V19H9V17H3M3,5V7H13V5H3M13,21V19H21V17H13V15H11V21H13M7,9V11H3V13H7V15H9V9H7M21,13V11H11V13H21M15,9H17V7H21V5H17V3H15V9Z"})],-1),$e=[Ye],et=l("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M20,14H4V10H20"})],-1),tt=[et];function at(a,t,e,o,s,n){const r=w("DemControl"),i=w("Map");return u(),H(i,{variables:s.variables,tiffUrl:s.tiffUrl},{default:ae(()=>[l("aside",Qe,[l("div",Xe,[s.showControls?b("",!0):(u(),c("button",{key:0,id:"expand-control",class:"mui-btn mui-btn--primary",onClick:t[0]||(t[0]=f=>s.showControls=!0)},$e))]),s.showControls?(u(),H(r,{key:0,variables:s.variables,tiffUrl:s.tiffUrl},null,8,["variables","tiffUrl"])):b("",!0),s.showControls?(u(),c("button",{key:1,id:"contract-control",class:"mui-btn",onClick:t[1]||(t[1]=f=>s.showControls=!1)},tt)):b("",!0)])]),_:1},8,["variables","tiffUrl"])}var st=p(Je,[["render",at]]);se(st).mount("#app");
