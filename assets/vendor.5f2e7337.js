var Xh=Object.defineProperty,Hh=Object.defineProperties;var Zh=Object.getOwnPropertyDescriptors;var oi=Object.getOwnPropertySymbols;var fl=Object.prototype.hasOwnProperty,hl=Object.prototype.propertyIsEnumerable;var dl=(r,t,e)=>t in r?Xh(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,An=(r,t)=>{for(var e in t||(t={}))fl.call(t,e)&&dl(r,e,t[e]);if(oi)for(var e of oi(t))hl.call(t,e)&&dl(r,e,t[e]);return r},On=(r,t)=>Hh(r,Zh(t));var Pn=(r,t)=>{var e={};for(var n in r)fl.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&oi)for(var n of oi(r))t.indexOf(n)<0&&hl.call(r,n)&&(e[n]=r[n]);return e};function Wh(r,t){return t.forEach(function(e){e&&typeof e!="string"&&!Array.isArray(e)&&Object.keys(e).forEach(function(n){if(n!=="default"&&!(n in r)){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})}),Object.freeze(r)}function Bo(r,t){const e=Object.create(null),n=r.split(",");for(let i=0;i<n.length;i++)e[n[i]]=!0;return t?i=>!!e[i.toLowerCase()]:i=>!!e[i]}const Yh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",qh=Bo(Yh);function pl(r){return!!r||r===""}function $o(r){if(Q(r)){const t={};for(let e=0;e<r.length;e++){const n=r[e],i=ze(n)?ed(n):$o(n);if(i)for(const o in i)t[o]=i[o]}return t}else{if(ze(r))return r;if(ke(r))return r}}const Qh=/;(?![^(]*\))/g,Jh=/:(.+)/;function ed(r){const t={};return r.split(Qh).forEach(e=>{if(e){const n=e.split(Jh);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function zo(r){let t="";if(ze(r))t=r;else if(Q(r))for(let e=0;e<r.length;e++){const n=zo(r[e]);n&&(t+=n+" ")}else if(ke(r))for(const e in r)r[e]&&(t+=e+" ");return t.trim()}function td(r,t){if(r.length!==t.length)return!1;let e=!0;for(let n=0;e&&n<r.length;n++)e=ai(r[n],t[n]);return e}function ai(r,t){if(r===t)return!0;let e=vl(r),n=vl(t);if(e||n)return e&&n?r.getTime()===t.getTime():!1;if(e=Q(r),n=Q(t),e||n)return e&&n?td(r,t):!1;if(e=ke(r),n=ke(t),e||n){if(!e||!n)return!1;const i=Object.keys(r).length,o=Object.keys(t).length;if(i!==o)return!1;for(const a in r){const s=r.hasOwnProperty(a),l=t.hasOwnProperty(a);if(s&&!l||!s&&l||!ai(r[a],t[a]))return!1}}return String(r)===String(t)}function rd(r,t){return r.findIndex(e=>ai(e,t))}const Pb=r=>r==null?"":Q(r)||ke(r)&&(r.toString===yl||!re(r.toString))?JSON.stringify(r,gl,2):String(r),gl=(r,t)=>t&&t.__v_isRef?gl(r,t.value):$r(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[n,i])=>(e[`${n} =>`]=i,e),{})}:li(t)?{[`Set(${t.size})`]:[...t.values()]}:ke(t)&&!Q(t)&&!ml(t)?String(t):t,we={},Br=[],yt=()=>{},nd=()=>!1,id=/^on[^a-z]/,si=r=>id.test(r),Ko=r=>r.startsWith("onUpdate:"),Ze=Object.assign,Vo=(r,t)=>{const e=r.indexOf(t);e>-1&&r.splice(e,1)},od=Object.prototype.hasOwnProperty,ce=(r,t)=>od.call(r,t),Q=Array.isArray,$r=r=>ui(r)==="[object Map]",li=r=>ui(r)==="[object Set]",vl=r=>r instanceof Date,re=r=>typeof r=="function",ze=r=>typeof r=="string",Xo=r=>typeof r=="symbol",ke=r=>r!==null&&typeof r=="object",_l=r=>ke(r)&&re(r.then)&&re(r.catch),yl=Object.prototype.toString,ui=r=>yl.call(r),ad=r=>ui(r).slice(8,-1),ml=r=>ui(r)==="[object Object]",Ho=r=>ze(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,ci=Bo(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),fi=r=>{const t=Object.create(null);return e=>t[e]||(t[e]=r(e))},sd=/-(\w)/g,St=fi(r=>r.replace(sd,(t,e)=>e?e.toUpperCase():"")),ld=/\B([A-Z])/g,zr=fi(r=>r.replace(ld,"-$1").toLowerCase()),hi=fi(r=>r.charAt(0).toUpperCase()+r.slice(1)),Zo=fi(r=>r?`on${hi(r)}`:""),di=(r,t)=>!Object.is(r,t),pi=(r,t)=>{for(let e=0;e<r.length;e++)r[e](t)},gi=(r,t,e)=>{Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value:e})},vi=r=>{const t=parseFloat(r);return isNaN(t)?r:t};let Tl;const ud=()=>Tl||(Tl=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let pr;const _i=[];class cd{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&pr&&(this.parent=pr,this.index=(pr.scopes||(pr.scopes=[])).push(this)-1)}run(t){if(this.active)try{return this.on(),t()}finally{this.off()}}on(){this.active&&(_i.push(this),pr=this)}off(){this.active&&(_i.pop(),pr=_i[_i.length-1])}stop(t){if(this.active){if(this.effects.forEach(e=>e.stop()),this.cleanups.forEach(e=>e()),this.scopes&&this.scopes.forEach(e=>e.stop(!0)),this.parent&&!t){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.active=!1}}}function fd(r,t){t=t||pr,t&&t.active&&t.effects.push(r)}const Wo=r=>{const t=new Set(r);return t.w=0,t.n=0,t},El=r=>(r.w&Qt)>0,xl=r=>(r.n&Qt)>0,hd=({deps:r})=>{if(r.length)for(let t=0;t<r.length;t++)r[t].w|=Qt},dd=r=>{const{deps:t}=r;if(t.length){let e=0;for(let n=0;n<t.length;n++){const i=t[n];El(i)&&!xl(i)?i.delete(r):t[e++]=i,i.w&=~Qt,i.n&=~Qt}t.length=e}},Yo=new WeakMap;let In=0,Qt=1;const qo=30,Mn=[];let gr;const vr=Symbol(""),Qo=Symbol("");class Jo{constructor(t,e=null,n){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],fd(this,n)}run(){if(!this.active)return this.fn();if(!Mn.includes(this))try{return Mn.push(gr=this),pd(),Qt=1<<++In,In<=qo?hd(this):bl(this),this.fn()}finally{In<=qo&&dd(this),Qt=1<<--In,_r(),Mn.pop();const t=Mn.length;gr=t>0?Mn[t-1]:void 0}}stop(){this.active&&(bl(this),this.onStop&&this.onStop(),this.active=!1)}}function bl(r){const{deps:t}=r;if(t.length){for(let e=0;e<t.length;e++)t[e].delete(r);t.length=0}}let Kr=!0;const ea=[];function Vr(){ea.push(Kr),Kr=!1}function pd(){ea.push(Kr),Kr=!0}function _r(){const r=ea.pop();Kr=r===void 0?!0:r}function it(r,t,e){if(!wl())return;let n=Yo.get(r);n||Yo.set(r,n=new Map);let i=n.get(e);i||n.set(e,i=Wo()),Cl(i)}function wl(){return Kr&&gr!==void 0}function Cl(r,t){let e=!1;In<=qo?xl(r)||(r.n|=Qt,e=!El(r)):e=!r.has(gr),e&&(r.add(gr),gr.deps.push(r))}function jt(r,t,e,n,i,o){const a=Yo.get(r);if(!a)return;let s=[];if(t==="clear")s=[...a.values()];else if(e==="length"&&Q(r))a.forEach((l,u)=>{(u==="length"||u>=n)&&s.push(l)});else switch(e!==void 0&&s.push(a.get(e)),t){case"add":Q(r)?Ho(e)&&s.push(a.get("length")):(s.push(a.get(vr)),$r(r)&&s.push(a.get(Qo)));break;case"delete":Q(r)||(s.push(a.get(vr)),$r(r)&&s.push(a.get(Qo)));break;case"set":$r(r)&&s.push(a.get(vr));break}if(s.length===1)s[0]&&ta(s[0]);else{const l=[];for(const u of s)u&&l.push(...u);ta(Wo(l))}}function ta(r,t){for(const e of Q(r)?r:[...r])(e!==gr||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const gd=Bo("__proto__,__v_isRef,__isVue"),Rl=new Set(Object.getOwnPropertyNames(Symbol).map(r=>Symbol[r]).filter(Xo)),vd=ra(),_d=ra(!1,!0),yd=ra(!0),Sl=md();function md(){const r={};return["includes","indexOf","lastIndexOf"].forEach(t=>{r[t]=function(...e){const n=_e(this);for(let o=0,a=this.length;o<a;o++)it(n,"get",o+"");const i=n[t](...e);return i===-1||i===!1?n[t](...e.map(_e)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{r[t]=function(...e){Vr();const n=_e(this)[t].apply(this,e);return _r(),n}}),r}function ra(r=!1,t=!1){return function(n,i,o){if(i==="__v_isReactive")return!r;if(i==="__v_isReadonly")return r;if(i==="__v_raw"&&o===(r?t?kd:Nl:t?kl:Ll).get(n))return n;const a=Q(n);if(!r&&a&&ce(Sl,i))return Reflect.get(Sl,i,o);const s=Reflect.get(n,i,o);return(Xo(i)?Rl.has(i):gd(i))||(r||it(n,"get",i),t)?s:et(s)?!a||!Ho(i)?s.value:s:ke(s)?r?Fl(s):oa(s):s}}const Td=Al(),Ed=Al(!0);function Al(r=!1){return function(e,n,i,o){let a=e[n];if(!r&&!sa(i)&&(i=_e(i),a=_e(a),!Q(e)&&et(a)&&!et(i)))return a.value=i,!0;const s=Q(e)&&Ho(n)?Number(n)<e.length:ce(e,n),l=Reflect.set(e,n,i,o);return e===_e(o)&&(s?di(i,a)&&jt(e,"set",n,i):jt(e,"add",n,i)),l}}function xd(r,t){const e=ce(r,t);r[t];const n=Reflect.deleteProperty(r,t);return n&&e&&jt(r,"delete",t,void 0),n}function bd(r,t){const e=Reflect.has(r,t);return(!Xo(t)||!Rl.has(t))&&it(r,"has",t),e}function wd(r){return it(r,"iterate",Q(r)?"length":vr),Reflect.ownKeys(r)}const Ol={get:vd,set:Td,deleteProperty:xd,has:bd,ownKeys:wd},Cd={get:yd,set(r,t){return!0},deleteProperty(r,t){return!0}},Rd=Ze({},Ol,{get:_d,set:Ed}),na=r=>r,yi=r=>Reflect.getPrototypeOf(r);function mi(r,t,e=!1,n=!1){r=r.__v_raw;const i=_e(r),o=_e(t);t!==o&&!e&&it(i,"get",t),!e&&it(i,"get",o);const{has:a}=yi(i),s=n?na:e?ua:la;if(a.call(i,t))return s(r.get(t));if(a.call(i,o))return s(r.get(o));r!==i&&r.get(t)}function Ti(r,t=!1){const e=this.__v_raw,n=_e(e),i=_e(r);return r!==i&&!t&&it(n,"has",r),!t&&it(n,"has",i),r===i?e.has(r):e.has(r)||e.has(i)}function Ei(r,t=!1){return r=r.__v_raw,!t&&it(_e(r),"iterate",vr),Reflect.get(r,"size",r)}function Pl(r){r=_e(r);const t=_e(this);return yi(t).has.call(t,r)||(t.add(r),jt(t,"add",r,r)),this}function Il(r,t){t=_e(t);const e=_e(this),{has:n,get:i}=yi(e);let o=n.call(e,r);o||(r=_e(r),o=n.call(e,r));const a=i.call(e,r);return e.set(r,t),o?di(t,a)&&jt(e,"set",r,t):jt(e,"add",r,t),this}function Ml(r){const t=_e(this),{has:e,get:n}=yi(t);let i=e.call(t,r);i||(r=_e(r),i=e.call(t,r)),n&&n.call(t,r);const o=t.delete(r);return i&&jt(t,"delete",r,void 0),o}function Dl(){const r=_e(this),t=r.size!==0,e=r.clear();return t&&jt(r,"clear",void 0,void 0),e}function xi(r,t){return function(n,i){const o=this,a=o.__v_raw,s=_e(a),l=t?na:r?ua:la;return!r&&it(s,"iterate",vr),a.forEach((u,c)=>n.call(i,l(u),l(c),o))}}function bi(r,t,e){return function(...n){const i=this.__v_raw,o=_e(i),a=$r(o),s=r==="entries"||r===Symbol.iterator&&a,l=r==="keys"&&a,u=i[r](...n),c=e?na:t?ua:la;return!t&&it(o,"iterate",l?Qo:vr),{next(){const{value:f,done:h}=u.next();return h?{value:f,done:h}:{value:s?[c(f[0]),c(f[1])]:c(f),done:h}},[Symbol.iterator](){return this}}}}function Jt(r){return function(...t){return r==="delete"?!1:this}}function Sd(){const r={get(o){return mi(this,o)},get size(){return Ei(this)},has:Ti,add:Pl,set:Il,delete:Ml,clear:Dl,forEach:xi(!1,!1)},t={get(o){return mi(this,o,!1,!0)},get size(){return Ei(this)},has:Ti,add:Pl,set:Il,delete:Ml,clear:Dl,forEach:xi(!1,!0)},e={get(o){return mi(this,o,!0)},get size(){return Ei(this,!0)},has(o){return Ti.call(this,o,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:xi(!0,!1)},n={get(o){return mi(this,o,!0,!0)},get size(){return Ei(this,!0)},has(o){return Ti.call(this,o,!0)},add:Jt("add"),set:Jt("set"),delete:Jt("delete"),clear:Jt("clear"),forEach:xi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{r[o]=bi(o,!1,!1),e[o]=bi(o,!0,!1),t[o]=bi(o,!1,!0),n[o]=bi(o,!0,!0)}),[r,e,t,n]}const[Ad,Od,Pd,Id]=Sd();function ia(r,t){const e=t?r?Id:Pd:r?Od:Ad;return(n,i,o)=>i==="__v_isReactive"?!r:i==="__v_isReadonly"?r:i==="__v_raw"?n:Reflect.get(ce(e,i)&&i in n?e:n,i,o)}const Md={get:ia(!1,!1)},Dd={get:ia(!1,!0)},Ld={get:ia(!0,!1)},Ll=new WeakMap,kl=new WeakMap,Nl=new WeakMap,kd=new WeakMap;function Nd(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Fd(r){return r.__v_skip||!Object.isExtensible(r)?0:Nd(ad(r))}function oa(r){return r&&r.__v_isReadonly?r:aa(r,!1,Ol,Md,Ll)}function Ud(r){return aa(r,!1,Rd,Dd,kl)}function Fl(r){return aa(r,!0,Cd,Ld,Nl)}function aa(r,t,e,n,i){if(!ke(r)||r.__v_raw&&!(t&&r.__v_isReactive))return r;const o=i.get(r);if(o)return o;const a=Fd(r);if(a===0)return r;const s=new Proxy(r,a===2?n:e);return i.set(r,s),s}function Xr(r){return sa(r)?Xr(r.__v_raw):!!(r&&r.__v_isReactive)}function sa(r){return!!(r&&r.__v_isReadonly)}function Ul(r){return Xr(r)||sa(r)}function _e(r){const t=r&&r.__v_raw;return t?_e(t):r}function Gl(r){return gi(r,"__v_skip",!0),r}const la=r=>ke(r)?oa(r):r,ua=r=>ke(r)?Fl(r):r;function Gd(r){wl()&&(r=_e(r),r.dep||(r.dep=Wo()),Cl(r.dep))}function jd(r,t){r=_e(r),r.dep&&ta(r.dep)}function et(r){return Boolean(r&&r.__v_isRef===!0)}function Bd(r){return et(r)?r.value:r}const $d={get:(r,t,e)=>Bd(Reflect.get(r,t,e)),set:(r,t,e,n)=>{const i=r[t];return et(i)&&!et(e)?(i.value=e,!0):Reflect.set(r,t,e,n)}};function jl(r){return Xr(r)?r:new Proxy(r,$d)}class zd{constructor(t,e,n){this._setter=e,this.dep=void 0,this._dirty=!0,this.__v_isRef=!0,this.effect=new Jo(t,()=>{this._dirty||(this._dirty=!0,jd(this))}),this.__v_isReadonly=n}get value(){const t=_e(this);return Gd(t),t._dirty&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function Kd(r,t){let e,n;const i=re(r);return i?(e=r,n=yt):(e=r.get,n=r.set),new zd(e,n,i||!n)}Promise.resolve();function Vd(r,t,...e){const n=r.vnode.props||we;let i=e;const o=t.startsWith("update:"),a=o&&t.slice(7);if(a&&a in n){const c=`${a==="modelValue"?"model":a}Modifiers`,{number:f,trim:h}=n[c]||we;h?i=e.map(d=>d.trim()):f&&(i=e.map(vi))}let s,l=n[s=Zo(t)]||n[s=Zo(St(t))];!l&&o&&(l=n[s=Zo(zr(t))]),l&&dt(l,r,6,i);const u=n[s+"Once"];if(u){if(!r.emitted)r.emitted={};else if(r.emitted[s])return;r.emitted[s]=!0,dt(u,r,6,i)}}function Bl(r,t,e=!1){const n=t.emitsCache,i=n.get(r);if(i!==void 0)return i;const o=r.emits;let a={},s=!1;if(!re(r)){const l=u=>{const c=Bl(u,t,!0);c&&(s=!0,Ze(a,c))};!e&&t.mixins.length&&t.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!o&&!s?(n.set(r,null),null):(Q(o)?o.forEach(l=>a[l]=null):Ze(a,o),n.set(r,a),a)}function ca(r,t){return!r||!si(t)?!1:(t=t.slice(2).replace(/Once$/,""),ce(r,t[0].toLowerCase()+t.slice(1))||ce(r,zr(t))||ce(r,t))}let ft=null,wi=null;function Ci(r){const t=ft;return ft=r,wi=r&&r.type.__scopeId||null,t}function Ib(r){wi=r}function Mb(){wi=null}function Xd(r,t=ft,e){if(!t||r._n)return r;const n=(...i)=>{n._d&&du(-1);const o=Ci(t),a=r(...i);return Ci(o),n._d&&du(1),a};return n._n=!0,n._c=!0,n._d=!0,n}function fa(r){const{type:t,vnode:e,proxy:n,withProxy:i,props:o,propsOptions:[a],slots:s,attrs:l,emit:u,render:c,renderCache:f,data:h,setupState:d,ctx:p,inheritAttrs:g}=r;let _,x;const T=Ci(r);try{if(e.shapeFlag&4){const y=i||n;_=Pt(c.call(y,y,f,o,d,h,p)),x=l}else{const y=t;_=Pt(y.length>1?y(o,{attrs:l,slots:s,emit:u}):y(o,null)),x=t.props?l:Hd(l)}}catch(y){Dn.length=0,Li(y,r,1),_=$t(Ot)}let E=_;if(x&&g!==!1){const y=Object.keys(x),{shapeFlag:w}=E;y.length&&w&(1|6)&&(a&&y.some(Ko)&&(x=Zd(x,a)),E=Hr(E,x))}return e.dirs&&(E.dirs=E.dirs?E.dirs.concat(e.dirs):e.dirs),e.transition&&(E.transition=e.transition),_=E,Ci(T),_}const Hd=r=>{let t;for(const e in r)(e==="class"||e==="style"||si(e))&&((t||(t={}))[e]=r[e]);return t},Zd=(r,t)=>{const e={};for(const n in r)(!Ko(n)||!(n.slice(9)in t))&&(e[n]=r[n]);return e};function Wd(r,t,e){const{props:n,children:i,component:o}=r,{props:a,children:s,patchFlag:l}=t,u=o.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return n?$l(n,a,u):!!a;if(l&8){const c=t.dynamicProps;for(let f=0;f<c.length;f++){const h=c[f];if(a[h]!==n[h]&&!ca(u,h))return!0}}}else return(i||s)&&(!s||!s.$stable)?!0:n===a?!1:n?a?$l(n,a,u):!0:!!a;return!1}function $l(r,t,e){const n=Object.keys(t);if(n.length!==Object.keys(r).length)return!0;for(let i=0;i<n.length;i++){const o=n[i];if(t[o]!==r[o]&&!ca(e,o))return!0}return!1}function Yd({vnode:r,parent:t},e){for(;t&&t.subTree===r;)(r=t.vnode).el=e,t=t.parent}const qd=r=>r.__isSuspense;function Qd(r,t){t&&t.pendingBranch?Q(r)?t.effects.push(...r):t.effects.push(r):tg(r)}function Jd(r,t){if(je){let e=je.provides;const n=je.parent&&je.parent.provides;n===e&&(e=je.provides=Object.create(n)),e[r]=t}}function ha(r,t,e=!1){const n=je||ft;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&r in i)return i[r];if(arguments.length>1)return e&&re(t)?t.call(n.proxy):t}}function ep(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Hl(()=>{r.isMounted=!0}),Zl(()=>{r.isUnmounting=!0}),r}const ht=[Function,Array],tp={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ht,onEnter:ht,onAfterEnter:ht,onEnterCancelled:ht,onBeforeLeave:ht,onLeave:ht,onAfterLeave:ht,onLeaveCancelled:ht,onBeforeAppear:ht,onAppear:ht,onAfterAppear:ht,onAppearCancelled:ht},setup(r,{slots:t}){const e=zp(),n=ep();let i;return()=>{const o=t.default&&Vl(t.default(),!0);if(!o||!o.length)return;const a=_e(r),{mode:s}=a,l=o[0];if(n.isLeaving)return pa(l);const u=Kl(l);if(!u)return pa(l);const c=da(u,a,n,e);ga(u,c);const f=e.subTree,h=f&&Kl(f);let d=!1;const{getTransitionKey:p}=u.type;if(p){const g=p();i===void 0?i=g:g!==i&&(i=g,d=!0)}if(h&&h.type!==Ot&&(!xr(u,h)||d)){const g=da(h,a,n,e);if(ga(h,g),s==="out-in")return n.isLeaving=!0,g.afterLeave=()=>{n.isLeaving=!1,e.update()},pa(l);s==="in-out"&&u.type!==Ot&&(g.delayLeave=(_,x,T)=>{const E=zl(n,h);E[String(h.key)]=h,_._leaveCb=()=>{x(),_._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=T})}return l}}},rp=tp;function zl(r,t){const{leavingVNodes:e}=r;let n=e.get(t.type);return n||(n=Object.create(null),e.set(t.type,n)),n}function da(r,t,e,n){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:s,onEnter:l,onAfterEnter:u,onEnterCancelled:c,onBeforeLeave:f,onLeave:h,onAfterLeave:d,onLeaveCancelled:p,onBeforeAppear:g,onAppear:_,onAfterAppear:x,onAppearCancelled:T}=t,E=String(r.key),y=zl(e,r),w=(S,P)=>{S&&dt(S,n,9,P)},O={mode:o,persisted:a,beforeEnter(S){let P=s;if(!e.isMounted)if(i)P=g||s;else return;S._leaveCb&&S._leaveCb(!0);const L=y[E];L&&xr(r,L)&&L.el._leaveCb&&L.el._leaveCb(),w(P,[S])},enter(S){let P=l,L=u,N=c;if(!e.isMounted)if(i)P=_||l,L=x||u,N=T||c;else return;let j=!1;const W=S._enterCb=ne=>{j||(j=!0,ne?w(N,[S]):w(L,[S]),O.delayedLeave&&O.delayedLeave(),S._enterCb=void 0)};P?(P(S,W),P.length<=1&&W()):W()},leave(S,P){const L=String(r.key);if(S._enterCb&&S._enterCb(!0),e.isUnmounting)return P();w(f,[S]);let N=!1;const j=S._leaveCb=W=>{N||(N=!0,P(),W?w(p,[S]):w(d,[S]),S._leaveCb=void 0,y[L]===r&&delete y[L])};y[L]=r,h?(h(S,j),h.length<=1&&j()):j()},clone(S){return da(S,t,e,n)}};return O}function pa(r){if(Ri(r))return r=Hr(r),r.children=null,r}function Kl(r){return Ri(r)?r.children?r.children[0]:void 0:r}function ga(r,t){r.shapeFlag&6&&r.component?ga(r.component.subTree,t):r.shapeFlag&128?(r.ssContent.transition=t.clone(r.ssContent),r.ssFallback.transition=t.clone(r.ssFallback)):r.transition=t}function Vl(r,t=!1){let e=[],n=0;for(let i=0;i<r.length;i++){const o=r[i];o.type===At?(o.patchFlag&128&&n++,e=e.concat(Vl(o.children,t))):(t||o.type!==Ot)&&e.push(o)}if(n>1)for(let i=0;i<e.length;i++)e[i].patchFlag=-2;return e}const va=r=>!!r.type.__asyncLoader,Ri=r=>r.type.__isKeepAlive;function np(r,t){Xl(r,"a",t)}function ip(r,t){Xl(r,"da",t)}function Xl(r,t,e=je){const n=r.__wdc||(r.__wdc=()=>{let i=e;for(;i;){if(i.isDeactivated)return;i=i.parent}return r()});if(Si(t,n,e),e){let i=e.parent;for(;i&&i.parent;)Ri(i.parent.vnode)&&op(n,t,e,i),i=i.parent}}function op(r,t,e,n){const i=Si(t,r,n,!0);Wl(()=>{Vo(n[t],i)},e)}function Si(r,t,e=je,n=!1){if(e){const i=e[r]||(e[r]=[]),o=t.__weh||(t.__weh=(...a)=>{if(e.isUnmounted)return;Vr(),Zr(e);const s=dt(t,e,r,a);return br(),_r(),s});return n?i.unshift(o):i.push(o),o}}const Bt=r=>(t,e=je)=>(!Di||r==="sp")&&Si(r,t,e),ap=Bt("bm"),Hl=Bt("m"),sp=Bt("bu"),lp=Bt("u"),Zl=Bt("bum"),Wl=Bt("um"),up=Bt("sp"),cp=Bt("rtg"),fp=Bt("rtc");function hp(r,t=je){Si("ec",r,t)}let _a=!0;function dp(r){const t=Ql(r),e=r.proxy,n=r.ctx;_a=!1,t.beforeCreate&&Yl(t.beforeCreate,r,"bc");const{data:i,computed:o,methods:a,watch:s,provide:l,inject:u,created:c,beforeMount:f,mounted:h,beforeUpdate:d,updated:p,activated:g,deactivated:_,beforeDestroy:x,beforeUnmount:T,destroyed:E,unmounted:y,render:w,renderTracked:O,renderTriggered:S,errorCaptured:P,serverPrefetch:L,expose:N,inheritAttrs:j,components:W,directives:ne,filters:se}=t;if(u&&pp(u,n,null,r.appContext.config.unwrapInjectedRef),a)for(const F in a){const U=a[F];re(U)&&(n[F]=U.bind(e))}if(i){const F=i.call(e,e);ke(F)&&(r.data=oa(F))}if(_a=!0,o)for(const F in o){const U=o[F],oe=re(U)?U.bind(e,e):re(U.get)?U.get.bind(e,e):yt,me=!re(U)&&re(U.set)?U.set.bind(e):yt,Ie=Kd({get:oe,set:me});Object.defineProperty(n,F,{enumerable:!0,configurable:!0,get:()=>Ie.value,set:Y=>Ie.value=Y})}if(s)for(const F in s)ql(s[F],n,e,F);if(l){const F=re(l)?l.call(e):l;Reflect.ownKeys(F).forEach(U=>{Jd(U,F[U])})}c&&Yl(c,r,"c");function G(F,U){Q(U)?U.forEach(oe=>F(oe.bind(e))):U&&F(U.bind(e))}if(G(ap,f),G(Hl,h),G(sp,d),G(lp,p),G(np,g),G(ip,_),G(hp,P),G(fp,O),G(cp,S),G(Zl,T),G(Wl,y),G(up,L),Q(N))if(N.length){const F=r.exposed||(r.exposed={});N.forEach(U=>{Object.defineProperty(F,U,{get:()=>e[U],set:oe=>e[U]=oe})})}else r.exposed||(r.exposed={});w&&r.render===yt&&(r.render=w),j!=null&&(r.inheritAttrs=j),W&&(r.components=W),ne&&(r.directives=ne)}function pp(r,t,e=yt,n=!1){Q(r)&&(r=ya(r));for(const i in r){const o=r[i];let a;ke(o)?"default"in o?a=ha(o.from||i,o.default,!0):a=ha(o.from||i):a=ha(o),et(a)&&n?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>a.value,set:s=>a.value=s}):t[i]=a}}function Yl(r,t,e){dt(Q(r)?r.map(n=>n.bind(t.proxy)):r.bind(t.proxy),t,e)}function ql(r,t,e,n){const i=n.includes(".")?Ou(e,n):()=>e[n];if(ze(r)){const o=t[r];re(o)&&Ia(i,o)}else if(re(r))Ia(i,r.bind(e));else if(ke(r))if(Q(r))r.forEach(o=>ql(o,t,e,n));else{const o=re(r.handler)?r.handler.bind(e):t[r.handler];re(o)&&Ia(i,o,r)}}function Ql(r){const t=r.type,{mixins:e,extends:n}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:a}}=r.appContext,s=o.get(t);let l;return s?l=s:!i.length&&!e&&!n?l=t:(l={},i.length&&i.forEach(u=>Ai(l,u,a,!0)),Ai(l,t,a)),o.set(t,l),l}function Ai(r,t,e,n=!1){const{mixins:i,extends:o}=t;o&&Ai(r,o,e,!0),i&&i.forEach(a=>Ai(r,a,e,!0));for(const a in t)if(!(n&&a==="expose")){const s=gp[a]||e&&e[a];r[a]=s?s(r[a],t[a]):t[a]}return r}const gp={data:Jl,props:yr,emits:yr,methods:yr,computed:yr,beforeCreate:Ye,created:Ye,beforeMount:Ye,mounted:Ye,beforeUpdate:Ye,updated:Ye,beforeDestroy:Ye,beforeUnmount:Ye,destroyed:Ye,unmounted:Ye,activated:Ye,deactivated:Ye,errorCaptured:Ye,serverPrefetch:Ye,components:yr,directives:yr,watch:_p,provide:Jl,inject:vp};function Jl(r,t){return t?r?function(){return Ze(re(r)?r.call(this,this):r,re(t)?t.call(this,this):t)}:t:r}function vp(r,t){return yr(ya(r),ya(t))}function ya(r){if(Q(r)){const t={};for(let e=0;e<r.length;e++)t[r[e]]=r[e];return t}return r}function Ye(r,t){return r?[...new Set([].concat(r,t))]:t}function yr(r,t){return r?Ze(Ze(Object.create(null),r),t):t}function _p(r,t){if(!r)return t;if(!t)return r;const e=Ze(Object.create(null),r);for(const n in t)e[n]=Ye(r[n],t[n]);return e}function yp(r,t,e,n=!1){const i={},o={};gi(o,Pi,1),r.propsDefaults=Object.create(null),eu(r,t,i,o);for(const a in r.propsOptions[0])a in i||(i[a]=void 0);e?r.props=n?i:Ud(i):r.type.props?r.props=i:r.props=o,r.attrs=o}function mp(r,t,e,n){const{props:i,attrs:o,vnode:{patchFlag:a}}=r,s=_e(i),[l]=r.propsOptions;let u=!1;if((n||a>0)&&!(a&16)){if(a&8){const c=r.vnode.dynamicProps;for(let f=0;f<c.length;f++){let h=c[f];const d=t[h];if(l)if(ce(o,h))d!==o[h]&&(o[h]=d,u=!0);else{const p=St(h);i[p]=ma(l,s,p,d,r,!1)}else d!==o[h]&&(o[h]=d,u=!0)}}}else{eu(r,t,i,o)&&(u=!0);let c;for(const f in s)(!t||!ce(t,f)&&((c=zr(f))===f||!ce(t,c)))&&(l?e&&(e[f]!==void 0||e[c]!==void 0)&&(i[f]=ma(l,s,f,void 0,r,!0)):delete i[f]);if(o!==s)for(const f in o)(!t||!ce(t,f))&&(delete o[f],u=!0)}u&&jt(r,"set","$attrs")}function eu(r,t,e,n){const[i,o]=r.propsOptions;let a=!1,s;if(t)for(let l in t){if(ci(l))continue;const u=t[l];let c;i&&ce(i,c=St(l))?!o||!o.includes(c)?e[c]=u:(s||(s={}))[c]=u:ca(r.emitsOptions,l)||(!(l in n)||u!==n[l])&&(n[l]=u,a=!0)}if(o){const l=_e(e),u=s||we;for(let c=0;c<o.length;c++){const f=o[c];e[f]=ma(i,l,f,u[f],r,!ce(u,f))}}return a}function ma(r,t,e,n,i,o){const a=r[e];if(a!=null){const s=ce(a,"default");if(s&&n===void 0){const l=a.default;if(a.type!==Function&&re(l)){const{propsDefaults:u}=i;e in u?n=u[e]:(Zr(i),n=u[e]=l.call(null,t),br())}else n=l}a[0]&&(o&&!s?n=!1:a[1]&&(n===""||n===zr(e))&&(n=!0))}return n}function tu(r,t,e=!1){const n=t.propsCache,i=n.get(r);if(i)return i;const o=r.props,a={},s=[];let l=!1;if(!re(r)){const c=f=>{l=!0;const[h,d]=tu(f,t,!0);Ze(a,h),d&&s.push(...d)};!e&&t.mixins.length&&t.mixins.forEach(c),r.extends&&c(r.extends),r.mixins&&r.mixins.forEach(c)}if(!o&&!l)return n.set(r,Br),Br;if(Q(o))for(let c=0;c<o.length;c++){const f=St(o[c]);ru(f)&&(a[f]=we)}else if(o)for(const c in o){const f=St(c);if(ru(f)){const h=o[c],d=a[f]=Q(h)||re(h)?{type:h}:h;if(d){const p=ou(Boolean,d.type),g=ou(String,d.type);d[0]=p>-1,d[1]=g<0||p<g,(p>-1||ce(d,"default"))&&s.push(f)}}}const u=[a,s];return n.set(r,u),u}function ru(r){return r[0]!=="$"}function nu(r){const t=r&&r.toString().match(/^\s*function (\w+)/);return t?t[1]:r===null?"null":""}function iu(r,t){return nu(r)===nu(t)}function ou(r,t){return Q(t)?t.findIndex(e=>iu(e,r)):re(t)&&iu(t,r)?0:-1}const au=r=>r[0]==="_"||r==="$stable",Ta=r=>Q(r)?r.map(Pt):[Pt(r)],Tp=(r,t,e)=>{const n=Xd((...i)=>Ta(t(...i)),e);return n._c=!1,n},su=(r,t,e)=>{const n=r._ctx;for(const i in r){if(au(i))continue;const o=r[i];if(re(o))t[i]=Tp(i,o,n);else if(o!=null){const a=Ta(o);t[i]=()=>a}}},lu=(r,t)=>{const e=Ta(t);r.slots.default=()=>e},Ep=(r,t)=>{if(r.vnode.shapeFlag&32){const e=t._;e?(r.slots=_e(t),gi(t,"_",e)):su(t,r.slots={})}else r.slots={},t&&lu(r,t);gi(r.slots,Pi,1)},xp=(r,t,e)=>{const{vnode:n,slots:i}=r;let o=!0,a=we;if(n.shapeFlag&32){const s=t._;s?e&&s===1?o=!1:(Ze(i,t),!e&&s===1&&delete i._):(o=!t.$stable,su(t,i)),a=t}else t&&(lu(r,t),a={default:1});if(o)for(const s in i)!au(s)&&!(s in a)&&delete i[s]};function Db(r,t){const e=ft;if(e===null)return r;const n=e.proxy,i=r.dirs||(r.dirs=[]);for(let o=0;o<t.length;o++){let[a,s,l,u=we]=t[o];re(a)&&(a={mounted:a,updated:a}),a.deep&&wr(s),i.push({dir:a,instance:n,value:s,oldValue:void 0,arg:l,modifiers:u})}return r}function mr(r,t,e,n){const i=r.dirs,o=t&&t.dirs;for(let a=0;a<i.length;a++){const s=i[a];o&&(s.oldValue=o[a].value);let l=s.dir[n];l&&(Vr(),dt(l,e,8,[r.el,s,r,t]),_r())}}function uu(){return{app:null,config:{isNativeTag:nd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let bp=0;function wp(r,t){return function(n,i=null){i!=null&&!ke(i)&&(i=null);const o=uu(),a=new Set;let s=!1;const l=o.app={_uid:bp++,_component:n,_props:i,_container:null,_context:o,_instance:null,version:ng,get config(){return o.config},set config(u){},use(u,...c){return a.has(u)||(u&&re(u.install)?(a.add(u),u.install(l,...c)):re(u)&&(a.add(u),u(l,...c))),l},mixin(u){return o.mixins.includes(u)||o.mixins.push(u),l},component(u,c){return c?(o.components[u]=c,l):o.components[u]},directive(u,c){return c?(o.directives[u]=c,l):o.directives[u]},mount(u,c,f){if(!s){const h=$t(n,i);return h.appContext=o,c&&t?t(h,u):r(h,u,f),s=!0,l._container=u,u.__vue_app__=l,Ra(h.component)||h.component.proxy}},unmount(){s&&(r(null,l._container),delete l._container.__vue_app__)},provide(u,c){return o.provides[u]=c,l}};return l}}function Ea(r,t,e,n,i=!1){if(Q(r)){r.forEach((h,d)=>Ea(h,t&&(Q(t)?t[d]:t),e,n,i));return}if(va(n)&&!i)return;const o=n.shapeFlag&4?Ra(n.component)||n.component.proxy:n.el,a=i?null:o,{i:s,r:l}=r,u=t&&t.r,c=s.refs===we?s.refs={}:s.refs,f=s.setupState;if(u!=null&&u!==l&&(ze(u)?(c[u]=null,ce(f,u)&&(f[u]=null)):et(u)&&(u.value=null)),re(l))tr(l,s,12,[a,c]);else{const h=ze(l),d=et(l);if(h||d){const p=()=>{if(r.f){const g=h?c[l]:l.value;i?Q(g)&&Vo(g,o):Q(g)?g.includes(o)||g.push(o):h?c[l]=[o]:(l.value=[o],r.k&&(c[r.k]=l.value))}else h?(c[l]=a,ce(f,l)&&(f[l]=a)):et(l)&&(l.value=a,r.k&&(c[r.k]=a))};a?(p.id=-1,tt(p,e)):p()}}}const tt=Qd;function Cp(r){return Rp(r)}function Rp(r,t){const e=ud();e.__VUE__=!0;const{insert:n,remove:i,patchProp:o,createElement:a,createText:s,createComment:l,setText:u,setElementText:c,parentNode:f,nextSibling:h,setScopeId:d=yt,cloneNode:p,insertStaticContent:g}=r,_=(v,m,b,R=null,C=null,I=null,k=!1,M=null,D=!!m.dynamicChildren)=>{if(v===m)return;v&&!xr(v,m)&&(R=Oe(v),xe(v,C,I,!0),v=null),m.patchFlag===-2&&(D=!1,m.dynamicChildren=null);const{type:A,ref:X,shapeFlag:$}=m;switch(A){case xa:x(v,m,b,R);break;case Ot:T(v,m,b,R);break;case ba:v==null&&E(m,b,R,k);break;case At:ne(v,m,b,R,C,I,k,M,D);break;default:$&1?O(v,m,b,R,C,I,k,M,D):$&6?se(v,m,b,R,C,I,k,M,D):($&64||$&128)&&A.process(v,m,b,R,C,I,k,M,D,ct)}X!=null&&C&&Ea(X,v&&v.ref,I,m||v,!m)},x=(v,m,b,R)=>{if(v==null)n(m.el=s(m.children),b,R);else{const C=m.el=v.el;m.children!==v.children&&u(C,m.children)}},T=(v,m,b,R)=>{v==null?n(m.el=l(m.children||""),b,R):m.el=v.el},E=(v,m,b,R)=>{[v.el,v.anchor]=g(v.children,m,b,R)},y=({el:v,anchor:m},b,R)=>{let C;for(;v&&v!==m;)C=h(v),n(v,b,R),v=C;n(m,b,R)},w=({el:v,anchor:m})=>{let b;for(;v&&v!==m;)b=h(v),i(v),v=b;i(m)},O=(v,m,b,R,C,I,k,M,D)=>{k=k||m.type==="svg",v==null?S(m,b,R,C,I,k,M,D):N(v,m,C,I,k,M,D)},S=(v,m,b,R,C,I,k,M)=>{let D,A;const{type:X,props:$,shapeFlag:H,transition:q,patchFlag:ae,dirs:ve}=v;if(v.el&&p!==void 0&&ae===-1)D=v.el=p(v.el);else{if(D=v.el=a(v.type,I,$&&$.is,$),H&8?c(D,v.children):H&16&&L(v.children,D,null,R,C,I&&X!=="foreignObject",k,M),ve&&mr(v,null,R,"created"),$){for(const Ee in $)Ee!=="value"&&!ci(Ee)&&o(D,Ee,null,$[Ee],I,v.children,R,C,Ce);"value"in $&&o(D,"value",null,$.value),(A=$.onVnodeBeforeMount)&&It(A,R,v)}P(D,v,v.scopeId,k,R)}ve&&mr(v,null,R,"beforeMount");const ue=(!C||C&&!C.pendingBranch)&&q&&!q.persisted;ue&&q.beforeEnter(D),n(D,m,b),((A=$&&$.onVnodeMounted)||ue||ve)&&tt(()=>{A&&It(A,R,v),ue&&q.enter(D),ve&&mr(v,null,R,"mounted")},C)},P=(v,m,b,R,C)=>{if(b&&d(v,b),R)for(let I=0;I<R.length;I++)d(v,R[I]);if(C){let I=C.subTree;if(m===I){const k=C.vnode;P(v,k,k.scopeId,k.slotScopeIds,C.parent)}}},L=(v,m,b,R,C,I,k,M,D=0)=>{for(let A=D;A<v.length;A++){const X=v[A]=M?er(v[A]):Pt(v[A]);_(null,X,m,b,R,C,I,k,M)}},N=(v,m,b,R,C,I,k)=>{const M=m.el=v.el;let{patchFlag:D,dynamicChildren:A,dirs:X}=m;D|=v.patchFlag&16;const $=v.props||we,H=m.props||we;let q;b&&Tr(b,!1),(q=H.onVnodeBeforeUpdate)&&It(q,b,m,v),X&&mr(m,v,b,"beforeUpdate"),b&&Tr(b,!0);const ae=C&&m.type!=="foreignObject";if(A?j(v.dynamicChildren,A,M,b,R,ae,I):k||oe(v,m,M,null,b,R,ae,I,!1),D>0){if(D&16)W(M,m,$,H,b,R,C);else if(D&2&&$.class!==H.class&&o(M,"class",null,H.class,C),D&4&&o(M,"style",$.style,H.style,C),D&8){const ve=m.dynamicProps;for(let ue=0;ue<ve.length;ue++){const Ee=ve[ue],He=$[Ee],Yt=H[Ee];(Yt!==He||Ee==="value")&&o(M,Ee,He,Yt,C,v.children,b,R,Ce)}}D&1&&v.children!==m.children&&c(M,m.children)}else!k&&A==null&&W(M,m,$,H,b,R,C);((q=H.onVnodeUpdated)||X)&&tt(()=>{q&&It(q,b,m,v),X&&mr(m,v,b,"updated")},R)},j=(v,m,b,R,C,I,k)=>{for(let M=0;M<m.length;M++){const D=v[M],A=m[M],X=D.el&&(D.type===At||!xr(D,A)||D.shapeFlag&(6|64))?f(D.el):b;_(D,A,X,null,R,C,I,k,!0)}},W=(v,m,b,R,C,I,k)=>{if(b!==R){for(const M in R){if(ci(M))continue;const D=R[M],A=b[M];D!==A&&M!=="value"&&o(v,M,A,D,k,m.children,C,I,Ce)}if(b!==we)for(const M in b)!ci(M)&&!(M in R)&&o(v,M,b[M],null,k,m.children,C,I,Ce);"value"in R&&o(v,"value",b.value,R.value)}},ne=(v,m,b,R,C,I,k,M,D)=>{const A=m.el=v?v.el:s(""),X=m.anchor=v?v.anchor:s("");let{patchFlag:$,dynamicChildren:H,slotScopeIds:q}=m;q&&(M=M?M.concat(q):q),v==null?(n(A,b,R),n(X,b,R),L(m.children,b,X,C,I,k,M,D)):$>0&&$&64&&H&&v.dynamicChildren?(j(v.dynamicChildren,H,b,C,I,k,M),(m.key!=null||C&&m===C.subTree)&&cu(v,m,!0)):oe(v,m,b,X,C,I,k,M,D)},se=(v,m,b,R,C,I,k,M,D)=>{m.slotScopeIds=M,v==null?m.shapeFlag&512?C.ctx.activate(m,b,R,k,D):V(m,b,R,C,I,k,D):G(v,m,D)},V=(v,m,b,R,C,I,k)=>{const M=v.component=$p(v,R,C);if(Ri(v)&&(M.ctx.renderer=ct),Kp(M),M.asyncDep){if(C&&C.registerDep(M,F),!v.el){const D=M.subTree=$t(Ot);T(null,D,m,b)}return}F(M,v,m,b,C,I,k)},G=(v,m,b)=>{const R=m.component=v.component;if(Wd(v,m,b))if(R.asyncDep&&!R.asyncResolved){U(R,m,b);return}else R.next=m,Jp(R.update),R.update();else m.component=v.component,m.el=v.el,R.vnode=m},F=(v,m,b,R,C,I,k)=>{const M=()=>{if(v.isMounted){let{next:X,bu:$,u:H,parent:q,vnode:ae}=v,ve=X,ue;Tr(v,!1),X?(X.el=ae.el,U(v,X,k)):X=ae,$&&pi($),(ue=X.props&&X.props.onVnodeBeforeUpdate)&&It(ue,q,X,ae),Tr(v,!0);const Ee=fa(v),He=v.subTree;v.subTree=Ee,_(He,Ee,f(He.el),Oe(He),v,C,I),X.el=Ee.el,ve===null&&Yd(v,Ee.el),H&&tt(H,C),(ue=X.props&&X.props.onVnodeUpdated)&&tt(()=>It(ue,q,X,ae),C)}else{let X;const{el:$,props:H}=m,{bm:q,m:ae,parent:ve}=v,ue=va(m);if(Tr(v,!1),q&&pi(q),!ue&&(X=H&&H.onVnodeBeforeMount)&&It(X,ve,m),Tr(v,!0),$&&Ct){const Ee=()=>{v.subTree=fa(v),Ct($,v.subTree,v,C,null)};ue?m.type.__asyncLoader().then(()=>!v.isUnmounted&&Ee()):Ee()}else{const Ee=v.subTree=fa(v);_(null,Ee,b,R,v,C,I),m.el=Ee.el}if(ae&&tt(ae,C),!ue&&(X=H&&H.onVnodeMounted)){const Ee=m;tt(()=>It(X,ve,Ee),C)}m.shapeFlag&256&&v.a&&tt(v.a,C),v.isMounted=!0,m=b=R=null}},D=v.effect=new Jo(M,()=>xu(v.update),v.scope),A=v.update=D.run.bind(D);A.id=v.uid,Tr(v,!0),A()},U=(v,m,b)=>{m.component=v;const R=v.vnode.props;v.vnode=m,v.next=null,mp(v,m.props,R,b),xp(v,m.children,b),Vr(),Pa(void 0,v.update),_r()},oe=(v,m,b,R,C,I,k,M,D=!1)=>{const A=v&&v.children,X=v?v.shapeFlag:0,$=m.children,{patchFlag:H,shapeFlag:q}=m;if(H>0){if(H&128){Ie(A,$,b,R,C,I,k,M,D);return}else if(H&256){me(A,$,b,R,C,I,k,M,D);return}}q&8?(X&16&&Ce(A,C,I),$!==A&&c(b,$)):X&16?q&16?Ie(A,$,b,R,C,I,k,M,D):Ce(A,C,I,!0):(X&8&&c(b,""),q&16&&L($,b,R,C,I,k,M,D))},me=(v,m,b,R,C,I,k,M,D)=>{v=v||Br,m=m||Br;const A=v.length,X=m.length,$=Math.min(A,X);let H;for(H=0;H<$;H++){const q=m[H]=D?er(m[H]):Pt(m[H]);_(v[H],q,b,null,C,I,k,M,D)}A>X?Ce(v,C,I,!0,!1,$):L(m,b,R,C,I,k,M,D,$)},Ie=(v,m,b,R,C,I,k,M,D)=>{let A=0;const X=m.length;let $=v.length-1,H=X-1;for(;A<=$&&A<=H;){const q=v[A],ae=m[A]=D?er(m[A]):Pt(m[A]);if(xr(q,ae))_(q,ae,b,null,C,I,k,M,D);else break;A++}for(;A<=$&&A<=H;){const q=v[$],ae=m[H]=D?er(m[H]):Pt(m[H]);if(xr(q,ae))_(q,ae,b,null,C,I,k,M,D);else break;$--,H--}if(A>$){if(A<=H){const q=H+1,ae=q<X?m[q].el:R;for(;A<=H;)_(null,m[A]=D?er(m[A]):Pt(m[A]),b,ae,C,I,k,M,D),A++}}else if(A>H)for(;A<=$;)xe(v[A],C,I,!0),A++;else{const q=A,ae=A,ve=new Map;for(A=ae;A<=H;A++){const nt=m[A]=D?er(m[A]):Pt(m[A]);nt.key!=null&&ve.set(nt.key,A)}let ue,Ee=0;const He=H-ae+1;let Yt=!1,_t=0;const qt=new Array(He);for(A=0;A<He;A++)qt[A]=0;for(A=q;A<=$;A++){const nt=v[A];if(Ee>=He){xe(nt,C,I,!0);continue}let Rt;if(nt.key!=null)Rt=ve.get(nt.key);else for(ue=ae;ue<=H;ue++)if(qt[ue-ae]===0&&xr(nt,m[ue])){Rt=ue;break}Rt===void 0?xe(nt,C,I,!0):(qt[Rt-ae]=A+1,Rt>=_t?_t=Rt:Yt=!0,_(nt,m[Rt],b,null,C,I,k,M,D),Ee++)}const Sn=Yt?Sp(qt):Br;for(ue=Sn.length-1,A=He-1;A>=0;A--){const nt=ae+A,Rt=m[nt],cl=nt+1<X?m[nt+1].el:R;qt[A]===0?_(null,Rt,b,cl,C,I,k,M,D):Yt&&(ue<0||A!==Sn[ue]?Y(Rt,b,cl,2):ue--)}}},Y=(v,m,b,R,C=null)=>{const{el:I,type:k,transition:M,children:D,shapeFlag:A}=v;if(A&6){Y(v.component.subTree,m,b,R);return}if(A&128){v.suspense.move(m,b,R);return}if(A&64){k.move(v,m,b,ct);return}if(k===At){n(I,m,b);for(let $=0;$<D.length;$++)Y(D[$],m,b,R);n(v.anchor,m,b);return}if(k===ba){y(v,m,b);return}if(R!==2&&A&1&&M)if(R===0)M.beforeEnter(I),n(I,m,b),tt(()=>M.enter(I),C);else{const{leave:$,delayLeave:H,afterLeave:q}=M,ae=()=>n(I,m,b),ve=()=>{$(I,()=>{ae(),q&&q()})};H?H(I,ae,ve):ve()}else n(I,m,b)},xe=(v,m,b,R=!1,C=!1)=>{const{type:I,props:k,ref:M,children:D,dynamicChildren:A,shapeFlag:X,patchFlag:$,dirs:H}=v;if(M!=null&&Ea(M,null,b,v,!0),X&256){m.ctx.deactivate(v);return}const q=X&1&&H,ae=!va(v);let ve;if(ae&&(ve=k&&k.onVnodeBeforeUnmount)&&It(ve,m,v),X&6)Te(v.component,b,R);else{if(X&128){v.suspense.unmount(b,R);return}q&&mr(v,null,m,"beforeUnmount"),X&64?v.type.remove(v,m,b,C,ct,R):A&&(I!==At||$>0&&$&64)?Ce(A,m,b,!1,!0):(I===At&&$&(128|256)||!C&&X&16)&&Ce(D,m,b),R&&J(v)}(ae&&(ve=k&&k.onVnodeUnmounted)||q)&&tt(()=>{ve&&It(ve,m,v),q&&mr(v,null,m,"unmounted")},b)},J=v=>{const{type:m,el:b,anchor:R,transition:C}=v;if(m===At){be(b,R);return}if(m===ba){w(v);return}const I=()=>{i(b),C&&!C.persisted&&C.afterLeave&&C.afterLeave()};if(v.shapeFlag&1&&C&&!C.persisted){const{leave:k,delayLeave:M}=C,D=()=>k(b,I);M?M(v.el,I,D):D()}else I()},be=(v,m)=>{let b;for(;v!==m;)b=h(v),i(v),v=b;i(m)},Te=(v,m,b)=>{const{bum:R,scope:C,update:I,subTree:k,um:M}=v;R&&pi(R),C.stop(),I&&(I.active=!1,xe(k,v,m,b)),M&&tt(M,m),tt(()=>{v.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&v.asyncDep&&!v.asyncResolved&&v.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Ce=(v,m,b,R=!1,C=!1,I=0)=>{for(let k=I;k<v.length;k++)xe(v[k],m,b,R,C)},Oe=v=>v.shapeFlag&6?Oe(v.component.subTree):v.shapeFlag&128?v.suspense.next():h(v.anchor||v.el),de=(v,m,b)=>{v==null?m._vnode&&xe(m._vnode,null,null,!0):_(m._vnode||null,v,m,null,null,null,b),Cu(),m._vnode=v},ct={p:_,um:xe,m:Y,r:J,mt:V,mc:L,pc:oe,pbc:j,n:Oe,o:r};let Je,Ct;return t&&([Je,Ct]=t(ct)),{render:de,hydrate:Je,createApp:wp(de,Je)}}function Tr({effect:r,update:t},e){r.allowRecurse=t.allowRecurse=e}function cu(r,t,e=!1){const n=r.children,i=t.children;if(Q(n)&&Q(i))for(let o=0;o<n.length;o++){const a=n[o];let s=i[o];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=i[o]=er(i[o]),s.el=a.el),e||cu(a,s))}}function Sp(r){const t=r.slice(),e=[0];let n,i,o,a,s;const l=r.length;for(n=0;n<l;n++){const u=r[n];if(u!==0){if(i=e[e.length-1],r[i]<u){t[n]=i,e.push(n);continue}for(o=0,a=e.length-1;o<a;)s=o+a>>1,r[e[s]]<u?o=s+1:a=s;u<r[e[o]]&&(o>0&&(t[n]=e[o-1]),e[o]=n)}}for(o=e.length,a=e[o-1];o-- >0;)e[o]=a,a=t[a];return e}const Ap=r=>r.__isTeleport,fu="components";function Lb(r,t){return Pp(fu,r,!0,t)||r}const Op=Symbol();function Pp(r,t,e=!0,n=!1){const i=ft||je;if(i){const o=i.type;if(r===fu){const s=Zp(o);if(s&&(s===t||s===St(t)||s===hi(St(t))))return o}const a=hu(i[r]||o[r],t)||hu(i.appContext[r],t);return!a&&n?o:a}}function hu(r,t){return r&&(r[t]||r[St(t)]||r[hi(St(t))])}const At=Symbol(void 0),xa=Symbol(void 0),Ot=Symbol(void 0),ba=Symbol(void 0),Dn=[];let Er=null;function Ip(r=!1){Dn.push(Er=r?null:[])}function Mp(){Dn.pop(),Er=Dn[Dn.length-1]||null}let Oi=1;function du(r){Oi+=r}function pu(r){return r.dynamicChildren=Oi>0?Er||Br:null,Mp(),Oi>0&&Er&&Er.push(r),r}function kb(r,t,e,n,i,o){return pu(vu(r,t,e,n,i,o,!0))}function Dp(r,t,e,n,i){return pu($t(r,t,e,n,i,!0))}function Lp(r){return r?r.__v_isVNode===!0:!1}function xr(r,t){return r.type===t.type&&r.key===t.key}const Pi="__vInternal",gu=({key:r})=>r!=null?r:null,Ii=({ref:r,ref_key:t,ref_for:e})=>r!=null?ze(r)||et(r)||re(r)?{i:ft,r,k:t,f:!!e}:r:null;function vu(r,t=null,e=null,n=0,i=null,o=r===At?0:1,a=!1,s=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:t,key:t&&gu(t),ref:t&&Ii(t),scopeId:wi,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};return s?(wa(l,e),o&128&&r.normalize(l)):e&&(l.shapeFlag|=ze(e)?8:16),Oi>0&&!a&&Er&&(l.patchFlag>0||o&6)&&l.patchFlag!==32&&Er.push(l),l}const $t=kp;function kp(r,t=null,e=null,n=0,i=null,o=!1){if((!r||r===Op)&&(r=Ot),Lp(r)){const s=Hr(r,t,!0);return e&&wa(s,e),s}if(Wp(r)&&(r=r.__vccOpts),t){t=Np(t);let{class:s,style:l}=t;s&&!ze(s)&&(t.class=zo(s)),ke(l)&&(Ul(l)&&!Q(l)&&(l=Ze({},l)),t.style=$o(l))}const a=ze(r)?1:qd(r)?128:Ap(r)?64:ke(r)?4:re(r)?2:0;return vu(r,t,e,n,i,a,o,!0)}function Np(r){return r?Ul(r)||Pi in r?Ze({},r):r:null}function Hr(r,t,e=!1){const{props:n,ref:i,patchFlag:o,children:a}=r,s=t?Up(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:s,key:s&&gu(s),ref:t&&t.ref?e&&i?Q(i)?i.concat(Ii(t)):[i,Ii(t)]:Ii(t):i,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:a,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:t&&r.type!==At?o===-1?16:o|16:o,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&Hr(r.ssContent),ssFallback:r.ssFallback&&Hr(r.ssFallback),el:r.el,anchor:r.anchor}}function Fp(r=" ",t=0){return $t(xa,null,r,t)}function Nb(r="",t=!1){return t?(Ip(),Dp(Ot,null,r)):$t(Ot,null,r)}function Pt(r){return r==null||typeof r=="boolean"?$t(Ot):Q(r)?$t(At,null,r.slice()):typeof r=="object"?er(r):$t(xa,null,String(r))}function er(r){return r.el===null||r.memo?r:Hr(r)}function wa(r,t){let e=0;const{shapeFlag:n}=r;if(t==null)t=null;else if(Q(t))e=16;else if(typeof t=="object")if(n&(1|64)){const i=t.default;i&&(i._c&&(i._d=!1),wa(r,i()),i._c&&(i._d=!0));return}else{e=32;const i=t._;!i&&!(Pi in t)?t._ctx=ft:i===3&&ft&&(ft.slots._===1?t._=1:(t._=2,r.patchFlag|=1024))}else re(t)?(t={default:t,_ctx:ft},e=32):(t=String(t),n&64?(e=16,t=[Fp(t)]):e=8);r.children=t,r.shapeFlag|=e}function Up(...r){const t={};for(let e=0;e<r.length;e++){const n=r[e];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=zo([t.class,n.class]));else if(i==="style")t.style=$o([t.style,n.style]);else if(si(i)){const o=t[i],a=n[i];o!==a&&!(Q(o)&&o.includes(a))&&(t[i]=o?[].concat(o,a):a)}else i!==""&&(t[i]=n[i])}return t}function It(r,t,e,n=null){dt(r,t,7,[e,n])}function Fb(r,t,e,n){let i;const o=e&&e[n];if(Q(r)||ze(r)){i=new Array(r.length);for(let a=0,s=r.length;a<s;a++)i[a]=t(r[a],a,void 0,o&&o[a])}else if(typeof r=="number"){i=new Array(r);for(let a=0;a<r;a++)i[a]=t(a+1,a,void 0,o&&o[a])}else if(ke(r))if(r[Symbol.iterator])i=Array.from(r,(a,s)=>t(a,s,void 0,o&&o[s]));else{const a=Object.keys(r);i=new Array(a.length);for(let s=0,l=a.length;s<l;s++){const u=a[s];i[s]=t(r[u],u,s,o&&o[s])}}else i=[];return e&&(e[n]=i),i}const Ca=r=>r?_u(r)?Ra(r)||r.proxy:Ca(r.parent):null,Mi=Ze(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>Ca(r.parent),$root:r=>Ca(r.root),$emit:r=>r.emit,$options:r=>Ql(r),$forceUpdate:r=>()=>xu(r.update),$nextTick:r=>qp.bind(r.proxy),$watch:r=>rg.bind(r)}),Gp={get({_:r},t){const{ctx:e,setupState:n,data:i,props:o,accessCache:a,type:s,appContext:l}=r;let u;if(t[0]!=="$"){const d=a[t];if(d!==void 0)switch(d){case 1:return n[t];case 2:return i[t];case 4:return e[t];case 3:return o[t]}else{if(n!==we&&ce(n,t))return a[t]=1,n[t];if(i!==we&&ce(i,t))return a[t]=2,i[t];if((u=r.propsOptions[0])&&ce(u,t))return a[t]=3,o[t];if(e!==we&&ce(e,t))return a[t]=4,e[t];_a&&(a[t]=0)}}const c=Mi[t];let f,h;if(c)return t==="$attrs"&&it(r,"get",t),c(r);if((f=s.__cssModules)&&(f=f[t]))return f;if(e!==we&&ce(e,t))return a[t]=4,e[t];if(h=l.config.globalProperties,ce(h,t))return h[t]},set({_:r},t,e){const{data:n,setupState:i,ctx:o}=r;if(i!==we&&ce(i,t))i[t]=e;else if(n!==we&&ce(n,t))n[t]=e;else if(ce(r.props,t))return!1;return t[0]==="$"&&t.slice(1)in r?!1:(o[t]=e,!0)},has({_:{data:r,setupState:t,accessCache:e,ctx:n,appContext:i,propsOptions:o}},a){let s;return!!e[a]||r!==we&&ce(r,a)||t!==we&&ce(t,a)||(s=o[0])&&ce(s,a)||ce(n,a)||ce(Mi,a)||ce(i.config.globalProperties,a)}},jp=uu();let Bp=0;function $p(r,t,e){const n=r.type,i=(t?t.appContext:r.appContext)||jp,o={uid:Bp++,vnode:r,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new cd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:tu(n,i),emitsOptions:Bl(n,i),emit:null,emitted:null,propsDefaults:we,inheritAttrs:n.inheritAttrs,ctx:we,data:we,props:we,attrs:we,slots:we,refs:we,setupState:we,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=Vd.bind(null,o),r.ce&&r.ce(o),o}let je=null;const zp=()=>je||ft,Zr=r=>{je=r,r.scope.on()},br=()=>{je&&je.scope.off(),je=null};function _u(r){return r.vnode.shapeFlag&4}let Di=!1;function Kp(r,t=!1){Di=t;const{props:e,children:n}=r.vnode,i=_u(r);yp(r,e,i,t),Ep(r,n);const o=i?Vp(r,t):void 0;return Di=!1,o}function Vp(r,t){const e=r.type;r.accessCache=Object.create(null),r.proxy=Gl(new Proxy(r.ctx,Gp));const{setup:n}=e;if(n){const i=r.setupContext=n.length>1?Hp(r):null;Zr(r),Vr();const o=tr(n,r,0,[r.props,i]);if(_r(),br(),_l(o)){if(o.then(br,br),t)return o.then(a=>{yu(r,a,t)}).catch(a=>{Li(a,r,0)});r.asyncDep=o}else yu(r,o,t)}else Tu(r,t)}function yu(r,t,e){re(t)?r.type.__ssrInlineRender?r.ssrRender=t:r.render=t:ke(t)&&(r.setupState=jl(t)),Tu(r,e)}let mu;function Tu(r,t,e){const n=r.type;if(!r.render){if(!t&&mu&&!n.render){const i=n.template;if(i){const{isCustomElement:o,compilerOptions:a}=r.appContext.config,{delimiters:s,compilerOptions:l}=n,u=Ze(Ze({isCustomElement:o,delimiters:s},a),l);n.render=mu(i,u)}}r.render=n.render||yt}Zr(r),Vr(),dp(r),_r(),br()}function Xp(r){return new Proxy(r.attrs,{get(t,e){return it(r,"get","$attrs"),t[e]}})}function Hp(r){const t=n=>{r.exposed=n||{}};let e;return{get attrs(){return e||(e=Xp(r))},slots:r.slots,emit:r.emit,expose:t}}function Ra(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(jl(Gl(r.exposed)),{get(t,e){if(e in t)return t[e];if(e in Mi)return Mi[e](r)}}))}function Zp(r){return re(r)&&r.displayName||r.name}function Wp(r){return re(r)&&"__vccOpts"in r}function tr(r,t,e,n){let i;try{i=n?r(...n):r()}catch(o){Li(o,t,e)}return i}function dt(r,t,e,n){if(re(r)){const o=tr(r,t,e,n);return o&&_l(o)&&o.catch(a=>{Li(a,t,e)}),o}const i=[];for(let o=0;o<r.length;o++)i.push(dt(r[o],t,e,n));return i}function Li(r,t,e,n=!0){const i=t?t.vnode:null;if(t){let o=t.parent;const a=t.proxy,s=e;for(;o;){const u=o.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](r,a,s)===!1)return}o=o.parent}const l=t.appContext.config.errorHandler;if(l){tr(l,null,10,[r,a,s]);return}}Yp(r,e,i,n)}function Yp(r,t,e,n=!0){console.error(r)}let ki=!1,Sa=!1;const ot=[];let zt=0;const Ln=[];let kn=null,Wr=0;const Nn=[];let rr=null,Yr=0;const Eu=Promise.resolve();let Aa=null,Oa=null;function qp(r){const t=Aa||Eu;return r?t.then(this?r.bind(this):r):t}function Qp(r){let t=zt+1,e=ot.length;for(;t<e;){const n=t+e>>>1;Fn(ot[n])<r?t=n+1:e=n}return t}function xu(r){(!ot.length||!ot.includes(r,ki&&r.allowRecurse?zt+1:zt))&&r!==Oa&&(r.id==null?ot.push(r):ot.splice(Qp(r.id),0,r),bu())}function bu(){!ki&&!Sa&&(Sa=!0,Aa=Eu.then(Ru))}function Jp(r){const t=ot.indexOf(r);t>zt&&ot.splice(t,1)}function wu(r,t,e,n){Q(r)?e.push(...r):(!t||!t.includes(r,r.allowRecurse?n+1:n))&&e.push(r),bu()}function eg(r){wu(r,kn,Ln,Wr)}function tg(r){wu(r,rr,Nn,Yr)}function Pa(r,t=null){if(Ln.length){for(Oa=t,kn=[...new Set(Ln)],Ln.length=0,Wr=0;Wr<kn.length;Wr++)kn[Wr]();kn=null,Wr=0,Oa=null,Pa(r,t)}}function Cu(r){if(Nn.length){const t=[...new Set(Nn)];if(Nn.length=0,rr){rr.push(...t);return}for(rr=t,rr.sort((e,n)=>Fn(e)-Fn(n)),Yr=0;Yr<rr.length;Yr++)rr[Yr]();rr=null,Yr=0}}const Fn=r=>r.id==null?1/0:r.id;function Ru(r){Sa=!1,ki=!0,Pa(r),ot.sort((e,n)=>Fn(e)-Fn(n));const t=yt;try{for(zt=0;zt<ot.length;zt++){const e=ot[zt];e&&e.active!==!1&&tr(e,null,14)}}finally{zt=0,ot.length=0,Cu(),ki=!1,Aa=null,(ot.length||Ln.length||Nn.length)&&Ru(r)}}const Su={};function Ia(r,t,e){return Au(r,t,e)}function Au(r,t,{immediate:e,deep:n,flush:i,onTrack:o,onTrigger:a}=we){const s=je;let l,u=!1,c=!1;if(et(r)?(l=()=>r.value,u=!!r._shallow):Xr(r)?(l=()=>r,n=!0):Q(r)?(c=!0,u=r.some(Xr),l=()=>r.map(x=>{if(et(x))return x.value;if(Xr(x))return wr(x);if(re(x))return tr(x,s,2)})):re(r)?t?l=()=>tr(r,s,2):l=()=>{if(!(s&&s.isUnmounted))return f&&f(),dt(r,s,3,[h])}:l=yt,t&&n){const x=l;l=()=>wr(x())}let f,h=x=>{f=_.onStop=()=>{tr(x,s,4)}};if(Di)return h=yt,t?e&&dt(t,s,3,[l(),c?[]:void 0,h]):l(),yt;let d=c?[]:Su;const p=()=>{if(!!_.active)if(t){const x=_.run();(n||u||(c?x.some((T,E)=>di(T,d[E])):di(x,d)))&&(f&&f(),dt(t,s,3,[x,d===Su?void 0:d,h]),d=x)}else _.run()};p.allowRecurse=!!t;let g;i==="sync"?g=p:i==="post"?g=()=>tt(p,s&&s.suspense):g=()=>{!s||s.isMounted?eg(p):p()};const _=new Jo(l,g);return t?e?p():d=_.run():i==="post"?tt(_.run.bind(_),s&&s.suspense):_.run(),()=>{_.stop(),s&&s.scope&&Vo(s.scope.effects,_)}}function rg(r,t,e){const n=this.proxy,i=ze(r)?r.includes(".")?Ou(n,r):()=>n[r]:r.bind(n,n);let o;re(t)?o=t:(o=t.handler,e=t);const a=je;Zr(this);const s=Au(i,o.bind(n),e);return a?Zr(a):br(),s}function Ou(r,t){const e=t.split(".");return()=>{let n=r;for(let i=0;i<e.length&&n;i++)n=n[e[i]];return n}}function wr(r,t){if(!ke(r)||r.__v_skip||(t=t||new Set,t.has(r)))return r;if(t.add(r),et(r))wr(r.value,t);else if(Q(r))for(let e=0;e<r.length;e++)wr(r[e],t);else if(li(r)||$r(r))r.forEach(e=>{wr(e,t)});else if(ml(r))for(const e in r)wr(r[e],t);return r}const ng="3.2.26",ig="http://www.w3.org/2000/svg",qr=typeof document!="undefined"?document:null,Pu=new Map,og={insert:(r,t,e)=>{t.insertBefore(r,e||null)},remove:r=>{const t=r.parentNode;t&&t.removeChild(r)},createElement:(r,t,e,n)=>{const i=t?qr.createElementNS(ig,r):qr.createElement(r,e?{is:e}:void 0);return r==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:r=>qr.createTextNode(r),createComment:r=>qr.createComment(r),setText:(r,t)=>{r.nodeValue=t},setElementText:(r,t)=>{r.textContent=t},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>qr.querySelector(r),setScopeId(r,t){r.setAttribute(t,"")},cloneNode(r){const t=r.cloneNode(!0);return"_value"in r&&(t._value=r._value),t},insertStaticContent(r,t,e,n){const i=e?e.previousSibling:t.lastChild;let o=Pu.get(r);if(!o){const a=qr.createElement("template");if(a.innerHTML=n?`<svg>${r}</svg>`:r,o=a.content,n){const s=o.firstChild;for(;s.firstChild;)o.appendChild(s.firstChild);o.removeChild(s)}Pu.set(r,o)}return t.insertBefore(o.cloneNode(!0),e),[i?i.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}};function ag(r,t,e){const n=r._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?r.removeAttribute("class"):e?r.setAttribute("class",t):r.className=t}function sg(r,t,e){const n=r.style,i=ze(e);if(e&&!i){for(const o in e)Ma(n,o,e[o]);if(t&&!ze(t))for(const o in t)e[o]==null&&Ma(n,o,"")}else{const o=n.display;i?t!==e&&(n.cssText=e):t&&r.removeAttribute("style"),"_vod"in r&&(n.display=o)}}const Iu=/\s*!important$/;function Ma(r,t,e){if(Q(e))e.forEach(n=>Ma(r,t,n));else if(t.startsWith("--"))r.setProperty(t,e);else{const n=lg(r,t);Iu.test(e)?r.setProperty(zr(n),e.replace(Iu,""),"important"):r[n]=e}}const Mu=["Webkit","Moz","ms"],Da={};function lg(r,t){const e=Da[t];if(e)return e;let n=St(t);if(n!=="filter"&&n in r)return Da[t]=n;n=hi(n);for(let i=0;i<Mu.length;i++){const o=Mu[i]+n;if(o in r)return Da[t]=o}return t}const Du="http://www.w3.org/1999/xlink";function ug(r,t,e,n,i){if(n&&t.startsWith("xlink:"))e==null?r.removeAttributeNS(Du,t.slice(6,t.length)):r.setAttributeNS(Du,t,e);else{const o=qh(t);e==null||o&&!pl(e)?r.removeAttribute(t):r.setAttribute(t,o?"":e)}}function cg(r,t,e,n,i,o,a){if(t==="innerHTML"||t==="textContent"){n&&a(n,i,o),r[t]=e==null?"":e;return}if(t==="value"&&r.tagName!=="PROGRESS"&&!r.tagName.includes("-")){r._value=e;const s=e==null?"":e;(r.value!==s||r.tagName==="OPTION")&&(r.value=s),e==null&&r.removeAttribute(t);return}if(e===""||e==null){const s=typeof r[t];if(s==="boolean"){r[t]=pl(e);return}else if(e==null&&s==="string"){r[t]="",r.removeAttribute(t);return}else if(s==="number"){try{r[t]=0}catch{}r.removeAttribute(t);return}}try{r[t]=e}catch{}}let Ni=Date.now,Lu=!1;if(typeof window!="undefined"){Ni()>document.createEvent("Event").timeStamp&&(Ni=()=>performance.now());const r=navigator.userAgent.match(/firefox\/(\d+)/i);Lu=!!(r&&Number(r[1])<=53)}let La=0;const fg=Promise.resolve(),hg=()=>{La=0},dg=()=>La||(fg.then(hg),La=Ni());function Cr(r,t,e,n){r.addEventListener(t,e,n)}function pg(r,t,e,n){r.removeEventListener(t,e,n)}function gg(r,t,e,n,i=null){const o=r._vei||(r._vei={}),a=o[t];if(n&&a)a.value=n;else{const[s,l]=vg(t);if(n){const u=o[t]=_g(n,i);Cr(r,s,u,l)}else a&&(pg(r,s,a,l),o[t]=void 0)}}const ku=/(?:Once|Passive|Capture)$/;function vg(r){let t;if(ku.test(r)){t={};let e;for(;e=r.match(ku);)r=r.slice(0,r.length-e[0].length),t[e[0].toLowerCase()]=!0}return[zr(r.slice(2)),t]}function _g(r,t){const e=n=>{const i=n.timeStamp||Ni();(Lu||i>=e.attached-1)&&dt(yg(n,e.value),t,5,[n])};return e.value=r,e.attached=dg(),e}function yg(r,t){if(Q(t)){const e=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{e.call(r),r._stopped=!0},t.map(n=>i=>!i._stopped&&n(i))}else return t}const Nu=/^on[a-z]/,mg=(r,t,e,n,i=!1,o,a,s,l)=>{t==="class"?ag(r,n,i):t==="style"?sg(r,e,n):si(t)?Ko(t)||gg(r,t,e,n,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Tg(r,t,n,i))?cg(r,t,n,o,a,s,l):(t==="true-value"?r._trueValue=n:t==="false-value"&&(r._falseValue=n),ug(r,t,n,i))};function Tg(r,t,e,n){return n?!!(t==="innerHTML"||t==="textContent"||t in r&&Nu.test(t)&&re(e)):t==="spellcheck"||t==="draggable"||t==="form"||t==="list"&&r.tagName==="INPUT"||t==="type"&&r.tagName==="TEXTAREA"||Nu.test(t)&&ze(e)?!1:t in r}const Eg={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};rp.props;const Fi=r=>{const t=r.props["onUpdate:modelValue"];return Q(t)?e=>pi(t,e):t};function xg(r){r.target.composing=!0}function Fu(r){const t=r.target;t.composing&&(t.composing=!1,bg(t,"input"))}function bg(r,t){const e=document.createEvent("HTMLEvents");e.initEvent(t,!0,!0),r.dispatchEvent(e)}const Ub={created(r,{modifiers:{lazy:t,trim:e,number:n}},i){r._assign=Fi(i);const o=n||i.props&&i.props.type==="number";Cr(r,t?"change":"input",a=>{if(a.target.composing)return;let s=r.value;e?s=s.trim():o&&(s=vi(s)),r._assign(s)}),e&&Cr(r,"change",()=>{r.value=r.value.trim()}),t||(Cr(r,"compositionstart",xg),Cr(r,"compositionend",Fu),Cr(r,"change",Fu))},mounted(r,{value:t}){r.value=t==null?"":t},beforeUpdate(r,{value:t,modifiers:{lazy:e,trim:n,number:i}},o){if(r._assign=Fi(o),r.composing||document.activeElement===r&&(e||n&&r.value.trim()===t||(i||r.type==="number")&&vi(r.value)===t))return;const a=t==null?"":t;r.value!==a&&(r.value=a)}},Gb={deep:!0,created(r,{value:t,modifiers:{number:e}},n){const i=li(t);Cr(r,"change",()=>{const o=Array.prototype.filter.call(r.options,a=>a.selected).map(a=>e?vi(Ui(a)):Ui(a));r._assign(r.multiple?i?new Set(o):o:o[0])}),r._assign=Fi(n)},mounted(r,{value:t}){Uu(r,t)},beforeUpdate(r,t,e){r._assign=Fi(e)},updated(r,{value:t}){Uu(r,t)}};function Uu(r,t){const e=r.multiple;if(!(e&&!Q(t)&&!li(t))){for(let n=0,i=r.options.length;n<i;n++){const o=r.options[n],a=Ui(o);if(e)Q(t)?o.selected=rd(t,a)>-1:o.selected=t.has(a);else if(ai(Ui(o),t)){r.selectedIndex!==n&&(r.selectedIndex=n);return}}!e&&r.selectedIndex!==-1&&(r.selectedIndex=-1)}}function Ui(r){return"_value"in r?r._value:r.value}const wg=Ze({patchProp:mg},og);let Gu;function Cg(){return Gu||(Gu=Cp(wg))}const jb=(...r)=>{const t=Cg().createApp(...r),{mount:e}=t;return t.mount=n=>{const i=Rg(n);if(!i)return;const o=t._component;!re(o)&&!o.render&&!o.template&&(o.template=i.innerHTML),i.innerHTML="";const a=e(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),a},t};function Rg(r){return ze(r)?document.querySelector(r):r}var Sg=function(){function r(){this.disposed=!1}return r.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},r.prototype.disposeInternal=function(){},r}(),Gi=Sg;function ji(r,t){return r>t?1:r<t?-1:0}function Ag(r,t){return r.indexOf(t)>=0}function ka(r,t,e){var n=r.length;if(r[0]<=t)return 0;if(t<=r[n-1])return n-1;var i=void 0;if(e>0){for(i=1;i<n;++i)if(r[i]<t)return i-1}else if(e<0){for(i=1;i<n;++i)if(r[i]<=t)return i}else for(i=1;i<n;++i){if(r[i]==t)return i;if(r[i]<t)return typeof e=="function"?e(t,r[i-1],r[i])>0?i-1:i:r[i-1]-t<t-r[i]?i-1:i}return n-1}function Og(r,t){for(var e=Array.isArray(t)?t:[t],n=e.length,i=0;i<n;i++)r[r.length]=e[i]}function Qr(r,t){for(var e=r.length>>>0,n,i=0;i<e;i++)if(n=r[i],t(n,i,r))return n;return null}function Na(r,t){var e=r.length;if(e!==t.length)return!1;for(var n=0;n<e;n++)if(r[n]!==t[n])return!1;return!0}function Fa(r,t){var e,n=!r.every(function(i,o){return e=o,!t(i,o,r)});return n?e:-1}function Pg(r,t,e){var n=t||ji;return r.every(function(i,o){if(o===0)return!0;var a=n(r[o-1],i);return!(a>0||e&&a===0)})}function Un(){return!0}function Bi(){return!1}function Gn(){}function Ig(r){var t=!1,e,n,i;return function(){var o=Array.prototype.slice.call(arguments);return(!t||this!==i||!Na(o,n))&&(t=!0,i=this,n=o,e=r.apply(this,arguments)),e}}function Mg(r){function t(){var e;try{e=r()}catch(n){return Promise.reject(n)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Re(){return function(){throw new Error("Unimplemented abstract method.")}()}var Dg=0;function Ne(r){return r.ol_uid||(r.ol_uid=String(++Dg))}var Lg="6.12.0",Jr=typeof navigator!="undefined"&&typeof navigator.userAgent!="undefined"?navigator.userAgent.toLowerCase():"",kg=Jr.indexOf("firefox")!==-1;Jr.indexOf("safari")!==-1&&Jr.indexOf("chrom")==-1;var Ng=Jr.indexOf("webkit")!==-1&&Jr.indexOf("edge")==-1,Fg=Jr.indexOf("macintosh")!==-1,ju=typeof devicePixelRatio!="undefined"?devicePixelRatio:1,Bu=typeof WorkerGlobalScope!="undefined"&&typeof OffscreenCanvas!="undefined"&&self instanceof WorkerGlobalScope,Ug=typeof Image!="undefined"&&Image.prototype.decode,$u=function(){var r=!1;try{var t=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return r}(),Gg=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),jg=function(r){Gg(t,r);function t(e){var n=this,i="v"+Lg.split("-")[0],o="Assertion failed. See https://openlayers.org/en/"+i+"/doc/errors/#"+e+" for details.";return n=r.call(this,o)||this,n.code=e,n.name="AssertionError",n.message=o,n}return t}(Error),zu=jg;function ye(r,t){if(!r)throw new zu(t)}var Ku=new Array(6);function Mt(){return[1,0,0,1,0,0]}function Ua(r){return Ga(r,1,0,0,1,0,0)}function Vu(r,t){var e=r[0],n=r[1],i=r[2],o=r[3],a=r[4],s=r[5],l=t[0],u=t[1],c=t[2],f=t[3],h=t[4],d=t[5];return r[0]=e*l+i*u,r[1]=n*l+o*u,r[2]=e*c+i*f,r[3]=n*c+o*f,r[4]=e*h+i*d+a,r[5]=n*h+o*d+s,r}function Ga(r,t,e,n,i,o,a){return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r[4]=o,r[5]=a,r}function qe(r,t){var e=t[0],n=t[1];return t[0]=r[0]*e+r[2]*n+r[4],t[1]=r[1]*e+r[3]*n+r[5],t}function Bg(r,t){var e=Math.cos(t),n=Math.sin(t);return Vu(r,Ga(Ku,e,n,-n,e,0,0))}function $g(r,t,e){return Vu(r,Ga(Ku,t,0,0,e,0,0))}function nr(r,t,e,n,i,o,a,s){var l=Math.sin(o),u=Math.cos(o);return r[0]=n*u,r[1]=i*l,r[2]=-n*l,r[3]=i*u,r[4]=a*n*u-s*n*l+t,r[5]=a*i*l+s*i*u+e,r}function Xu(r,t){var e=zg(t);ye(e!==0,32);var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5];return r[0]=a/e,r[1]=-i/e,r[2]=-o/e,r[3]=n/e,r[4]=(o*l-a*s)/e,r[5]=-(n*l-i*s)/e,r}function zg(r){return r[0]*r[3]-r[1]*r[2]}var Hu;function Kg(r){var t="matrix("+r.join(", ")+")";if(Bu)return t;var e=Hu||(Hu=document.createElement("div"));return e.style.transform=t,e.style.transform}var jn={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Ke={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function ja(r){for(var t=Rr(),e=0,n=r.length;e<n;++e)Ki(t,r[e]);return t}function Vg(r,t,e){var n=Math.min.apply(null,r),i=Math.min.apply(null,t),o=Math.max.apply(null,r),a=Math.max.apply(null,t);return Sr(n,i,o,a,e)}function Xg(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r.slice()}function Zu(r,t,e){var n,i;return t<r[0]?n=r[0]-t:r[2]<t?n=t-r[2]:n=0,e<r[1]?i=r[1]-e:r[3]<e?i=e-r[3]:i=0,n*n+i*i}function $i(r,t){return Yu(r,t[0],t[1])}function Wu(r,t){return r[0]<=t[0]&&t[2]<=r[2]&&r[1]<=t[1]&&t[3]<=r[3]}function Yu(r,t,e){return r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]}function qu(r,t){var e=r[0],n=r[1],i=r[2],o=r[3],a=t[0],s=t[1],l=Ke.UNKNOWN;return a<e?l=l|Ke.LEFT:a>i&&(l=l|Ke.RIGHT),s<n?l=l|Ke.BELOW:s>o&&(l=l|Ke.ABOVE),l===Ke.UNKNOWN&&(l=Ke.INTERSECTING),l}function Rr(){return[1/0,1/0,-1/0,-1/0]}function Sr(r,t,e,n,i){return i?(i[0]=r,i[1]=t,i[2]=e,i[3]=n,i):[r,t,e,n]}function zi(r){return Sr(1/0,1/0,-1/0,-1/0,r)}function Hg(r,t){var e=r[0],n=r[1];return Sr(e,n,e,n,t)}function Zg(r,t,e,n,i){var o=zi(i);return Qu(o,r,t,e,n)}function Ba(r,t){return r[0]==t[0]&&r[2]==t[2]&&r[1]==t[1]&&r[3]==t[3]}function Wg(r,t){return t[0]<r[0]&&(r[0]=t[0]),t[2]>r[2]&&(r[2]=t[2]),t[1]<r[1]&&(r[1]=t[1]),t[3]>r[3]&&(r[3]=t[3]),r}function Ki(r,t){t[0]<r[0]&&(r[0]=t[0]),t[0]>r[2]&&(r[2]=t[0]),t[1]<r[1]&&(r[1]=t[1]),t[1]>r[3]&&(r[3]=t[1])}function Qu(r,t,e,n,i){for(;e<n;e+=i)Yg(r,t[e],t[e+1]);return r}function Yg(r,t,e){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}function Ju(r,t){var e;return e=t(Vi(r)),e||(e=t(Xi(r)),e)||(e=t(Hi(r)),e)||(e=t(Ar(r)),e)?e:!1}function $a(r){var t=0;return Zi(r)||(t=Ve(r)*mt(r)),t}function Vi(r){return[r[0],r[1]]}function Xi(r){return[r[2],r[1]]}function en(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function qg(r,t){var e;return t===jn.BOTTOM_LEFT?e=Vi(r):t===jn.BOTTOM_RIGHT?e=Xi(r):t===jn.TOP_LEFT?e=Ar(r):t===jn.TOP_RIGHT?e=Hi(r):ye(!1,13),e}function za(r,t,e,n,i){var o=t*n[0]/2,a=t*n[1]/2,s=Math.cos(e),l=Math.sin(e),u=o*s,c=o*l,f=a*s,h=a*l,d=r[0],p=r[1],g=d-u+h,_=d-u-h,x=d+u-h,T=d+u+h,E=p-c-f,y=p-c+f,w=p+c+f,O=p+c-f;return Sr(Math.min(g,_,x,T),Math.min(E,y,w,O),Math.max(g,_,x,T),Math.max(E,y,w,O),i)}function mt(r){return r[3]-r[1]}function ir(r,t,e){var n=e||Rr();return Ka(r,t)?(r[0]>t[0]?n[0]=r[0]:n[0]=t[0],r[1]>t[1]?n[1]=r[1]:n[1]=t[1],r[2]<t[2]?n[2]=r[2]:n[2]=t[2],r[3]<t[3]?n[3]=r[3]:n[3]=t[3]):zi(n),n}function Ar(r){return[r[0],r[3]]}function Hi(r){return[r[2],r[3]]}function Ve(r){return r[2]-r[0]}function Ka(r,t){return r[0]<=t[2]&&r[2]>=t[0]&&r[1]<=t[3]&&r[3]>=t[1]}function Zi(r){return r[2]<r[0]||r[3]<r[1]}function Qg(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r}function Jg(r,t,e){var n=!1,i=qu(r,t),o=qu(r,e);if(i===Ke.INTERSECTING||o===Ke.INTERSECTING)n=!0;else{var a=r[0],s=r[1],l=r[2],u=r[3],c=t[0],f=t[1],h=e[0],d=e[1],p=(d-f)/(h-c),g=void 0,_=void 0;!!(o&Ke.ABOVE)&&!(i&Ke.ABOVE)&&(g=h-(d-u)/p,n=g>=a&&g<=l),!n&&!!(o&Ke.RIGHT)&&!(i&Ke.RIGHT)&&(_=d-(h-l)*p,n=_>=s&&_<=u),!n&&!!(o&Ke.BELOW)&&!(i&Ke.BELOW)&&(g=h-(d-s)/p,n=g>=a&&g<=l),!n&&!!(o&Ke.LEFT)&&!(i&Ke.LEFT)&&(_=d-(h-a)*p,n=_>=s&&_<=u)}return n}function ev(r,t,e,n){var i=[];if(n>1)for(var o=r[2]-r[0],a=r[3]-r[1],s=0;s<n;++s)i.push(r[0]+o*s/n,r[1],r[2],r[1]+a*s/n,r[2]-o*s/n,r[3],r[0],r[3]-a*s/n);else i=[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]];t(i,i,2);for(var l=[],u=[],s=0,c=i.length;s<c;s+=2)l.push(i[s]),u.push(i[s+1]);return Vg(l,u,e)}function Fe(r,t,e){return Math.min(Math.max(r,t),e)}var tv=function(){var r;return"cosh"in Math?r=Math.cosh:r=function(t){var e=Math.exp(t);return(e+1/e)/2},r}(),ec=function(){var r;return"log2"in Math?r=Math.log2:r=function(t){return Math.log(t)*Math.LOG2E},r}();function rv(r,t,e,n,i,o){var a=i-e,s=o-n;if(a!==0||s!==0){var l=((r-e)*a+(t-n)*s)/(a*a+s*s);l>1?(e=i,n=o):l>0&&(e+=a*l,n+=s*l)}return tn(r,t,e,n)}function tn(r,t,e,n){var i=e-r,o=n-t;return i*i+o*o}function nv(r){for(var t=r.length,e=0;e<t;e++){for(var n=e,i=Math.abs(r[e][e]),o=e+1;o<t;o++){var a=Math.abs(r[o][e]);a>i&&(i=a,n=o)}if(i===0)return null;var s=r[n];r[n]=r[e],r[e]=s;for(var l=e+1;l<t;l++)for(var u=-r[l][e]/r[e][e],c=e;c<t+1;c++)e==c?r[l][c]=0:r[l][c]+=u*r[e][c]}for(var f=new Array(t),h=t-1;h>=0;h--){f[h]=r[h][t]/r[h][h];for(var d=h-1;d>=0;d--)r[d][t]-=r[d][h]*f[h]}return f}function Wi(r){return r*Math.PI/180}function rn(r,t){var e=r%t;return e*t<0?e+t:e}function iv(r,t,e){return r+e*(t-r)}function tc(r,t){var e=Math.pow(10,t);return Math.round(r*e)/e}function Yi(r,t){return Math.floor(tc(r,t))}function qi(r,t){return Math.ceil(tc(r,t))}var rc=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,nc=/^([a-z]*)$|^hsla?\(.*\)$/i;function ov(r){return typeof r=="string"?r:sv(r)}function ic(r){var t=document.createElement("div");if(t.style.color=r,t.style.color!==""){document.body.appendChild(t);var e=getComputedStyle(t).color;return document.body.removeChild(t),e}else return""}var oc=function(){var r=1024,t={},e=0;return function(n){var i;if(t.hasOwnProperty(n))i=t[n];else{if(e>=r){var o=0;for(var a in t)(o++&3)==0&&(delete t[a],--e)}i=av(n),t[n]=i,++e}return i}}();function Va(r){return Array.isArray(r)?r:oc(r)}function av(r){var t,e,n,i,o;if(nc.exec(r)&&(r=ic(r)),rc.exec(r)){var a=r.length-1,s=void 0;a<=4?s=1:s=2;var l=a===4||a===8;t=parseInt(r.substr(1+0*s,s),16),e=parseInt(r.substr(1+1*s,s),16),n=parseInt(r.substr(1+2*s,s),16),l?i=parseInt(r.substr(1+3*s,s),16):i=255,s==1&&(t=(t<<4)+t,e=(e<<4)+e,n=(n<<4)+n,l&&(i=(i<<4)+i)),o=[t,e,n,i/255]}else r.indexOf("rgba(")==0?(o=r.slice(5,-1).split(",").map(Number),ac(o)):r.indexOf("rgb(")==0?(o=r.slice(4,-1).split(",").map(Number),o.push(1),ac(o)):ye(!1,14);return o}function ac(r){return r[0]=Fe(r[0]+.5|0,0,255),r[1]=Fe(r[1]+.5|0,0,255),r[2]=Fe(r[2]+.5|0,0,255),r[3]=Fe(r[3],0,1),r}function sv(r){var t=r[0];t!=(t|0)&&(t=t+.5|0);var e=r[1];e!=(e|0)&&(e=e+.5|0);var n=r[2];n!=(n|0)&&(n=n+.5|0);var i=r[3]===void 0?1:Math.round(r[3]*100)/100;return"rgba("+t+","+e+","+n+","+i+")"}function lv(r){return nc.test(r)&&(r=ic(r)),rc.test(r)||r.indexOf("rgba(")===0||r.indexOf("rgb(")===0}var uv=function(){function r(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return r.prototype.clear=function(){this.cache_={},this.cacheSize_=0},r.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},r.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];(t++&3)==0&&!n.hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}},r.prototype.get=function(t,e,n){var i=sc(t,e,n);return i in this.cache_?this.cache_[i]:null},r.prototype.set=function(t,e,n,i){var o=sc(t,e,n);this.cache_[o]=i,++this.cacheSize_},r.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()},r}();function sc(r,t,e){var n=e?ov(e):"null";return t+":"+r+":"+n}var lc=new uv,cv=function(){function r(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}return r.prototype.preventDefault=function(){this.defaultPrevented=!0},r.prototype.stopPropagation=function(){this.propagationStopped=!0},r}(),or=cv,Bn={PROPERTYCHANGE:"propertychange"},Pe=typeof Object.assign=="function"?Object.assign:function(r,t){if(r==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(r),n=1,i=arguments.length;n<i;++n){var o=arguments[n];if(o!=null)for(var a in o)o.hasOwnProperty(a)&&(e[a]=o[a])}return e};function $n(r){for(var t in r)delete r[t]}var fv=typeof Object.values=="function"?Object.values:function(r){var t=[];for(var e in r)t.push(r[e]);return t};function hv(r){var t;for(t in r)return!1;return!t}var dv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),pv=function(r){dv(t,r);function t(e){var n=r.call(this)||this;return n.eventTarget_=e,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return t.prototype.addEventListener=function(e,n){if(!(!e||!n)){var i=this.listeners_||(this.listeners_={}),o=i[e]||(i[e]=[]);o.indexOf(n)===-1&&o.push(n)}},t.prototype.dispatchEvent=function(e){var n=typeof e=="string"?new or(e):e,i=n.type;n.target||(n.target=this.eventTarget_||this);var o=this.listeners_&&this.listeners_[i],a;if(o){var s=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in s||(s[i]=0,l[i]=0),++s[i];for(var u=0,c=o.length;u<c;++u)if("handleEvent"in o[u]?a=o[u].handleEvent(n):a=o[u].call(this,n),a===!1||n.propagationStopped){a=!1;break}if(--s[i],s[i]===0){var f=l[i];for(delete l[i];f--;)this.removeEventListener(i,Gn);delete s[i]}return a}},t.prototype.disposeInternal=function(){this.listeners_&&$n(this.listeners_)},t.prototype.getListeners=function(e){return this.listeners_&&this.listeners_[e]||void 0},t.prototype.hasListener=function(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1},t.prototype.removeEventListener=function(e,n){var i=this.listeners_&&this.listeners_[e];if(i){var o=i.indexOf(n);o!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[o]=Gn,++this.pendingRemovals_[e]):(i.splice(o,1),i.length===0&&delete this.listeners_[e]))}},t}(Gi),nn=pv,ee={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function pe(r,t,e,n,i){if(n&&n!==r&&(e=e.bind(n)),i){var o=e;e=function(){r.removeEventListener(t,e),o.apply(this,arguments)}}var a={target:r,type:t,listener:e};return r.addEventListener(t,e),a}function Qi(r,t,e,n){return pe(r,t,e,n,!0)}function Le(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),$n(r))}var gv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ji=function(r){gv(t,r);function t(){var e=r.call(this)||this;return e.on=e.onInternal,e.once=e.onceInternal,e.un=e.unInternal,e.revision_=0,e}return t.prototype.changed=function(){++this.revision_,this.dispatchEvent(ee.CHANGE)},t.prototype.getRevision=function(){return this.revision_},t.prototype.onInternal=function(e,n){if(Array.isArray(e)){for(var i=e.length,o=new Array(i),a=0;a<i;++a)o[a]=pe(this,e[a],n);return o}else return pe(this,e,n)},t.prototype.onceInternal=function(e,n){var i;if(Array.isArray(e)){var o=e.length;i=new Array(o);for(var a=0;a<o;++a)i[a]=Qi(this,e[a],n)}else i=Qi(this,e,n);return n.ol_key=i,i},t.prototype.unInternal=function(e,n){var i=n.ol_key;if(i)vv(i);else if(Array.isArray(e))for(var o=0,a=e.length;o<a;++o)this.removeEventListener(e[o],n);else this.removeEventListener(e,n)},t}(nn);Ji.prototype.on;Ji.prototype.once;Ji.prototype.un;function vv(r){if(Array.isArray(r))for(var t=0,e=r.length;t<e;++t)Le(r[t]);else Le(r)}var uc=Ji,cc=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),fc=function(r){cc(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.key=n,o.oldValue=i,o}return t}(or),_v=function(r){cc(t,r);function t(e){var n=r.call(this)||this;return n.on,n.once,n.un,Ne(n),n.values_=null,e!==void 0&&n.setProperties(e),n}return t.prototype.get=function(e){var n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n},t.prototype.getKeys=function(){return this.values_&&Object.keys(this.values_)||[]},t.prototype.getProperties=function(){return this.values_&&Pe({},this.values_)||{}},t.prototype.hasProperties=function(){return!!this.values_},t.prototype.notify=function(e,n){var i;i="change:"+e,this.dispatchEvent(new fc(i,e,n)),i=Bn.PROPERTYCHANGE,this.dispatchEvent(new fc(i,e,n))},t.prototype.addChangeListener=function(e,n){this.addEventListener("change:"+e,n)},t.prototype.removeChangeListener=function(e,n){this.removeEventListener("change:"+e,n)},t.prototype.set=function(e,n,i){var o=this.values_||(this.values_={});if(i)o[e]=n;else{var a=o[e];o[e]=n,a!==n&&this.notify(e,a)}},t.prototype.setProperties=function(e,n){for(var i in e)this.set(i,e[i],n)},t.prototype.applyProperties=function(e){!e.values_||Pe(this.values_||(this.values_={}),e.values_)},t.prototype.unset=function(e,n){if(this.values_&&e in this.values_){var i=this.values_[e];delete this.values_[e],hv(this.values_)&&(this.values_=null),n||this.notify(e,i)}},t}(uc),Kt=_v,he={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"},yv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),mv=function(r){yv(t,r);function t(e){var n=r.call(this)||this;n.on,n.once,n.un,n.background_=e.background;var i=Pe({},e);return typeof e.properties=="object"&&(delete i.properties,Pe(i,e.properties)),i[he.OPACITY]=e.opacity!==void 0?e.opacity:1,ye(typeof i[he.OPACITY]=="number",64),i[he.VISIBLE]=e.visible!==void 0?e.visible:!0,i[he.Z_INDEX]=e.zIndex,i[he.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,i[he.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,i[he.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,i[he.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,n.className_=i.className!==void 0?e.className:"ol-layer",delete i.className,n.setProperties(i),n.state_=null,n}return t.prototype.getBackground=function(){return this.background_},t.prototype.getClassName=function(){return this.className_},t.prototype.getLayerState=function(e){var n=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return n.opacity=Fe(Math.round(this.getOpacity()*100)/100,0,1),n.sourceState=this.getSourceState(),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=i===void 0&&!n.managed?1/0:i,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n},t.prototype.getLayersArray=function(e){return Re()},t.prototype.getLayerStatesArray=function(e){return Re()},t.prototype.getExtent=function(){return this.get(he.EXTENT)},t.prototype.getMaxResolution=function(){return this.get(he.MAX_RESOLUTION)},t.prototype.getMinResolution=function(){return this.get(he.MIN_RESOLUTION)},t.prototype.getMinZoom=function(){return this.get(he.MIN_ZOOM)},t.prototype.getMaxZoom=function(){return this.get(he.MAX_ZOOM)},t.prototype.getOpacity=function(){return this.get(he.OPACITY)},t.prototype.getSourceState=function(){return Re()},t.prototype.getVisible=function(){return this.get(he.VISIBLE)},t.prototype.getZIndex=function(){return this.get(he.Z_INDEX)},t.prototype.setBackground=function(e){this.background_=e,this.changed()},t.prototype.setExtent=function(e){this.set(he.EXTENT,e)},t.prototype.setMaxResolution=function(e){this.set(he.MAX_RESOLUTION,e)},t.prototype.setMinResolution=function(e){this.set(he.MIN_RESOLUTION,e)},t.prototype.setMaxZoom=function(e){this.set(he.MAX_ZOOM,e)},t.prototype.setMinZoom=function(e){this.set(he.MIN_ZOOM,e)},t.prototype.setOpacity=function(e){ye(typeof e=="number",64),this.set(he.OPACITY,e)},t.prototype.setVisible=function(e){this.set(he.VISIBLE,e)},t.prototype.setZIndex=function(e){this.set(he.Z_INDEX,e)},t.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),r.prototype.disposeInternal.call(this)},t}(Kt),hc=mv,at={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Dt={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},Tv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ev=function(r){Tv(t,r);function t(e){var n=this,i=Pe({},e);delete i.source,n=r.call(this,i)||this,n.on,n.once,n.un,n.mapPrecomposeKey_=null,n.mapRenderKey_=null,n.sourceChangeKey_=null,n.renderer_=null,e.render&&(n.render=e.render),e.map&&n.setMap(e.map),n.addChangeListener(he.SOURCE,n.handleSourcePropertyChange_);var o=e.source?e.source:null;return n.setSource(o),n}return t.prototype.getLayersArray=function(e){var n=e||[];return n.push(this),n},t.prototype.getLayerStatesArray=function(e){var n=e||[];return n.push(this.getLayerState()),n},t.prototype.getSource=function(){return this.get(he.SOURCE)||null},t.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():Dt.UNDEFINED},t.prototype.handleSourceChange_=function(){this.changed()},t.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Le(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=pe(e,ee.CHANGE,this.handleSourceChange_,this)),this.changed()},t.prototype.getFeatures=function(e){return this.renderer_?this.renderer_.getFeatures(e):new Promise(function(n){return n([])})},t.prototype.render=function(e,n){var i=this.getRenderer();if(i.prepareFrame(e))return i.renderFrame(e,n)},t.prototype.setMapInternal=function(e){this.set(he.MAP,e)},t.prototype.getMapInternal=function(){return this.get(he.MAP)},t.prototype.setMap=function(e){this.mapPrecomposeKey_&&(Le(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(Le(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=pe(e,at.PRECOMPOSE,function(n){var i=n,o=i.frameState.layerStatesArray,a=this.getLayerState(!1);ye(!o.some(function(s){return s.layer===a.layer}),67),o.push(a)},this),this.mapRenderKey_=pe(this,ee.CHANGE,e.render,e),this.changed())},t.prototype.setSource=function(e){this.set(he.SOURCE,e)},t.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},t.prototype.hasRenderer=function(){return!!this.renderer_},t.prototype.createRenderer=function(){return null},t.prototype.disposeInternal=function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),r.prototype.disposeInternal.call(this)},t}(hc);function eo(r,t){if(!r.visible)return!1;var e=t.resolution;if(e<r.minResolution||e>=r.maxResolution)return!1;var n=t.zoom;return n>r.minZoom&&n<=r.maxZoom}var Xa=Ev;function xv(r,t){return r[0]+=+t[0],r[1]+=+t[1],r}function Ha(r,t){for(var e=!0,n=r.length-1;n>=0;--n)if(r[n]!=t[n]){e=!1;break}return e}function Za(r,t){var e=Math.cos(t),n=Math.sin(t),i=r[0]*e-r[1]*n,o=r[1]*e+r[0]*n;return r[0]=i,r[1]=o,r}function bv(r,t){return r[0]*=t,r[1]*=t,r}function wv(r,t){if(t.canWrapX()){var e=Ve(t.getExtent()),n=Cv(r,t,e);n&&(r[0]-=n*e)}return r}function Cv(r,t,e){var n=t.getExtent(),i=0;if(t.canWrapX()&&(r[0]<n[0]||r[0]>n[2])){var o=e||Ve(n);i=Math.floor((r[0]-n[0])/o)}return i}var Rv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Sv=function(r){Rv(t,r);function t(e){var n=r.call(this)||this;return n.map_=e,n}return t.prototype.dispatchRenderEvent=function(e,n){Re()},t.prototype.calculateMatrices2D=function(e){var n=e.viewState,i=e.coordinateToPixelTransform,o=e.pixelToCoordinateTransform;nr(i,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),Xu(o,i)},t.prototype.forEachFeatureAtCoordinate=function(e,n,i,o,a,s,l,u){var c,f=n.viewState;function h(V,G,F,U){return a.call(s,G,V?F:null,U)}var d=f.projection,p=wv(e.slice(),d),g=[[0,0]];if(d.canWrapX()&&o){var _=d.getExtent(),x=Ve(_);g.push([-x,0],[x,0])}for(var T=n.layerStatesArray,E=T.length,y=[],w=[],O=0;O<g.length;O++)for(var S=E-1;S>=0;--S){var P=T[S],L=P.layer;if(L.hasRenderer()&&eo(P,f)&&l.call(u,L)){var N=L.getRenderer(),j=L.getSource();if(N&&j){var W=j.getWrapX()?p:e,ne=h.bind(null,P.managed);w[0]=W[0]+g[O][0],w[1]=W[1]+g[O][1],c=N.forEachFeatureAtCoordinate(w,n,i,ne,y)}if(c)return c}}if(y.length!==0){var se=1/y.length;return y.forEach(function(V,G){return V.distanceSq+=G*se}),y.sort(function(V,G){return V.distanceSq-G.distanceSq}),y.some(function(V){return c=V.callback(V.feature,V.layer,V.geometry)}),c}},t.prototype.forEachLayerAtPixel=function(e,n,i,o,a){return Re()},t.prototype.hasFeatureAtCoordinate=function(e,n,i,o,a,s){var l=this.forEachFeatureAtCoordinate(e,n,i,o,Un,this,a,s);return l!==void 0},t.prototype.getMap=function(){return this.map_},t.prototype.renderFrame=function(e){Re()},t.prototype.scheduleExpireIconCache=function(e){lc.canExpireCache()&&e.postRenderFunctions.push(Av)},t}(Gi);function Av(r,t){lc.expire()}var Ov=Sv,Pv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Iv=function(r){Pv(t,r);function t(e,n,i,o){var a=r.call(this,e)||this;return a.inversePixelTransform=n,a.frameState=i,a.context=o,a}return t}(or),zn=Iv,to="ol-hidden",ro="ol-unselectable",Wa="ol-control",dc="ol-collapsed";function Mv(r){return r===1?"":String(Math.round(r*100)/100)}function no(r,t,e,n){var i;return e&&e.length?i=e.shift():Bu?i=new OffscreenCanvas(r||300,t||300):i=document.createElement("canvas"),r&&(i.width=r),t&&(i.height=t),i.getContext("2d",n)}function pc(r,t){var e=t.parentNode;e&&e.replaceChild(r,t)}function Ya(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function Dv(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function Lv(r,t){for(var e=r.childNodes,n=0;;++n){var i=e[n],o=t[n];if(!i&&!o)break;if(i!==o){if(!i){r.appendChild(o);continue}if(!o){r.removeChild(i),--n;continue}r.insertBefore(o,i)}}}var kv=new Kt,Nv=new nn;Nv.setSize=function(){console.warn("labelCache is deprecated.")};var Fv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Uv=function(r){Fv(t,r);function t(e){var n=r.call(this,e)||this;n.fontChangeListenerKey_=pe(kv,Bn.PROPERTYCHANGE,e.redrawText.bind(e)),n.element_=document.createElement("div");var i=n.element_.style;i.position="absolute",i.width="100%",i.height="100%",i.zIndex="0",n.element_.className=ro+" ol-layers";var o=e.getViewport();return o.insertBefore(n.element_,o.firstChild||null),n.children_=[],n.renderedVisible_=!0,n}return t.prototype.dispatchRenderEvent=function(e,n){var i=this.getMap();if(i.hasListener(e)){var o=new zn(e,void 0,n);i.dispatchEvent(o)}},t.prototype.disposeInternal=function(){Le(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),r.prototype.disposeInternal.call(this)},t.prototype.renderFrame=function(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(at.PRECOMPOSE,e);var n=e.layerStatesArray.sort(function(h,d){return h.zIndex-d.zIndex}),i=e.viewState;this.children_.length=0;for(var o=[],a=null,s=0,l=n.length;s<l;++s){var u=n[s];if(e.layerIndex=s,!(!eo(u,i)||u.sourceState!=Dt.READY&&u.sourceState!=Dt.UNDEFINED)){var c=u.layer,f=c.render(e,a);!f||(f!==a&&(this.children_.push(f),a=f),"getDeclutter"in c&&o.push(c))}}for(var s=o.length-1;s>=0;--s)o[s].renderDeclutter(e);Lv(this.element_,this.children_),this.dispatchRenderEvent(at.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)},t.prototype.forEachLayerAtPixel=function(e,n,i,o,a){for(var s=n.viewState,l=n.layerStatesArray,u=l.length,c=u-1;c>=0;--c){var f=l[c],h=f.layer;if(h.hasRenderer()&&eo(f,s)&&a(h)){var d=h.getRenderer(),p=d.getDataAtPixel(e,n,i);if(p){var g=o(h,p);if(g)return g}}}},t}(Ov),Gv=Uv,pt={ADD:"add",REMOVE:"remove"},gc=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vc={LENGTH:"length"},io=function(r){gc(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.element=n,o.index=i,o}return t}(or),jv=function(r){gc(t,r);function t(e,n){var i=r.call(this)||this;i.on,i.once,i.un;var o=n||{};if(i.unique_=!!o.unique,i.array_=e||[],i.unique_)for(var a=0,s=i.array_.length;a<s;++a)i.assertUnique_(i.array_[a],a);return i.updateLength_(),i}return t.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},t.prototype.extend=function(e){for(var n=0,i=e.length;n<i;++n)this.push(e[n]);return this},t.prototype.forEach=function(e){for(var n=this.array_,i=0,o=n.length;i<o;++i)e(n[i],i,n)},t.prototype.getArray=function(){return this.array_},t.prototype.item=function(e){return this.array_[e]},t.prototype.getLength=function(){return this.get(vc.LENGTH)},t.prototype.insertAt=function(e,n){this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new io(pt.ADD,n,e))},t.prototype.pop=function(){return this.removeAt(this.getLength()-1)},t.prototype.push=function(e){this.unique_&&this.assertUnique_(e);var n=this.getLength();return this.insertAt(n,e),this.getLength()},t.prototype.remove=function(e){for(var n=this.array_,i=0,o=n.length;i<o;++i)if(n[i]===e)return this.removeAt(i)},t.prototype.removeAt=function(e){var n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new io(pt.REMOVE,n,e)),n},t.prototype.setAt=function(e,n){var i=this.getLength();if(e<i){this.unique_&&this.assertUnique_(n,e);var o=this.array_[e];this.array_[e]=n,this.dispatchEvent(new io(pt.REMOVE,o,e)),this.dispatchEvent(new io(pt.ADD,n,e))}else{for(var a=i;a<e;++a)this.insertAt(a,void 0);this.insertAt(e,n)}},t.prototype.updateLength_=function(){this.set(vc.LENGTH,this.array_.length)},t.prototype.assertUnique_=function(e,n){for(var i=0,o=this.array_.length;i<o;++i)if(this.array_[i]===e&&i!==n)throw new zu(58)},t}(Kt),Tt=jv,_c=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ar=function(r){_c(t,r);function t(e,n){var i=r.call(this,e)||this;return i.layer=n,i}return t}(or),qa={LAYERS:"layers"},Bv=function(r){_c(t,r);function t(e){var n=this,i=e||{},o=Pe({},i);delete o.layers;var a=i.layers;return n=r.call(this,o)||this,n.on,n.once,n.un,n.layersListenerKeys_=[],n.listenerKeys_={},n.addChangeListener(qa.LAYERS,n.handleLayersChanged_),a?Array.isArray(a)?a=new Tt(a.slice(),{unique:!0}):ye(typeof a.getArray=="function",43):a=new Tt(void 0,{unique:!0}),n.setLayers(a),n}return t.prototype.handleLayerChange_=function(){this.changed()},t.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Le),this.layersListenerKeys_.length=0;var e=this.getLayers();this.layersListenerKeys_.push(pe(e,pt.ADD,this.handleLayersAdd_,this),pe(e,pt.REMOVE,this.handleLayersRemove_,this));for(var n in this.listenerKeys_)this.listenerKeys_[n].forEach(Le);$n(this.listenerKeys_);for(var i=e.getArray(),o=0,a=i.length;o<a;o++){var s=i[o];this.registerLayerListeners_(s),this.dispatchEvent(new ar("addlayer",s))}this.changed()},t.prototype.registerLayerListeners_=function(e){var n=[pe(e,Bn.PROPERTYCHANGE,this.handleLayerChange_,this),pe(e,ee.CHANGE,this.handleLayerChange_,this)];e instanceof t&&n.push(pe(e,"addlayer",this.handleLayerGroupAdd_,this),pe(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Ne(e)]=n},t.prototype.handleLayerGroupAdd_=function(e){this.dispatchEvent(new ar("addlayer",e.layer))},t.prototype.handleLayerGroupRemove_=function(e){this.dispatchEvent(new ar("removelayer",e.layer))},t.prototype.handleLayersAdd_=function(e){var n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new ar("addlayer",n)),this.changed()},t.prototype.handleLayersRemove_=function(e){var n=e.element,i=Ne(n);this.listenerKeys_[i].forEach(Le),delete this.listenerKeys_[i],this.dispatchEvent(new ar("removelayer",n)),this.changed()},t.prototype.getLayers=function(){return this.get(qa.LAYERS)},t.prototype.setLayers=function(e){var n=this.getLayers();if(n)for(var i=n.getArray(),o=0,a=i.length;o<a;++o)this.dispatchEvent(new ar("removelayer",i[o]));this.set(qa.LAYERS,e)},t.prototype.getLayersArray=function(e){var n=e!==void 0?e:[];return this.getLayers().forEach(function(i){i.getLayersArray(n)}),n},t.prototype.getLayerStatesArray=function(e){var n=e!==void 0?e:[],i=n.length;this.getLayers().forEach(function(c){c.getLayerStatesArray(n)});var o=this.getLayerState(),a=o.zIndex;!e&&o.zIndex===void 0&&(a=0);for(var s=i,l=n.length;s<l;s++){var u=n[s];u.opacity*=o.opacity,u.visible=u.visible&&o.visible,u.maxResolution=Math.min(u.maxResolution,o.maxResolution),u.minResolution=Math.max(u.minResolution,o.minResolution),u.minZoom=Math.max(u.minZoom,o.minZoom),u.maxZoom=Math.min(u.maxZoom,o.maxZoom),o.extent!==void 0&&(u.extent!==void 0?u.extent=ir(u.extent,o.extent):u.extent=o.extent),u.zIndex===void 0&&(u.zIndex=a)}return n},t.prototype.getSourceState=function(){return Dt.READY},t}(hc),oo=Bv,$v=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),zv=function(r){$v(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.map=n,o.frameState=i!==void 0?i:null,o}return t}(or),ao=zv,Kv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Vv=function(r){Kv(t,r);function t(e,n,i,o,a){var s=r.call(this,e,n,a)||this;return s.originalEvent=i,s.pixel_=null,s.coordinate_=null,s.dragging=o!==void 0?o:!1,s}return Object.defineProperty(t.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(e){this.pixel_=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(e){this.coordinate_=e},enumerable:!1,configurable:!0}),t.prototype.preventDefault=function(){r.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},t.prototype.stopPropagation=function(){r.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},t}(ao),sr=Vv,Se={SINGLECLICK:"singleclick",CLICK:ee.CLICK,DBLCLICK:ee.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Qa={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Xv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Hv=function(r){Xv(t,r);function t(e,n){var i=r.call(this,e)||this;i.map_=e,i.clickTimeoutId_,i.emulateClicks_=!1,i.dragging_=!1,i.dragListenerKeys_=[],i.moveTolerance_=n===void 0?1:n,i.down_=null;var o=i.map_.getViewport();return i.activePointers_=0,i.trackedTouches_={},i.element_=o,i.pointerdownListenerKey_=pe(o,Qa.POINTERDOWN,i.handlePointerDown_,i),i.originalPointerMoveEvent_,i.relayedListenerKey_=pe(o,Qa.POINTERMOVE,i.relayEvent_,i),i.boundHandleTouchMove_=i.handleTouchMove_.bind(i),i.element_.addEventListener(ee.TOUCHMOVE,i.boundHandleTouchMove_,$u?{passive:!1}:!1),i}return t.prototype.emulateClick_=function(e){var n=new sr(Se.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new sr(Se.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var i=new sr(Se.SINGLECLICK,this.map_,e);this.dispatchEvent(i)}.bind(this),250)},t.prototype.updateActivePointers_=function(e){var n=e;n.type==Se.POINTERUP||n.type==Se.POINTERCANCEL?delete this.trackedTouches_[n.pointerId]:n.type==Se.POINTERDOWN&&(this.trackedTouches_[n.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},t.prototype.handlePointerUp_=function(e){this.updateActivePointers_(e);var n=new sr(Se.POINTERUP,this.map_,e);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_===0&&(this.dragListenerKeys_.forEach(Le),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},t.prototype.isMouseActionButton_=function(e){return e.button===0},t.prototype.handlePointerDown_=function(e){this.emulateClicks_=this.activePointers_===0,this.updateActivePointers_(e);var n=new sr(Se.POINTERDOWN,this.map_,e);this.dispatchEvent(n),this.down_={};for(var i in e){var o=e[i];this.down_[i]=typeof o=="function"?Gn:o}if(this.dragListenerKeys_.length===0){var a=this.map_.getOwnerDocument();this.dragListenerKeys_.push(pe(a,Se.POINTERMOVE,this.handlePointerMove_,this),pe(a,Se.POINTERUP,this.handlePointerUp_,this),pe(this.element_,Se.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==a&&this.dragListenerKeys_.push(pe(this.element_.getRootNode(),Se.POINTERUP,this.handlePointerUp_,this))}},t.prototype.handlePointerMove_=function(e){if(this.isMoving_(e)){this.dragging_=!0;var n=new sr(Se.POINTERDRAG,this.map_,e,this.dragging_);this.dispatchEvent(n)}},t.prototype.relayEvent_=function(e){this.originalPointerMoveEvent_=e;var n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new sr(e.type,this.map_,e,n))},t.prototype.handleTouchMove_=function(e){var n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()},t.prototype.isMoving_=function(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_},t.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Le(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ee.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Le(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Le),this.dragListenerKeys_.length=0,this.element_=null,r.prototype.disposeInternal.call(this)},t}(nn),Zv=Hv,so={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"},We={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},lo=1/0,Wv=function(){function r(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return r.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,$n(this.queuedElements_)},r.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n},r.prototype.enqueue=function(t){ye(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=lo?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1},r.prototype.getCount=function(){return this.elements_.length},r.prototype.getLeftChildIndex_=function(t){return t*2+1},r.prototype.getRightChildIndex_=function(t){return t*2+2},r.prototype.getParentIndex_=function(t){return t-1>>1},r.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},r.prototype.isEmpty=function(){return this.elements_.length===0},r.prototype.isKeyQueued=function(t){return t in this.queuedElements_},r.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},r.prototype.siftUp_=function(t){for(var e=this.elements_,n=this.priorities_,i=e.length,o=e[t],a=n[t],s=t;t<i>>1;){var l=this.getLeftChildIndex_(t),u=this.getRightChildIndex_(t),c=u<i&&n[u]<n[l]?u:l;e[t]=e[c],n[t]=n[c],t=c}e[t]=o,n[t]=a,this.siftDown_(s,t)},r.prototype.siftDown_=function(t,e){for(var n=this.elements_,i=this.priorities_,o=n[e],a=i[e];e>t;){var s=this.getParentIndex_(e);if(i[s]>a)n[e]=n[s],i[e]=i[s],e=s;else break}n[e]=o,i[e]=a},r.prototype.reprioritize=function(){var t=this.priorityFunction_,e=this.elements_,n=this.priorities_,i=0,o=e.length,a,s,l;for(s=0;s<o;++s)a=e[s],l=t(a),l==lo?delete this.queuedElements_[this.keyFunction_(a)]:(n[i]=l,e[i++]=a);e.length=i,n.length=i,this.heapify_()},r}(),Yv=Wv,z={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},qv=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Qv=function(r){qv(t,r);function t(e,n){var i=r.call(this,function(o){return e.apply(null,o)},function(o){return o[0].getKey()})||this;return i.boundHandleTileChange_=i.handleTileChange.bind(i),i.tileChangeCallback_=n,i.tilesLoading_=0,i.tilesLoadingKeys_={},i}return t.prototype.enqueue=function(e){var n=r.prototype.enqueue.call(this,e);if(n){var i=e[0];i.addEventListener(ee.CHANGE,this.boundHandleTileChange_)}return n},t.prototype.getTilesLoading=function(){return this.tilesLoading_},t.prototype.handleTileChange=function(e){var n=e.target,i=n.getState();if(i===z.LOADED||i===z.ERROR||i===z.EMPTY){n.removeEventListener(ee.CHANGE,this.boundHandleTileChange_);var o=n.getKey();o in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[o],--this.tilesLoading_),this.tileChangeCallback_()}},t.prototype.loadMoreTiles=function(e,n){for(var i=0,o,a,s;this.tilesLoading_<e&&i<n&&this.getCount()>0;)a=this.dequeue()[0],s=a.getKey(),o=a.getState(),o===z.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++i,a.load())},t}(Yv),Jv=Qv;function e_(r,t,e,n,i){if(!r||!(e in r.wantedTiles)||!r.wantedTiles[e][t.getKey()])return lo;var o=r.viewState.center,a=n[0]-o[0],s=n[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+s*s)/i}var uo={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Et={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},t_={"9001":Et.METERS,"9002":Et.FEET,"9003":Et.USFEET,"9101":Et.RADIANS,"9102":Et.DEGREES};function yc(r){return t_[r]}var Lt={};Lt[Et.RADIANS]=6370997/(2*Math.PI);Lt[Et.DEGREES]=2*Math.PI*6370997/360;Lt[Et.FEET]=.3048;Lt[Et.METERS]=1;Lt[Et.USFEET]=1200/3937;var lr=Et,gt={ANIMATING:0,INTERACTING:1},xt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},r_=42,Ja=256,n_=function(){function r(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return r.prototype.canWrapX=function(){return this.canWrapX_},r.prototype.getCode=function(){return this.code_},r.prototype.getExtent=function(){return this.extent_},r.prototype.getUnits=function(){return this.units_},r.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||Lt[this.units_]},r.prototype.getWorldExtent=function(){return this.worldExtent_},r.prototype.getAxisOrientation=function(){return this.axisOrientation_},r.prototype.isGlobal=function(){return this.global_},r.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)},r.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},r.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},r.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)},r.prototype.setWorldExtent=function(t){this.worldExtent_=t},r.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},r.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},r}(),co=n_,i_=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Kn=6378137,on=Math.PI*Kn,o_=[-on,-on,on,on],a_=[-180,-85,180,85],fo=Kn*Math.log(Math.tan(Math.PI/2)),an=function(r){i_(t,r);function t(e){return r.call(this,{code:e,units:lr.METERS,extent:o_,global:!0,worldExtent:a_,getPointResolution:function(n,i){return n/tv(i[1]/Kn)}})||this}return t}(co),mc=[new an("EPSG:3857"),new an("EPSG:102100"),new an("EPSG:102113"),new an("EPSG:900913"),new an("http://www.opengis.net/def/crs/EPSG/0/3857"),new an("http://www.opengis.net/gml/srs/epsg.xml#3857")];function s_(r,t,e){var n=r.length,i=e>1?e:2,o=t;o===void 0&&(i>2?o=r.slice():o=new Array(n));for(var a=0;a<n;a+=i){o[a]=on*r[a]/180;var s=Kn*Math.log(Math.tan(Math.PI*(+r[a+1]+90)/360));s>fo?s=fo:s<-fo&&(s=-fo),o[a+1]=s}return o}function l_(r,t,e){var n=r.length,i=e>1?e:2,o=t;o===void 0&&(i>2?o=r.slice():o=new Array(n));for(var a=0;a<n;a+=i)o[a]=180*r[a]/on,o[a+1]=360*Math.atan(Math.exp(r[a+1]/Kn))/Math.PI-90;return o}var u_=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),c_=6378137,Tc=[-180,-90,180,90],f_=Math.PI*c_/180,Or=function(r){u_(t,r);function t(e,n){return r.call(this,{code:e,units:lr.DEGREES,extent:Tc,axisOrientation:n,global:!0,metersPerUnit:f_,worldExtent:Tc})||this}return t}(co),Ec=[new Or("CRS:84"),new Or("EPSG:4326","neu"),new Or("urn:ogc:def:crs:OGC:1.3:CRS84"),new Or("urn:ogc:def:crs:OGC:2:84"),new Or("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Or("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Or("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],es={};function h_(r){return es[r]||es[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function d_(r,t){es[r]=t}var sn={};function ho(r,t,e){var n=r.getCode(),i=t.getCode();n in sn||(sn[n]={}),sn[n][i]=e}function p_(r,t){var e;return r in sn&&t in sn[r]&&(e=sn[r][t]),e}var g_=63710088e-1;function xc(r,t,e){var n=e||g_,i=Wi(r[1]),o=Wi(t[1]),a=(o-i)/2,s=Wi(t[0]-r[0])/2,l=Math.sin(a)*Math.sin(a)+Math.sin(s)*Math.sin(s)*Math.cos(i)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}function ts(r,t,e){var n;if(t!==void 0){for(var i=0,o=r.length;i<o;++i)t[i]=r[i];n=t}else n=r.slice();return n}function bc(r,t,e){if(t!==void 0&&r!==t){for(var n=0,i=r.length;n<i;++n)t[n]=r[n];r=t}return r}function v_(r){d_(r.getCode(),r),ho(r,r,ts)}function __(r){r.forEach(v_)}function Ue(r){return typeof r=="string"?h_(r):r||null}function wc(r,t,e,n){r=Ue(r);var i,o=r.getPointResolutionFunc();if(o){if(i=o(t,e),n&&n!==r.getUnits()){var a=r.getMetersPerUnit();a&&(i=i*a/Lt[n])}}else{var s=r.getUnits();if(s==lr.DEGREES&&!n||n==lr.DEGREES)i=t;else{var l=ns(r,Ue("EPSG:4326"));if(l===bc&&s!==lr.DEGREES)i=t*r.getMetersPerUnit();else{var u=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];u=l(u,u,2);var c=xc(u.slice(0,2),u.slice(2,4)),f=xc(u.slice(4,6),u.slice(6,8));i=(c+f)/2}var a=n?Lt[n]:r.getMetersPerUnit();a!==void 0&&(i/=a)}}return i}function Cc(r){__(r),r.forEach(function(t){r.forEach(function(e){t!==e&&ho(t,e,ts)})})}function y_(r,t,e,n){r.forEach(function(i){t.forEach(function(o){ho(i,o,e),ho(o,i,n)})})}function rs(r,t){return r?typeof r=="string"?Ue(r):r:Ue(t)}function ur(r,t){if(r===t)return!0;var e=r.getUnits()===t.getUnits();if(r.getCode()===t.getCode())return e;var n=ns(r,t);return n===ts&&e}function ns(r,t){var e=r.getCode(),n=t.getCode(),i=p_(e,n);return i||(i=bc),i}function Vn(r,t){var e=Ue(r),n=Ue(t);return ns(e,n)}function m_(r,t,e){var n=Vn(t,e);return n(r,void 0,r.length)}function T_(r,t,e,n){var i=Vn(t,e);return ev(r,i,void 0,n)}var E_=null;function x_(){return E_}function po(r,t){return r}function Vt(r,t){return r}function Rc(r,t){return r}function Pr(r,t){return r}function b_(){Cc(mc),Cc(Ec),y_(Ec,mc,s_,l_)}b_();function Sc(r,t,e){return function(n,i,o,a,s){if(n){var l=t?0:o[0]*i,u=t?0:o[1]*i,c=s?s[0]:0,f=s?s[1]:0,h=r[0]+l/2+c,d=r[2]-l/2+c,p=r[1]+u/2+f,g=r[3]-u/2+f;h>d&&(h=(d+h)/2,d=h),p>g&&(p=(g+p)/2,g=p);var _=Fe(n[0],h,d),x=Fe(n[1],p,g),T=30*i;return a&&e&&(_+=-T*Math.log(1+Math.max(0,h-n[0])/T)+T*Math.log(1+Math.max(0,n[0]-d)/T),x+=-T*Math.log(1+Math.max(0,p-n[1])/T)+T*Math.log(1+Math.max(0,n[1]-g)/T)),[_,x]}else return}}function w_(r){return r}function is(r,t,e,n){var i=Ve(t)/e[0],o=mt(t)/e[1];return n?Math.min(r,Math.max(i,o)):Math.min(r,Math.min(i,o))}function os(r,t,e){var n=Math.min(r,t),i=50;return n*=Math.log(1+i*Math.max(0,r/t-1))/i+1,e&&(n=Math.max(n,e),n/=Math.log(1+i*Math.max(0,e/r-1))/i+1),Fe(n,e/2,t*2)}function C_(r,t,e,n){return function(i,o,a,s){if(i!==void 0){var l=r[0],u=r[r.length-1],c=e?is(l,e,a,n):l;if(s){var f=t!==void 0?t:!0;return f?os(i,c,u):Fe(i,u,c)}var h=Math.min(c,i),d=Math.floor(ka(r,h,o));return r[d]>c&&d<r.length-1?r[d+1]:r[d]}else return}}function R_(r,t,e,n,i,o){return function(a,s,l,u){if(a!==void 0){var c=i?is(t,i,l,o):t,f=e!==void 0?e:0;if(u){var h=n!==void 0?n:!0;return h?os(a,c,f):Fe(a,f,c)}var d=1e-9,p=Math.ceil(Math.log(t/c)/Math.log(r)-d),g=-s*(.5-d)+.5,_=Math.min(c,a),x=Math.floor(Math.log(t/_)/Math.log(r)+g),T=Math.max(p,x),E=t/Math.pow(r,T);return Fe(E,f,c)}else return}}function Ac(r,t,e,n,i){return function(o,a,s,l){if(o!==void 0){var u=n?is(r,n,s,i):r,c=e!==void 0?e:!0;return!c||!l?Fe(o,t,u):os(o,u,t)}else return}}function as(r){if(r!==void 0)return 0}function Oc(r){if(r!==void 0)return r}function S_(r){var t=2*Math.PI/r;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function A_(r){var t=r||Wi(5);return function(e,n){if(n)return e;if(e!==void 0)return Math.abs(e)<=t?0:e}}function Pc(r){return Math.pow(r,3)}function ln(r){return 1-Pc(1-r)}function O_(r){return 3*r*r-2*r*r*r}function P_(r){return r}var st={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function I_(r,t,e,n,i,o){for(var a=o||[],s=0,l=t;l<e;l+=n){var u=r[l],c=r[l+1];a[s++]=i[0]*u+i[2]*c+i[4],a[s++]=i[1]*u+i[3]*c+i[5]}return o&&a.length!=s&&(a.length=s),a}function M_(r,t,e,n,i,o,a){for(var s=a||[],l=Math.cos(i),u=Math.sin(i),c=o[0],f=o[1],h=0,d=t;d<e;d+=n){var p=r[d]-c,g=r[d+1]-f;s[h++]=c+p*l-g*u,s[h++]=f+p*u+g*l;for(var _=d+2;_<d+n;++_)s[h++]=r[_]}return a&&s.length!=h&&(s.length=h),s}function D_(r,t,e,n,i,o,a,s){for(var l=s||[],u=a[0],c=a[1],f=0,h=t;h<e;h+=n){var d=r[h]-u,p=r[h+1]-c;l[f++]=u+i*d,l[f++]=c+o*p;for(var g=h+2;g<h+n;++g)l[f++]=r[g]}return s&&l.length!=f&&(l.length=f),l}function L_(r,t,e,n,i,o,a){for(var s=a||[],l=0,u=t;u<e;u+=n){s[l++]=r[u]+i,s[l++]=r[u+1]+o;for(var c=u+2;c<u+n;++c)s[l++]=r[c]}return a&&s.length!=l&&(s.length=l),s}var k_=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ic=Mt(),N_=function(r){k_(t,r);function t(){var e=r.call(this)||this;return e.extent_=Rr(),e.extentRevision_=-1,e.simplifiedGeometryMaxMinSquaredTolerance=0,e.simplifiedGeometryRevision=0,e.simplifyTransformedInternal=Ig(function(n,i,o){if(!o)return this.getSimplifiedGeometry(i);var a=this.clone();return a.applyTransform(o),a.getSimplifiedGeometry(i)}),e}return t.prototype.simplifyTransformed=function(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)},t.prototype.clone=function(){return Re()},t.prototype.closestPointXY=function(e,n,i,o){return Re()},t.prototype.containsXY=function(e,n){var i=this.getClosestPoint([e,n]);return i[0]===e&&i[1]===n},t.prototype.getClosestPoint=function(e,n){var i=n||[NaN,NaN];return this.closestPointXY(e[0],e[1],i,1/0),i},t.prototype.intersectsCoordinate=function(e){return this.containsXY(e[0],e[1])},t.prototype.computeExtent=function(e){return Re()},t.prototype.getExtent=function(e){if(this.extentRevision_!=this.getRevision()){var n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&zi(n),this.extentRevision_=this.getRevision()}return Qg(this.extent_,e)},t.prototype.rotate=function(e,n){Re()},t.prototype.scale=function(e,n,i){Re()},t.prototype.simplify=function(e){return this.getSimplifiedGeometry(e*e)},t.prototype.getSimplifiedGeometry=function(e){return Re()},t.prototype.getType=function(){return Re()},t.prototype.applyTransform=function(e){Re()},t.prototype.intersectsExtent=function(e){return Re()},t.prototype.translate=function(e,n){Re()},t.prototype.transform=function(e,n){var i=Ue(e),o=i.getUnits()==lr.TILE_PIXELS?function(a,s,l){var u=i.getExtent(),c=i.getWorldExtent(),f=mt(c)/mt(u);return nr(Ic,c[0],c[3],f,-f,0,0,0),I_(a,0,a.length,l,Ic,s),Vn(i,n)(a,s,l)}:Vn(i,n);return this.applyTransform(o),this},t}(Kt),F_=N_,U_=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),G_=function(r){U_(t,r);function t(){var e=r.call(this)||this;return e.layout=st.XY,e.stride=2,e.flatCoordinates=null,e}return t.prototype.computeExtent=function(e){return Zg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)},t.prototype.getCoordinates=function(){return Re()},t.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},t.prototype.getFlatCoordinates=function(){return this.flatCoordinates},t.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},t.prototype.getLayout=function(){return this.layout},t.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var n=this.getSimplifiedGeometryInternal(e),i=n.getFlatCoordinates();return i.length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)},t.prototype.getSimplifiedGeometryInternal=function(e){return this},t.prototype.getStride=function(){return this.stride},t.prototype.setFlatCoordinates=function(e,n){this.stride=Mc(e),this.layout=e,this.flatCoordinates=n},t.prototype.setCoordinates=function(e,n){Re()},t.prototype.setLayout=function(e,n,i){var o;if(e)o=Mc(e);else{for(var a=0;a<i;++a)if(n.length===0){this.layout=st.XY,this.stride=2;return}else n=n[0];o=n.length,e=j_(o)}this.layout=e,this.stride=o},t.prototype.applyTransform=function(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},t.prototype.rotate=function(e,n){var i=this.getFlatCoordinates();if(i){var o=this.getStride();M_(i,0,i.length,o,e,n,i),this.changed()}},t.prototype.scale=function(e,n,i){var o=n;o===void 0&&(o=e);var a=i;a||(a=en(this.getExtent()));var s=this.getFlatCoordinates();if(s){var l=this.getStride();D_(s,0,s.length,l,e,o,a,s),this.changed()}},t.prototype.translate=function(e,n){var i=this.getFlatCoordinates();if(i){var o=this.getStride();L_(i,0,i.length,o,e,n,i),this.changed()}},t}(F_);function j_(r){var t;return r==2?t=st.XY:r==3?t=st.XYZ:r==4&&(t=st.XYZM),t}function Mc(r){var t;return r==st.XY?t=2:r==st.XYZ||r==st.XYM?t=3:r==st.XYZM&&(t=4),t}var ss=G_;function Dc(r,t,e,n,i,o,a){var s=r[t],l=r[t+1],u=r[e]-s,c=r[e+1]-l,f;if(u===0&&c===0)f=t;else{var h=((i-s)*u+(o-l)*c)/(u*u+c*c);if(h>1)f=e;else if(h>0){for(var d=0;d<n;++d)a[d]=iv(r[t+d],r[e+d],h);a.length=n;return}else f=t}for(var d=0;d<n;++d)a[d]=r[f+d];a.length=n}function Lc(r,t,e,n,i){var o=r[t],a=r[t+1];for(t+=n;t<e;t+=n){var s=r[t],l=r[t+1],u=tn(o,a,s,l);u>i&&(i=u),o=s,a=l}return i}function B_(r,t,e,n,i){for(var o=0,a=e.length;o<a;++o){var s=e[o];i=Lc(r,t,s,n,i),t=s}return i}function kc(r,t,e,n,i,o,a,s,l,u,c){if(t==e)return u;var f,h;if(i===0)if(h=tn(a,s,r[t],r[t+1]),h<u){for(f=0;f<n;++f)l[f]=r[t+f];return l.length=n,h}else return u;for(var d=c||[NaN,NaN],p=t+n;p<e;)if(Dc(r,p-n,p,n,a,s,d),h=tn(a,s,d[0],d[1]),h<u){for(u=h,f=0;f<n;++f)l[f]=d[f];l.length=n,p+=n}else p+=n*Math.max((Math.sqrt(h)-Math.sqrt(u))/i|0,1);if(o&&(Dc(r,e-n,t,n,a,s,d),h=tn(a,s,d[0],d[1]),h<u)){for(u=h,f=0;f<n;++f)l[f]=d[f];l.length=n}return u}function $_(r,t,e,n,i,o,a,s,l,u,c){for(var f=c||[NaN,NaN],h=0,d=e.length;h<d;++h){var p=e[h];u=kc(r,t,p,n,i,o,a,s,l,u,f),t=p}return u}function z_(r,t,e,n){for(var i=0,o=e.length;i<o;++i)r[t++]=e[i];return t}function Nc(r,t,e,n){for(var i=0,o=e.length;i<o;++i)for(var a=e[i],s=0;s<n;++s)r[t++]=a[s];return t}function K_(r,t,e,n,i){for(var o=i||[],a=0,s=0,l=e.length;s<l;++s){var u=Nc(r,t,e[s],n);o[a++]=u,t=u}return o.length=a,o}function V_(r,t,e,n,i,o,a){var s=(e-t)/n;if(s<3){for(;t<e;t+=n)o[a++]=r[t],o[a++]=r[t+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var u=[t,e-n],c=0;u.length>0;){for(var f=u.pop(),h=u.pop(),d=0,p=r[h],g=r[h+1],_=r[f],x=r[f+1],T=h+n;T<f;T+=n){var E=r[T],y=r[T+1],w=rv(E,y,p,g,_,x);w>d&&(c=T,d=w)}d>i&&(l[(c-t)/n]=1,h+n<c&&u.push(h,c),c+n<f&&u.push(c,f))}for(var T=0;T<s;++T)l[T]&&(o[a++]=r[t+T*n],o[a++]=r[t+T*n+1]);return a}function un(r,t){return t*Math.round(r/t)}function X_(r,t,e,n,i,o,a){if(t==e)return a;var s=un(r[t],i),l=un(r[t+1],i);t+=n,o[a++]=s,o[a++]=l;var u,c;do if(u=un(r[t],i),c=un(r[t+1],i),t+=n,t==e)return o[a++]=u,o[a++]=c,a;while(u==s&&c==l);for(;t<e;){var f=un(r[t],i),h=un(r[t+1],i);if(t+=n,!(f==u&&h==c)){var d=u-s,p=c-l,g=f-s,_=h-l;if(d*_==p*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(p<0&&_<p||p==_||p>0&&_>p)){u=f,c=h;continue}o[a++]=u,o[a++]=c,s=u,l=c,u=f,c=h}}return o[a++]=u,o[a++]=c,a}function H_(r,t,e,n,i,o,a,s){for(var l=0,u=e.length;l<u;++l){var c=e[l];a=X_(r,t,c,n,i,o,a),s.push(a),t=c}return a}function Fc(r,t,e,n,i){for(var o=i!==void 0?i:[],a=0,s=t;s<e;s+=n)o[a++]=r.slice(s,s+n);return o.length=a,o}function Z_(r,t,e,n,i){for(var o=i!==void 0?i:[],a=0,s=0,l=e.length;s<l;++s){var u=e[s];o[a++]=Fc(r,t,u,n,o[a]),t=u}return o.length=a,o}function Uc(r,t,e,n){for(var i=0,o=r[e-n],a=r[e-n+1];t<e;t+=n){var s=r[t],l=r[t+1];i+=a*s-o*l,o=s,a=l}return i/2}function W_(r,t,e,n){for(var i=0,o=0,a=e.length;o<a;++o){var s=e[o];i+=Uc(r,t,s,n),t=s}return i}var Y_=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),q_=function(r){Y_(t,r);function t(e,n){var i=r.call(this)||this;return i.maxDelta_=-1,i.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?i.setFlatCoordinates(n,e):i.setCoordinates(e,n),i}return t.prototype.clone=function(){return new t(this.flatCoordinates.slice(),this.layout)},t.prototype.closestPointXY=function(e,n,i,o){return o<Zu(this.getExtent(),e,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Lc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),kc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,i,o))},t.prototype.getArea=function(){return Uc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getCoordinates=function(){return Fc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},t.prototype.getSimplifiedGeometryInternal=function(e){var n=[];return n.length=V_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new t(n,st.XY)},t.prototype.getType=function(){return uo.LINEAR_RING},t.prototype.intersectsExtent=function(e){return!1},t.prototype.setCoordinates=function(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Nc(this.flatCoordinates,0,e,this.stride),this.changed()},t}(ss),Gc=q_,Q_=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),J_=function(r){Q_(t,r);function t(e,n){var i=r.call(this)||this;return i.setCoordinates(e,n),i}return t.prototype.clone=function(){var e=new t(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e},t.prototype.closestPointXY=function(e,n,i,o){var a=this.flatCoordinates,s=tn(e,n,a[0],a[1]);if(s<o){for(var l=this.stride,u=0;u<l;++u)i[u]=a[u];return i.length=l,s}else return o},t.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},t.prototype.computeExtent=function(e){return Hg(this.flatCoordinates,e)},t.prototype.getType=function(){return uo.POINT},t.prototype.intersectsExtent=function(e){return Yu(e,this.flatCoordinates[0],this.flatCoordinates[1])},t.prototype.setCoordinates=function(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=z_(this.flatCoordinates,0,e,this.stride),this.changed()},t}(ss),ey=J_;function ty(r,t,e,n,i){var o=Ju(i,function(a){return!Ir(r,t,e,n,a[0],a[1])});return!o}function Ir(r,t,e,n,i,o){for(var a=0,s=r[e-n],l=r[e-n+1];t<e;t+=n){var u=r[t],c=r[t+1];l<=o?c>o&&(u-s)*(o-l)-(i-s)*(c-l)>0&&a++:c<=o&&(u-s)*(o-l)-(i-s)*(c-l)<0&&a--,s=u,l=c}return a!==0}function jc(r,t,e,n,i,o){if(e.length===0||!Ir(r,t,e[0],n,i,o))return!1;for(var a=1,s=e.length;a<s;++a)if(Ir(r,e[a-1],e[a],n,i,o))return!1;return!0}function ry(r,t,e,n,i,o,a){for(var s,l,u,c,f,h,d,p=i[o+1],g=[],_=0,x=e.length;_<x;++_){var T=e[_];for(c=r[T-n],h=r[T-n+1],s=t;s<T;s+=n)f=r[s],d=r[s+1],(p<=h&&d<=p||h<=p&&p<=d)&&(u=(p-h)/(d-h)*(f-c)+c,g.push(u)),c=f,h=d}var E=NaN,y=-1/0;for(g.sort(ji),c=g[0],s=1,l=g.length;s<l;++s){f=g[s];var w=Math.abs(f-c);w>y&&(u=(c+f)/2,jc(r,t,e,n,u,p)&&(E=u,y=w)),c=f}return isNaN(E)&&(E=i[o]),a?(a.push(E,p,y),a):[E,p,y]}function ny(r,t,e,n,i){var o;for(t+=n;t<e;t+=n)if(o=i(r.slice(t-n,t),r.slice(t,t+n)),o)return o;return!1}function Bc(r,t,e,n,i){var o=Qu(Rr(),r,t,e,n);return Ka(i,o)?Wu(i,o)||o[0]>=i[0]&&o[2]<=i[2]||o[1]>=i[1]&&o[3]<=i[3]?!0:ny(r,t,e,n,function(a,s){return Jg(i,a,s)}):!1}function iy(r,t,e,n,i){return!!(Bc(r,t,e,n,i)||Ir(r,t,e,n,i[0],i[1])||Ir(r,t,e,n,i[0],i[3])||Ir(r,t,e,n,i[2],i[1])||Ir(r,t,e,n,i[2],i[3]))}function oy(r,t,e,n,i){if(!iy(r,t,e[0],n,i))return!1;if(e.length===1)return!0;for(var o=1,a=e.length;o<a;++o)if(ty(r,e[o-1],e[o],n,i)&&!Bc(r,e[o-1],e[o],n,i))return!1;return!0}function ay(r,t,e,n){for(;t<e-n;){for(var i=0;i<n;++i){var o=r[t+i];r[t+i]=r[e-n+i],r[e-n+i]=o}t+=n,e-=n}}function $c(r,t,e,n){for(var i=0,o=r[e-n],a=r[e-n+1];t<e;t+=n){var s=r[t],l=r[t+1];i+=(s-o)*(l+a),o=s,a=l}return i===0?void 0:i>0}function sy(r,t,e,n,i){for(var o=i!==void 0?i:!1,a=0,s=e.length;a<s;++a){var l=e[a],u=$c(r,t,l,n);if(a===0){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;t=l}return!0}function zc(r,t,e,n,i){for(var o=i!==void 0?i:!1,a=0,s=e.length;a<s;++a){var l=e[a],u=$c(r,t,l,n),c=a===0?o&&u||!o&&!u:o&&!u||!o&&u;c&&ay(r,t,l,n),t=l}return t}var ly=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Kc=function(r){ly(t,r);function t(e,n,i){var o=r.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,n!==void 0&&i?(o.setFlatCoordinates(n,e),o.ends_=i):o.setCoordinates(e,n),o}return t.prototype.appendLinearRing=function(e){this.flatCoordinates?Og(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},t.prototype.clone=function(){var e=new t(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e},t.prototype.closestPointXY=function(e,n,i,o){return o<Zu(this.getExtent(),e,n)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(B_(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$_(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,i,o))},t.prototype.containsXY=function(e,n){return jc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)},t.prototype.getArea=function(){return W_(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},t.prototype.getCoordinates=function(e){var n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),zc(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,Z_(n,0,this.ends_,this.stride)},t.prototype.getEnds=function(){return this.ends_},t.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var e=en(this.getExtent());this.flatInteriorPoint_=ry(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},t.prototype.getInteriorPoint=function(){return new ey(this.getFlatInteriorPoint(),st.XYM)},t.prototype.getLinearRingCount=function(){return this.ends_.length},t.prototype.getLinearRing=function(e){return e<0||this.ends_.length<=e?null:new Gc(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)},t.prototype.getLinearRings=function(){for(var e=this.layout,n=this.flatCoordinates,i=this.ends_,o=[],a=0,s=0,l=i.length;s<l;++s){var u=i[s],c=new Gc(n.slice(a,u),e);o.push(c),a=u}return o},t.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var e=this.flatCoordinates;sy(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=zc(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},t.prototype.getSimplifiedGeometryInternal=function(e){var n=[],i=[];return n.length=H_(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,i),new t(n,st.XY,i)},t.prototype.getType=function(){return uo.POLYGON},t.prototype.intersectsExtent=function(e){return oy(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)},t.prototype.setCoordinates=function(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=K_(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()},t}(ss);function Vc(r){var t=r[0],e=r[1],n=r[2],i=r[3],o=[t,e,t,i,n,i,n,e,t,e];return new Kc(o,st.XY,[o.length])}var uy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ls=0,cy=function(r){uy(t,r);function t(e){var n=r.call(this)||this;n.on,n.once,n.un;var i=Pe({},e);return n.hints_=[0,0],n.animations_=[],n.updateAnimationKey_,n.projection_=rs(i.projection,"EPSG:3857"),n.viewportSize_=[100,100],n.targetCenter_=null,n.targetResolution_,n.targetRotation_,n.nextCenter_=null,n.nextResolution_,n.nextRotation_,n.cancelAnchor_=void 0,i.center&&(i.center=Vt(i.center,n.projection_)),i.extent&&(i.extent=Pr(i.extent,n.projection_)),n.applyOptions_(i),n}return t.prototype.applyOptions_=function(e){var n=Pe({},e);for(var i in xt)delete n[i];this.setProperties(n,!0);var o=hy(e);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=o.minZoom;var a=fy(e),s=o.constraint,l=dy(e);this.constraints_={center:a,resolution:s,rotation:l},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)},Object.defineProperty(t.prototype,"padding",{get:function(){return this.padding_},set:function(e){var n=this.padding_;this.padding_=e;var i=this.getCenter();if(i){var o=e||[0,0,0,0];n=n||[0,0,0,0];var a=this.getResolution(),s=a/2*(o[3]-n[3]+n[1]-o[1]),l=a/2*(o[0]-n[0]+n[2]-o[2]);this.setCenterInternal([i[0]+s,i[1]-l])}},enumerable:!1,configurable:!0}),t.prototype.getUpdatedOptions_=function(e){var n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Pe({},n,e)},t.prototype.animate=function(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),i=0;i<n.length;++i){var o=arguments[i];o.center&&(o=Pe({},o),o.center=Vt(o.center,this.getProjection())),o.anchor&&(o=Pe({},o),o.anchor=Vt(o.anchor,this.getProjection())),n[i]=o}this.animateInternal.apply(this,n)},t.prototype.animateInternal=function(e){var n=arguments.length,i;n>1&&typeof arguments[n-1]=="function"&&(i=arguments[n-1],--n);for(var o=0;o<n&&!this.isDef();++o){var a=arguments[o];a.center&&this.setCenterInternal(a.center),a.zoom!==void 0?this.setZoom(a.zoom):a.resolution&&this.setResolution(a.resolution),a.rotation!==void 0&&this.setRotation(a.rotation)}if(o===n){i&&go(i,!0);return}for(var s=Date.now(),l=this.targetCenter_.slice(),u=this.targetResolution_,c=this.targetRotation_,f=[];o<n;++o){var h=arguments[o],d={start:s,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||O_,callback:i};if(h.center&&(d.sourceCenter=l,d.targetCenter=h.center.slice(),l=d.targetCenter),h.zoom!==void 0?(d.sourceResolution=u,d.targetResolution=this.getResolutionForZoom(h.zoom),u=d.targetResolution):h.resolution&&(d.sourceResolution=u,d.targetResolution=h.resolution,u=d.targetResolution),h.rotation!==void 0){d.sourceRotation=c;var p=rn(h.rotation-c+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=c+p,c=d.targetRotation}py(d)?d.complete=!0:s+=d.duration,f.push(d)}this.animations_.push(f),this.setHint(gt.ANIMATING,1),this.updateAnimations_()},t.prototype.getAnimating=function(){return this.hints_[gt.ANIMATING]>0},t.prototype.getInteracting=function(){return this.hints_[gt.INTERACTING]>0},t.prototype.cancelAnimations=function(){this.setHint(gt.ANIMATING,-this.hints_[gt.ANIMATING]);for(var e,n=0,i=this.animations_.length;n<i;++n){var o=this.animations_[n];if(o[0].callback&&go(o[0].callback,!1),!e)for(var a=0,s=o.length;a<s;++a){var l=o[a];if(!l.complete){e=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN},t.prototype.updateAnimations_=function(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!!this.getAnimating()){for(var e=Date.now(),n=!1,i=this.animations_.length-1;i>=0;--i){for(var o=this.animations_[i],a=!0,s=0,l=o.length;s<l;++s){var u=o[s];if(!u.complete){var c=e-u.start,f=u.duration>0?c/u.duration:1;f>=1?(u.complete=!0,f=1):a=!1;var h=u.easing(f);if(u.sourceCenter){var d=u.sourceCenter[0],p=u.sourceCenter[1],g=u.targetCenter[0],_=u.targetCenter[1];this.nextCenter_=u.targetCenter;var x=d+h*(g-d),T=p+h*(_-p);this.targetCenter_=[x,T]}if(u.sourceResolution&&u.targetResolution){var E=h===1?u.targetResolution:u.sourceResolution+h*(u.targetResolution-u.sourceResolution);if(u.anchor){var y=this.getViewportSize_(this.getRotation()),w=this.constraints_.resolution(E,0,y,!0);this.targetCenter_=this.calculateCenterZoom(w,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=E,this.applyTargetState_(!0)}if(u.sourceRotation!==void 0&&u.targetRotation!==void 0){var O=h===1?rn(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+h*(u.targetRotation-u.sourceRotation);if(u.anchor){var S=this.constraints_.rotation(O,!0);this.targetCenter_=this.calculateCenterRotate(S,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=O}if(this.applyTargetState_(!0),n=!0,!u.complete)break}}if(a){this.animations_[i]=null,this.setHint(gt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var P=o[0].callback;P&&go(P,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},t.prototype.calculateCenterRotate=function(e,n){var i,o=this.getCenterInternal();return o!==void 0&&(i=[o[0]-n[0],o[1]-n[1]],Za(i,e-this.getRotation()),xv(i,n)),i},t.prototype.calculateCenterZoom=function(e,n){var i,o=this.getCenterInternal(),a=this.getResolution();if(o!==void 0&&a!==void 0){var s=n[0]-e*(n[0]-o[0])/a,l=n[1]-e*(n[1]-o[1])/a;i=[s,l]}return i},t.prototype.getViewportSize_=function(e){var n=this.viewportSize_;if(e){var i=n[0],o=n[1];return[Math.abs(i*Math.cos(e))+Math.abs(o*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(o*Math.cos(e))]}else return n},t.prototype.setViewportSize=function(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},t.prototype.getCenter=function(){var e=this.getCenterInternal();return e&&po(e,this.getProjection())},t.prototype.getCenterInternal=function(){return this.get(xt.CENTER)},t.prototype.getConstraints=function(){return this.constraints_},t.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},t.prototype.getHints=function(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()},t.prototype.calculateExtent=function(e){var n=this.calculateExtentInternal(e);return Rc(n,this.getProjection())},t.prototype.calculateExtentInternal=function(e){var n=e||this.getViewportSizeMinusPadding_(),i=this.getCenterInternal();ye(i,1);var o=this.getResolution();ye(o!==void 0,2);var a=this.getRotation();return ye(a!==void 0,3),za(i,o,a,n)},t.prototype.getMaxResolution=function(){return this.maxResolution_},t.prototype.getMinResolution=function(){return this.minResolution_},t.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},t.prototype.setMaxZoom=function(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))},t.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},t.prototype.setMinZoom=function(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))},t.prototype.setConstrainResolution=function(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))},t.prototype.getProjection=function(){return this.projection_},t.prototype.getResolution=function(){return this.get(xt.RESOLUTION)},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getResolutionForExtent=function(e,n){return this.getResolutionForExtentInternal(Pr(e,this.getProjection()),n)},t.prototype.getResolutionForExtentInternal=function(e,n){var i=n||this.getViewportSizeMinusPadding_(),o=Ve(e)/i[0],a=mt(e)/i[1];return Math.max(o,a)},t.prototype.getResolutionForValueFunction=function(e){var n=e||2,i=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,a=Math.log(i/o)/Math.log(n);return function(s){var l=i/Math.pow(n,s*a);return l}},t.prototype.getRotation=function(){return this.get(xt.ROTATION)},t.prototype.getValueForResolutionFunction=function(e){var n=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),o=this.minResolution_,a=Math.log(i/o)/n;return function(s){var l=Math.log(i/s)/n/a;return l}},t.prototype.getViewportSizeMinusPadding_=function(e){var n=this.getViewportSize_(e),i=this.padding_;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n},t.prototype.getState=function(){var e=this.getProjection(),n=this.getResolution(),i=this.getRotation(),o=this.getCenterInternal(),a=this.padding_;if(a){var s=this.getViewportSizeMinusPadding_();o=us(o,this.getViewportSize_(),[s[0]/2+a[3],s[1]/2+a[0]],n,i)}return{center:o.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}},t.prototype.getZoom=function(){var e,n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e},t.prototype.getZoomForResolution=function(e){var n=this.minZoom_||0,i,o;if(this.resolutions_){var a=ka(this.resolutions_,e,1);n=a,i=this.resolutions_[a],a==this.resolutions_.length-1?o=2:o=i/this.resolutions_[a+1]}else i=this.maxResolution_,o=this.zoomFactor_;return n+Math.log(i/e)/Math.log(o)},t.prototype.getResolutionForZoom=function(e){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var n=Fe(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(i,Fe(e-n,0,1))}else return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)},t.prototype.fit=function(e,n){var i;if(ye(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function",24),Array.isArray(e)){ye(!Zi(e),25);var o=Pr(e,this.getProjection());i=Vc(o)}else if(e.getType()===uo.CIRCLE){var o=Pr(e.getExtent(),this.getProjection());i=Vc(o),i.rotate(this.getRotation(),en(o))}else{var a=x_();a?i=e.clone().transform(a,this.getProjection()):i=e}this.fitInternal(i,n)},t.prototype.rotatedExtentForGeometry=function(e){for(var n=this.getRotation(),i=Math.cos(n),o=Math.sin(-n),a=e.getFlatCoordinates(),s=e.getStride(),l=1/0,u=1/0,c=-1/0,f=-1/0,h=0,d=a.length;h<d;h+=s){var p=a[h]*i-a[h+1]*o,g=a[h]*o+a[h+1]*i;l=Math.min(l,p),u=Math.min(u,g),c=Math.max(c,p),f=Math.max(f,g)}return[l,u,c,f]},t.prototype.fitInternal=function(e,n){var i=n||{},o=i.size;o||(o=this.getViewportSizeMinusPadding_());var a=i.padding!==void 0?i.padding:[0,0,0,0],s=i.nearest!==void 0?i.nearest:!1,l;i.minResolution!==void 0?l=i.minResolution:i.maxZoom!==void 0?l=this.getResolutionForZoom(i.maxZoom):l=0;var u=this.rotatedExtentForGeometry(e),c=this.getResolutionForExtentInternal(u,[o[0]-a[1]-a[3],o[1]-a[0]-a[2]]);c=isNaN(c)?l:Math.max(c,l),c=this.getConstrainedResolution(c,s?0:1);var f=this.getRotation(),h=Math.sin(f),d=Math.cos(f),p=en(u);p[0]+=(a[1]-a[3])/2*c,p[1]+=(a[0]-a[2])/2*c;var g=p[0]*d-p[1]*h,_=p[1]*d+p[0]*h,x=this.getConstrainedCenter([g,_],c),T=i.callback?i.callback:Gn;i.duration!==void 0?this.animateInternal({resolution:c,center:x,duration:i.duration,easing:i.easing},T):(this.targetResolution_=c,this.targetCenter_=x,this.applyTargetState_(!1,!0),go(T,!0))},t.prototype.centerOn=function(e,n,i){this.centerOnInternal(Vt(e,this.getProjection()),n,i)},t.prototype.centerOnInternal=function(e,n,i){this.setCenterInternal(us(e,n,i,this.getResolution(),this.getRotation()))},t.prototype.calculateCenterShift=function(e,n,i,o){var a,s=this.padding_;if(s&&e){var l=this.getViewportSizeMinusPadding_(-i),u=us(e,o,[l[0]/2+s[3],l[1]/2+s[0]],n,i);a=[e[0]-u[0],e[1]-u[1]]}return a},t.prototype.isDef=function(){return!!this.getCenterInternal()&&this.getResolution()!==void 0},t.prototype.adjustCenter=function(e){var n=po(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])},t.prototype.adjustCenterInternal=function(e){var n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])},t.prototype.adjustResolution=function(e,n){var i=n&&Vt(n,this.getProjection());this.adjustResolutionInternal(e,i)},t.prototype.adjustResolutionInternal=function(e,n){var i=this.getAnimating()||this.getInteracting(),o=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*e,0,o,i);n&&(this.targetCenter_=this.calculateCenterZoom(a,n)),this.targetResolution_*=e,this.applyTargetState_()},t.prototype.adjustZoom=function(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)},t.prototype.adjustRotation=function(e,n){n&&(n=Vt(n,this.getProjection())),this.adjustRotationInternal(e,n)},t.prototype.adjustRotationInternal=function(e,n){var i=this.getAnimating()||this.getInteracting(),o=this.constraints_.rotation(this.targetRotation_+e,i);n&&(this.targetCenter_=this.calculateCenterRotate(o,n)),this.targetRotation_+=e,this.applyTargetState_()},t.prototype.setCenter=function(e){this.setCenterInternal(Vt(e,this.getProjection()))},t.prototype.setCenterInternal=function(e){this.targetCenter_=e,this.applyTargetState_()},t.prototype.setHint=function(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]},t.prototype.setResolution=function(e){this.targetResolution_=e,this.applyTargetState_()},t.prototype.setRotation=function(e){this.targetRotation_=e,this.applyTargetState_()},t.prototype.setZoom=function(e){this.setResolution(this.getResolutionForZoom(e))},t.prototype.applyTargetState_=function(e,n){var i=this.getAnimating()||this.getInteracting()||n,o=this.constraints_.rotation(this.targetRotation_,i),a=this.getViewportSize_(o),s=this.constraints_.resolution(this.targetResolution_,0,a,i),l=this.constraints_.center(this.targetCenter_,s,a,i,this.calculateCenterShift(this.targetCenter_,s,o,a));this.get(xt.ROTATION)!==o&&this.set(xt.ROTATION,o),this.get(xt.RESOLUTION)!==s&&(this.set(xt.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(xt.CENTER)||!Ha(this.get(xt.CENTER),l))&&this.set(xt.CENTER,l),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0},t.prototype.resolveConstraints=function(e,n,i){var o=e!==void 0?e:200,a=n||0,s=this.constraints_.rotation(this.targetRotation_),l=this.getViewportSize_(s),u=this.constraints_.resolution(this.targetResolution_,a,l),c=this.constraints_.center(this.targetCenter_,u,l,!1,this.calculateCenterShift(this.targetCenter_,u,s,l));if(o===0&&!this.cancelAnchor_){this.targetResolution_=u,this.targetRotation_=s,this.targetCenter_=c,this.applyTargetState_();return}var f=i||(o===0?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,(this.getResolution()!==u||this.getRotation()!==s||!this.getCenterInternal()||!Ha(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:c,resolution:u,duration:o,easing:ln,anchor:f}))},t.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(gt.INTERACTING,1)},t.prototype.endInteraction=function(e,n,i){var o=i&&Vt(i,this.getProjection());this.endInteractionInternal(e,n,o)},t.prototype.endInteractionInternal=function(e,n,i){this.setHint(gt.INTERACTING,-1),this.resolveConstraints(e,n,i)},t.prototype.getConstrainedCenter=function(e,n){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),i)},t.prototype.getConstrainedZoom=function(e,n){var i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,n))},t.prototype.getConstrainedResolution=function(e,n){var i=n||0,o=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,i,o)},t}(Kt);function go(r,t){setTimeout(function(){r(t)},0)}function fy(r){if(r.extent!==void 0){var t=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return Sc(r.extent,r.constrainOnlyCenter,t)}var e=rs(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&e.isGlobal()){var n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,Sc(n,!1,!1)}return w_}function hy(r){var t,e,n,i=28,o=2,a=r.minZoom!==void 0?r.minZoom:ls,s=r.maxZoom!==void 0?r.maxZoom:i,l=r.zoomFactor!==void 0?r.zoomFactor:o,u=r.multiWorld!==void 0?r.multiWorld:!1,c=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,f=r.showFullExtent!==void 0?r.showFullExtent:!1,h=rs(r.projection,"EPSG:3857"),d=h.getExtent(),p=r.constrainOnlyCenter,g=r.extent;if(!u&&!g&&h.isGlobal()&&(p=!1,g=d),r.resolutions!==void 0){var _=r.resolutions;e=_[a],n=_[s]!==void 0?_[s]:_[_.length-1],r.constrainResolution?t=C_(_,c,!p&&g,f):t=Ac(e,n,c,!p&&g,f)}else{var x=d?Math.max(Ve(d),mt(d)):360*Lt[lr.DEGREES]/h.getMetersPerUnit(),T=x/Ja/Math.pow(o,ls),E=T/Math.pow(o,i-ls);e=r.maxResolution,e!==void 0?a=0:e=T/Math.pow(l,a),n=r.minResolution,n===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?n=e/Math.pow(l,s):n=T/Math.pow(l,s):n=E),s=a+Math.floor(Math.log(e/n)/Math.log(l)),n=e/Math.pow(l,s-a),r.constrainResolution?t=R_(l,e,n,c,!p&&g,f):t=Ac(e,n,c,!p&&g,f)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:a,zoomFactor:l}}function dy(r){var t=r.enableRotation!==void 0?r.enableRotation:!0;if(t){var e=r.constrainRotation;return e===void 0||e===!0?A_():e===!1?Oc:typeof e=="number"?S_(e):Oc}else return as}function py(r){return!(r.sourceCenter&&r.targetCenter&&!Ha(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function us(r,t,e,n,i){var o=Math.cos(-i),a=Math.sin(-i),s=r[0]*o-r[1]*a,l=r[1]*o+r[0]*a;s+=(t[0]/2-e[0])*n,l+=(e[1]-t[1]/2)*n,a=-a;var u=s*o-l*a,c=l*o+s*a;return[u,c]}var Mr=cy;function Xc(r){return r[0]>0&&r[1]>0}function gy(r,t,e){return e===void 0&&(e=[0,0]),e[0]=r[0]*t+.5|0,e[1]=r[1]*t+.5|0,e}function bt(r,t){return Array.isArray(r)?r:(t===void 0?t=[r,r]:(t[0]=r,t[1]=r),t)}var vy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function Hc(r){if(r instanceof Xa){r.setMapInternal(null);return}r instanceof oo&&r.getLayers().forEach(Hc)}function Zc(r,t){if(r instanceof Xa){r.setMapInternal(t);return}if(r instanceof oo)for(var e=r.getLayers().getArray(),n=0,i=e.length;n<i;++n)Zc(e[n],t)}var _y=function(r){vy(t,r);function t(e){var n=r.call(this)||this;n.on,n.once,n.un;var i=yy(e);n.renderComplete_,n.boundHandleBrowserEvent_=n.handleBrowserEvent.bind(n),n.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,n.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:ju,n.postRenderTimeoutHandle_,n.animationDelayKey_,n.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(n),n.coordinateToPixelTransform_=Mt(),n.pixelToCoordinateTransform_=Mt(),n.frameIndex_=0,n.frameState_=null,n.previousExtent_=null,n.viewPropertyListenerKey_=null,n.viewChangeListenerKey_=null,n.layerGroupPropertyListenerKeys_=null,n.viewport_=document.createElement("div"),n.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),n.viewport_.style.position="relative",n.viewport_.style.overflow="hidden",n.viewport_.style.width="100%",n.viewport_.style.height="100%",n.overlayContainer_=document.createElement("div"),n.overlayContainer_.style.position="absolute",n.overlayContainer_.style.zIndex="0",n.overlayContainer_.style.width="100%",n.overlayContainer_.style.height="100%",n.overlayContainer_.style.pointerEvents="none",n.overlayContainer_.className="ol-overlaycontainer",n.viewport_.appendChild(n.overlayContainer_),n.overlayContainerStopEvent_=document.createElement("div"),n.overlayContainerStopEvent_.style.position="absolute",n.overlayContainerStopEvent_.style.zIndex="0",n.overlayContainerStopEvent_.style.width="100%",n.overlayContainerStopEvent_.style.height="100%",n.overlayContainerStopEvent_.style.pointerEvents="none",n.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",n.viewport_.appendChild(n.overlayContainerStopEvent_),n.mapBrowserEventHandler_=null,n.moveTolerance_=e.moveTolerance,n.keyboardEventTarget_=i.keyboardEventTarget,n.targetChangeHandlerKeys_=null,n.controls=i.controls||new Tt,n.interactions=i.interactions||new Tt,n.overlays_=i.overlays,n.overlayIdIndex_={},n.renderer_=null,n.postRenderFunctions_=[],n.tileQueue_=new Jv(n.getTilePriority.bind(n),n.handleTileChange_.bind(n)),n.addChangeListener(We.LAYERGROUP,n.handleLayerGroupChanged_),n.addChangeListener(We.VIEW,n.handleViewChanged_),n.addChangeListener(We.SIZE,n.handleSizeChanged_),n.addChangeListener(We.TARGET,n.handleTargetChanged_),n.setProperties(i.values);var o=n;return e.view&&!(e.view instanceof Mr)&&e.view.then(function(a){o.setView(new Mr(a))}),n.controls.addEventListener(pt.ADD,function(a){a.element.setMap(this)}.bind(n)),n.controls.addEventListener(pt.REMOVE,function(a){a.element.setMap(null)}.bind(n)),n.interactions.addEventListener(pt.ADD,function(a){a.element.setMap(this)}.bind(n)),n.interactions.addEventListener(pt.REMOVE,function(a){a.element.setMap(null)}.bind(n)),n.overlays_.addEventListener(pt.ADD,function(a){this.addOverlayInternal_(a.element)}.bind(n)),n.overlays_.addEventListener(pt.REMOVE,function(a){var s=a.element,l=s.getId();l!==void 0&&delete this.overlayIdIndex_[l.toString()],a.element.setMap(null)}.bind(n)),n.controls.forEach(function(a){a.setMap(this)}.bind(n)),n.interactions.forEach(function(a){a.setMap(this)}.bind(n)),n.overlays_.forEach(n.addOverlayInternal_.bind(n)),n}return t.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},t.prototype.addControl=function(e){this.getControls().push(e)},t.prototype.addInteraction=function(e){this.getInteractions().push(e)},t.prototype.addLayer=function(e){var n=this.getLayerGroup().getLayers();n.push(e)},t.prototype.handleLayerAdd_=function(e){Zc(e.layer,this)},t.prototype.addOverlay=function(e){this.getOverlays().push(e)},t.prototype.addOverlayInternal_=function(e){var n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)},t.prototype.disposeInternal=function(){this.setTarget(null),r.prototype.disposeInternal.call(this)},t.prototype.forEachFeatureAtPixel=function(e,n,i){if(!!this.frameState_){var o=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};var a=i.hitTolerance!==void 0?i.hitTolerance:0,s=i.layerFilter!==void 0?i.layerFilter:Un,l=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(o,this.frameState_,a,l,n,null,s,null)}},t.prototype.getFeaturesAtPixel=function(e,n){var i=[];return this.forEachFeatureAtPixel(e,function(o){i.push(o)},n),i},t.prototype.getAllLayers=function(){var e=[];function n(i){i.forEach(function(o){o instanceof oo?n(o.getLayers()):e.push(o)})}return n(this.getLayers()),e},t.prototype.forEachLayerAtPixel=function(e,n,i){if(!!this.frameState_){var o=i||{},a=o.hitTolerance!==void 0?o.hitTolerance:0,s=o.layerFilter||Un;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,a,n,s)}},t.prototype.hasFeatureAtPixel=function(e,n){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};var o=n.layerFilter!==void 0?n.layerFilter:Un,a=n.hitTolerance!==void 0?n.hitTolerance:0,s=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,a,s,o,null)},t.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},t.prototype.getEventCoordinateInternal=function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))},t.prototype.getEventPixel=function(e){var n=this.viewport_.getBoundingClientRect(),i="changedTouches"in e?e.changedTouches[0]:e;return[i.clientX-n.left,i.clientY-n.top]},t.prototype.getTarget=function(){return this.get(We.TARGET)},t.prototype.getTargetElement=function(){var e=this.getTarget();return e!==void 0?typeof e=="string"?document.getElementById(e):e:null},t.prototype.getCoordinateFromPixel=function(e){return po(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())},t.prototype.getCoordinateFromPixelInternal=function(e){var n=this.frameState_;return n?qe(n.pixelToCoordinateTransform,e.slice()):null},t.prototype.getControls=function(){return this.controls},t.prototype.getOverlays=function(){return this.overlays_},t.prototype.getOverlayById=function(e){var n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null},t.prototype.getInteractions=function(){return this.interactions},t.prototype.getLayerGroup=function(){return this.get(We.LAYERGROUP)},t.prototype.setLayers=function(e){var n=this.getLayerGroup();if(e instanceof Tt){n.setLayers(e);return}var i=n.getLayers();i.clear(),i.extend(e)},t.prototype.getLayers=function(){var e=this.getLayerGroup().getLayers();return e},t.prototype.getLoading=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),n=0,i=e.length;n<i;++n){var o=e[n].layer,a=o.getSource();if(a&&a.loading)return!0}return!1},t.prototype.getPixelFromCoordinate=function(e){var n=Vt(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)},t.prototype.getPixelFromCoordinateInternal=function(e){var n=this.frameState_;return n?qe(n.coordinateToPixelTransform,e.slice(0,2)):null},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.getSize=function(){return this.get(We.SIZE)},t.prototype.getView=function(){return this.get(We.VIEW)},t.prototype.getViewport=function(){return this.viewport_},t.prototype.getOverlayContainer=function(){return this.overlayContainer_},t.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},t.prototype.getOwnerDocument=function(){var e=this.getTargetElement();return e?e.ownerDocument:document},t.prototype.getTilePriority=function(e,n,i,o){return e_(this.frameState_,e,n,i,o)},t.prototype.handleBrowserEvent=function(e,n){var i=n||e.type,o=new sr(i,this,e);this.handleMapBrowserEvent(o)},t.prototype.handleMapBrowserEvent=function(e){if(!!this.frameState_){var n=e.originalEvent,i=n.type;if(i===Qa.POINTERDOWN||i===ee.WHEEL||i===ee.KEYDOWN){var o=this.getOwnerDocument(),a=this.viewport_.getRootNode?this.viewport_.getRootNode():o,s=n.target;if(this.overlayContainerStopEvent_.contains(s)||!(a===o?o.documentElement:a).contains(s))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1)for(var l=this.getInteractions().getArray().slice(),u=l.length-1;u>=0;u--){var c=l[u];if(!(c.getMap()!==this||!c.getActive()||!this.getTargetElement())){var f=c.handleEvent(e);if(!f||e.propagationStopped)break}}}},t.prototype.handlePostRender=function(){var e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){var i=this.maxTilesLoading_,o=i;if(e){var a=e.viewHints;if(a[gt.ANIMATING]||a[gt.INTERACTING]){var s=Date.now()-e.time>8;i=s?0:8,o=s?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,o))}e&&this.hasListener(at.RENDERCOMPLETE)&&!e.animate&&this.renderComplete_&&this.renderer_.dispatchRenderEvent(at.RENDERCOMPLETE,e);for(var l=this.postRenderFunctions_,u=0,c=l.length;u<c;++u)l[u](this,e);l.length=0},t.prototype.handleSizeChanged_=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},t.prototype.handleTargetChanged_=function(){if(this.mapBrowserEventHandler_){for(var e=0,n=this.targetChangeHandlerKeys_.length;e<n;++e)Le(this.targetChangeHandlerKeys_[e]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ee.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ee.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Ya(this.viewport_)}var i=this.getTargetElement();if(!i)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{i.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new Zv(this,this.moveTolerance_);for(var o in Se)this.mapBrowserEventHandler_.addEventListener(Se[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ee.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ee.WHEEL,this.boundHandleBrowserEvent_,$u?{passive:!1}:!1);var a=this.getOwnerDocument().defaultView,s=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[pe(s,ee.KEYDOWN,this.handleBrowserEvent,this),pe(s,ee.KEYPRESS,this.handleBrowserEvent,this),pe(a,ee.RESIZE,this.updateSize,this)]}this.updateSize()},t.prototype.handleTileChange_=function(){this.render()},t.prototype.handleViewPropertyChanged_=function(){this.render()},t.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Le(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Le(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=pe(e,Bn.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=pe(e,ee.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()},t.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Le),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ar("addlayer",e)),this.layerGroupPropertyListenerKeys_=[pe(e,Bn.PROPERTYCHANGE,this.render,this),pe(e,ee.CHANGE,this.render,this),pe(e,"addlayer",this.handleLayerAdd_,this),pe(e,"removelayer",this.handleLayerRemove_,this)]),this.render()},t.prototype.isRendered=function(){return!!this.frameState_},t.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},t.prototype.redrawText=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),n=0,i=e.length;n<i;++n){var o=e[n].layer;o.hasRenderer()&&o.getRenderer().handleFontsChanged()}},t.prototype.render=function(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},t.prototype.removeControl=function(e){return this.getControls().remove(e)},t.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},t.prototype.removeLayer=function(e){var n=this.getLayerGroup().getLayers();return n.remove(e)},t.prototype.handleLayerRemove_=function(e){Hc(e.layer)},t.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},t.prototype.renderFrame_=function(e){var n=this,i=this.getSize(),o=this.getView(),a=this.frameState_,s=null;if(i!==void 0&&Xc(i)&&o&&o.isDef()){var l=o.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=o.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:za(u.center,u.resolution,u.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:u,viewHints:l,wantedTiles:{},mapId:Ne(this),renderTargets:{}},u.nextCenter&&u.nextResolution){var c=isNaN(u.nextRotation)?u.rotation:u.nextRotation;s.nextExtent=za(u.nextCenter,u.nextResolution,c,i)}}if(this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),a){var f=!this.previousExtent_||!Zi(this.previousExtent_)&&!Ba(s.extent,this.previousExtent_);f&&(this.dispatchEvent(new ao(so.MOVESTART,this,a)),this.previousExtent_=zi(this.previousExtent_))}var h=this.previousExtent_&&!s.viewHints[gt.ANIMATING]&&!s.viewHints[gt.INTERACTING]&&!Ba(s.extent,this.previousExtent_);h&&(this.dispatchEvent(new ao(so.MOVEEND,this,s)),Xg(s.extent,this.previousExtent_))}this.dispatchEvent(new ao(so.POSTRENDER,this,s)),this.renderComplete_=!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoading(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))},t.prototype.setLayerGroup=function(e){var n=this.getLayerGroup();n&&this.handleLayerRemove_(new ar("removelayer",n)),this.set(We.LAYERGROUP,e)},t.prototype.setSize=function(e){this.set(We.SIZE,e)},t.prototype.setTarget=function(e){this.set(We.TARGET,e)},t.prototype.setView=function(e){if(!e||e instanceof Mr){this.set(We.VIEW,e);return}this.set(We.VIEW,new Mr);var n=this;e.then(function(i){n.setView(new Mr(i))})},t.prototype.updateSize=function(){var e=this.getTargetElement(),n=void 0;if(e){var i=getComputedStyle(e),o=e.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),a=e.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);!isNaN(o)&&!isNaN(a)&&(n=[o,a],!Xc(n)&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0."))}this.setSize(n),this.updateViewportSize_()},t.prototype.updateViewportSize_=function(){var e=this.getView();if(e){var n=void 0,i=getComputedStyle(this.viewport_);i.width&&i.height&&(n=[parseInt(i.width,10),parseInt(i.height,10)]),e.setViewportSize(n)}},t}(Kt);function yy(r){var t=null;r.keyboardEventTarget!==void 0&&(t=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);var e={},n=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new oo({layers:r.layers});e[We.LAYERGROUP]=n,e[We.TARGET]=r.target,e[We.VIEW]=r.view instanceof Mr?r.view:new Mr;var i;r.controls!==void 0&&(Array.isArray(r.controls)?i=new Tt(r.controls.slice()):(ye(typeof r.controls.getArray=="function",47),i=r.controls));var o;r.interactions!==void 0&&(Array.isArray(r.interactions)?o=new Tt(r.interactions.slice()):(ye(typeof r.interactions.getArray=="function",48),o=r.interactions));var a;return r.overlays!==void 0?Array.isArray(r.overlays)?a=new Tt(r.overlays.slice()):(ye(typeof r.overlays.getArray=="function",49),a=r.overlays):a=new Tt,{controls:i,interactions:o,keyboardEventTarget:t,overlays:a,values:e}}var my=_y,Ty=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ey=function(r){Ty(t,r);function t(e){var n=r.call(this)||this,i=e.element;return i&&!e.target&&!i.style.pointerEvents&&(i.style.pointerEvents="auto"),n.element=i||null,n.target_=null,n.map_=null,n.listenerKeys=[],e.render&&(n.render=e.render),e.target&&n.setTarget(e.target),n}return t.prototype.disposeInternal=function(){Ya(this.element),r.prototype.disposeInternal.call(this)},t.prototype.getMap=function(){return this.map_},t.prototype.setMap=function(e){this.map_&&Ya(this.element);for(var n=0,i=this.listenerKeys.length;n<i;++n)Le(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=e,this.map_){var o=this.target_?this.target_:e.getOverlayContainerStopEvent();o.appendChild(this.element),this.render!==Gn&&this.listenerKeys.push(pe(e,so.POSTRENDER,this.render,this)),e.render()}},t.prototype.render=function(e){},t.prototype.setTarget=function(e){this.target_=typeof e=="string"?document.getElementById(e):e},t}(Kt),cs=Ey,xy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),by=function(r){xy(t,r);function t(e){var n=this,i=e||{};n=r.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this,n.ulElement_=document.createElement("ul"),n.collapsed_=i.collapsed!==void 0?i.collapsed:!0,n.userCollapsed_=n.collapsed_,n.overrideCollapsible_=i.collapsible!==void 0,n.collapsible_=i.collapsible!==void 0?i.collapsible:!0,n.collapsible_||(n.collapsed_=!1);var o=i.className!==void 0?i.className:"ol-attribution",a=i.tipLabel!==void 0?i.tipLabel:"Attributions",s=i.expandClassName!==void 0?i.expandClassName:o+"-expand",l=i.collapseLabel!==void 0?i.collapseLabel:"\u203A",u=i.collapseClassName!==void 0?i.collapseClassName:o+"-collpase";typeof l=="string"?(n.collapseLabel_=document.createElement("span"),n.collapseLabel_.textContent=l,n.collapseLabel_.className=u):n.collapseLabel_=l;var c=i.label!==void 0?i.label:"i";typeof c=="string"?(n.label_=document.createElement("span"),n.label_.textContent=c,n.label_.className=s):n.label_=c;var f=n.collapsible_&&!n.collapsed_?n.collapseLabel_:n.label_;n.toggleButton_=document.createElement("button"),n.toggleButton_.setAttribute("type","button"),n.toggleButton_.setAttribute("aria-expanded",String(!n.collapsed_)),n.toggleButton_.title=a,n.toggleButton_.appendChild(f),n.toggleButton_.addEventListener(ee.CLICK,n.handleClick_.bind(n),!1);var h=o+" "+ro+" "+Wa+(n.collapsed_&&n.collapsible_?" "+dc:"")+(n.collapsible_?"":" ol-uncollapsible"),d=n.element;return d.className=h,d.appendChild(n.toggleButton_),d.appendChild(n.ulElement_),n.renderedAttributions_=[],n.renderedVisible_=!0,n}return t.prototype.collectSourceAttributions_=function(e){for(var n={},i=[],o=!0,a=e.layerStatesArray,s=0,l=a.length;s<l;++s){var u=a[s];if(!!eo(u,e.viewState)){var c=u.layer.getSource();if(!!c){var f=c.getAttributions();if(!!f){var h=f(e);if(!!h)if(o=o&&c.getAttributionsCollapsible()!==!1,Array.isArray(h))for(var d=0,p=h.length;d<p;++d)h[d]in n||(i.push(h[d]),n[h[d]]=!0);else h in n||(i.push(h),n[h]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(o),i},t.prototype.updateElement_=function(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}var n=this.collectSourceAttributions_(e),i=n.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Na(n,this.renderedAttributions_)){Dv(this.ulElement_);for(var o=0,a=n.length;o<a;++o){var s=document.createElement("li");s.innerHTML=n[o],this.ulElement_.appendChild(s)}this.renderedAttributions_=n}},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_},t.prototype.handleToggle_=function(){this.element.classList.toggle(dc),this.collapsed_?pc(this.collapseLabel_,this.label_):pc(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.render=function(e){this.updateElement_(e.frameState)},t}(cs),wy=by,Cy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ry=function(r){Cy(t,r);function t(e){var n=this,i=e||{};n=r.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this;var o=i.className!==void 0?i.className:"ol-rotate",a=i.label!==void 0?i.label:"\u21E7",s=i.compassClassName!==void 0?i.compassClassName:"ol-compass";n.label_=null,typeof a=="string"?(n.label_=document.createElement("span"),n.label_.className=s,n.label_.textContent=a):(n.label_=a,n.label_.classList.add(s));var l=i.tipLabel?i.tipLabel:"Reset rotation",u=document.createElement("button");u.className=o+"-reset",u.setAttribute("type","button"),u.title=l,u.appendChild(n.label_),u.addEventListener(ee.CLICK,n.handleClick_.bind(n),!1);var c=o+" "+ro+" "+Wa,f=n.element;return f.className=c,f.appendChild(u),n.callResetNorth_=i.resetNorth?i.resetNorth:void 0,n.duration_=i.duration!==void 0?i.duration:250,n.autoHide_=i.autoHide!==void 0?i.autoHide:!0,n.rotation_=void 0,n.autoHide_&&n.element.classList.add(to),n}return t.prototype.handleClick_=function(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()},t.prototype.resetNorth_=function(){var e=this.getMap(),n=e.getView();if(!!n){var i=n.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!=0?n.animate({rotation:0,duration:this.duration_,easing:ln}):n.setRotation(0))}},t.prototype.render=function(e){var n=e.frameState;if(!!n){var i=n.viewState.rotation;if(i!=this.rotation_){var o="rotate("+i+"rad)";if(this.autoHide_){var a=this.element.classList.contains(to);!a&&i===0?this.element.classList.add(to):a&&i!==0&&this.element.classList.remove(to)}this.label_.style.transform=o}this.rotation_=i}},t}(cs),Sy=Ry,Ay=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Oy=function(r){Ay(t,r);function t(e){var n=this,i=e||{};n=r.call(this,{element:document.createElement("div"),target:i.target})||this;var o=i.className!==void 0?i.className:"ol-zoom",a=i.delta!==void 0?i.delta:1,s=i.zoomInClassName!==void 0?i.zoomInClassName:o+"-in",l=i.zoomOutClassName!==void 0?i.zoomOutClassName:o+"-out",u=i.zoomInLabel!==void 0?i.zoomInLabel:"+",c=i.zoomOutLabel!==void 0?i.zoomOutLabel:"\u2013",f=i.zoomInTipLabel!==void 0?i.zoomInTipLabel:"Zoom in",h=i.zoomOutTipLabel!==void 0?i.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=s,d.setAttribute("type","button"),d.title=f,d.appendChild(typeof u=="string"?document.createTextNode(u):u),d.addEventListener(ee.CLICK,n.handleClick_.bind(n,a),!1);var p=document.createElement("button");p.className=l,p.setAttribute("type","button"),p.title=h,p.appendChild(typeof c=="string"?document.createTextNode(c):c),p.addEventListener(ee.CLICK,n.handleClick_.bind(n,-a),!1);var g=o+" "+ro+" "+Wa,_=n.element;return _.className=g,_.appendChild(d),_.appendChild(p),n.duration_=i.duration!==void 0?i.duration:250,n}return t.prototype.handleClick_=function(e,n){n.preventDefault(),this.zoomByDelta_(e)},t.prototype.zoomByDelta_=function(e){var n=this.getMap(),i=n.getView();if(!!i){var o=i.getZoom();if(o!==void 0){var a=i.getConstrainedZoom(o+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:a,duration:this.duration_,easing:ln})):i.setZoom(a)}}},t}(cs),Py=Oy;function Iy(r){var t=r||{},e=new Tt,n=t.zoom!==void 0?t.zoom:!0;n&&e.push(new Py(t.zoomOptions));var i=t.rotate!==void 0?t.rotate:!0;i&&e.push(new Sy(t.rotateOptions));var o=t.attribution!==void 0?t.attribution:!0;return o&&e.push(new wy(t.attributionOptions)),e}var Wc={ACTIVE:"active"},My=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Dy=function(r){My(t,r);function t(e){var n=r.call(this)||this;return n.on,n.once,n.un,e&&e.handleEvent&&(n.handleEvent=e.handleEvent),n.map_=null,n.setActive(!0),n}return t.prototype.getActive=function(){return this.get(Wc.ACTIVE)},t.prototype.getMap=function(){return this.map_},t.prototype.handleEvent=function(e){return!0},t.prototype.setActive=function(e){this.set(Wc.ACTIVE,e)},t.prototype.setMap=function(e){this.map_=e},t}(Kt);function Ly(r,t,e){var n=r.getCenterInternal();if(n){var i=[n[0]+t[0],n[1]+t[1]];r.animateInternal({duration:e!==void 0?e:250,easing:P_,center:r.getConstrainedCenter(i)})}}function fs(r,t,e,n){var i=r.getZoom();if(i!==void 0){var o=r.getConstrainedZoom(i+t),a=r.getResolutionForZoom(o);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:a,anchor:e,duration:n!==void 0?n:250,easing:ln})}}var Xn=Dy,ky=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ny=function(r){ky(t,r);function t(e){var n=r.call(this)||this,i=e||{};return n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:250,n}return t.prototype.handleEvent=function(e){var n=!1;if(e.type==Se.DBLCLICK){var i=e.originalEvent,o=e.map,a=e.coordinate,s=i.shiftKey?-this.delta_:this.delta_,l=o.getView();fs(l,s,a,this.duration_),i.preventDefault(),n=!0}return!n},t}(Xn),Fy=Ny,Uy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Gy=function(r){Uy(t,r);function t(e){var n=this,i=e||{};return n=r.call(this,i)||this,i.handleDownEvent&&(n.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(n.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(n.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(n.handleUpEvent=i.handleUpEvent),i.stopDown&&(n.stopDown=i.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return t.prototype.getPointerCount=function(){return this.targetPointers.length},t.prototype.handleDownEvent=function(e){return!1},t.prototype.handleDragEvent=function(e){},t.prototype.handleEvent=function(e){if(!e.originalEvent)return!0;var n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Se.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Se.POINTERUP){var i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Se.POINTERDOWN){var o=this.handleDownEvent(e);this.handlingDownUpSequence=o,n=this.stopDown(o)}else e.type==Se.POINTERMOVE&&this.handleMoveEvent(e);return!n},t.prototype.handleMoveEvent=function(e){},t.prototype.handleUpEvent=function(e){return!1},t.prototype.stopDown=function(e){return e},t.prototype.updateTrackedPointers_=function(e){if(jy(e)){var n=e.originalEvent,i=n.pointerId.toString();e.type==Se.POINTERUP?delete this.trackedPointers_[i]:e.type==Se.POINTERDOWN?this.trackedPointers_[i]=n:i in this.trackedPointers_&&(this.trackedPointers_[i]=n),this.targetPointers=fv(this.trackedPointers_)}},t}(Xn);function hs(r){for(var t=r.length,e=0,n=0,i=0;i<t;i++)e+=r[i].clientX,n+=r[i].clientY;return[e/t,n/t]}function jy(r){var t=r.type;return t===Se.POINTERDOWN||t===Se.POINTERDRAG||t===Se.POINTERUP}var Hn=Gy;function ds(r){var t=arguments;return function(e){for(var n=!0,i=0,o=t.length;i<o&&(n=n&&t[i](e),!!n);++i);return n}}var By=function(r){var t=r.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},$y=function(r){var t=r.map.getTargetElement(),e=r.map.getOwnerDocument().activeElement;return t.contains(e)},Yc=function(r){return r.map.getTargetElement().hasAttribute("tabindex")?$y(r):!0},zy=Un,qc=function(r){var t=r.originalEvent;return t.button==0&&!(Ng&&Fg&&t.ctrlKey)},Qc=function(r){var t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},Ky=function(r){var t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Jc=function(r){var t=r.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"},ps=function(r){var t=r.originalEvent;return ye(t!==void 0,56),t.pointerType=="mouse"},Vy=function(r){var t=r.originalEvent;return ye(t!==void 0,56),t.isPrimary&&t.button===0},Xy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Hy=function(r){Xy(t,r);function t(e){var n=r.call(this,{stopDown:Bi})||this,i=e||{};n.kinetic_=i.kinetic,n.lastCentroid=null,n.lastPointersCount_,n.panning_=!1;var o=i.condition?i.condition:ds(Qc,Vy);return n.condition_=i.onFocusOnly?ds(Yc,o):o,n.noKinetic_=!1,n}return t.prototype.handleDragEvent=function(e){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,i=hs(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var o=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],a=e.map,s=a.getView();bv(o,s.getResolution()),Za(o,s.getRotation()),s.adjustCenterInternal(o)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=n.length,e.originalEvent.preventDefault()},t.prototype.handleUpEvent=function(e){var n=e.map,i=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var o=this.kinetic_.getDistance(),a=this.kinetic_.getAngle(),s=i.getCenterInternal(),l=n.getPixelFromCoordinateInternal(s),u=n.getCoordinateFromPixelInternal([l[0]-o*Math.cos(a),l[1]-o*Math.sin(a)]);i.animateInternal({center:i.getConstrainedCenter(u),duration:500,easing:ln})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}else return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},t.prototype.handleDownEvent=function(e){if(this.targetPointers.length>0&&this.condition_(e)){var n=e.map,i=n.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}else return!1},t}(Hn),Zy=Hy,Wy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Yy=function(r){Wy(t,r);function t(e){var n=this,i=e||{};return n=r.call(this,{stopDown:Bi})||this,n.condition_=i.condition?i.condition:By,n.lastAngle_=void 0,n.duration_=i.duration!==void 0?i.duration:250,n}return t.prototype.handleDragEvent=function(e){if(!!ps(e)){var n=e.map,i=n.getView();if(i.getConstraints().rotation!==as){var o=n.getSize(),a=e.pixel,s=Math.atan2(o[1]/2-a[1],a[0]-o[0]/2);if(this.lastAngle_!==void 0){var l=s-this.lastAngle_;i.adjustRotationInternal(-l)}this.lastAngle_=s}}},t.prototype.handleUpEvent=function(e){if(!ps(e))return!0;var n=e.map,i=n.getView();return i.endInteraction(this.duration_),!1},t.prototype.handleDownEvent=function(e){if(!ps(e))return!1;if(qc(e)&&this.condition_(e)){var n=e.map;return n.getView().beginInteraction(),this.lastAngle_=void 0,!0}else return!1},t}(Hn),qy=Yy,Qy=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Jy=function(r){Qy(t,r);function t(e){var n=r.call(this)||this;return n.geometry_=null,n.element_=document.createElement("div"),n.element_.style.position="absolute",n.element_.style.pointerEvents="auto",n.element_.className="ol-box "+e,n.map_=null,n.startPixel_=null,n.endPixel_=null,n}return t.prototype.disposeInternal=function(){this.setMap(null)},t.prototype.render_=function(){var e=this.startPixel_,n=this.endPixel_,i="px",o=this.element_.style;o.left=Math.min(e[0],n[0])+i,o.top=Math.min(e[1],n[1])+i,o.width=Math.abs(n[0]-e[0])+i,o.height=Math.abs(n[1]-e[1])+i},t.prototype.setMap=function(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},t.prototype.setPixels=function(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()},t.prototype.createOrUpdateGeometry=function(){var e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]],o=i.map(this.map_.getCoordinateFromPixelInternal,this.map_);o[4]=o[0].slice(),this.geometry_?this.geometry_.setCoordinates([o]):this.geometry_=new Kc([o])},t.prototype.getGeometry=function(){return this.geometry_},t}(Gi),e0=Jy,ef=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vo={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"},gs=function(r){ef(t,r);function t(e,n,i){var o=r.call(this,e)||this;return o.coordinate=n,o.mapBrowserEvent=i,o}return t}(or),t0=function(r){ef(t,r);function t(e){var n=r.call(this)||this;n.on,n.once,n.un;var i=e||{};return n.box_=new e0(i.className||"ol-dragbox"),n.minArea_=i.minArea!==void 0?i.minArea:64,i.onBoxEnd&&(n.onBoxEnd=i.onBoxEnd),n.startPixel_=null,n.condition_=i.condition?i.condition:qc,n.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:n.defaultBoxEndCondition,n}return t.prototype.defaultBoxEndCondition=function(e,n,i){var o=i[0]-n[0],a=i[1]-n[1];return o*o+a*a>=this.minArea_},t.prototype.getGeometry=function(){return this.box_.getGeometry()},t.prototype.handleDragEvent=function(e){this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new gs(vo.BOXDRAG,e.coordinate,e))},t.prototype.handleUpEvent=function(e){this.box_.setMap(null);var n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new gs(n?vo.BOXEND:vo.BOXCANCEL,e.coordinate,e)),!1},t.prototype.handleDownEvent=function(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new gs(vo.BOXSTART,e.coordinate,e)),!0):!1},t.prototype.onBoxEnd=function(e){},t}(Hn),r0=t0,n0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),i0=function(r){n0(t,r);function t(e){var n=this,i=e||{},o=i.condition?i.condition:Ky;return n=r.call(this,{condition:o,className:i.className||"ol-dragzoom",minArea:i.minArea})||this,n.duration_=i.duration!==void 0?i.duration:200,n.out_=i.out!==void 0?i.out:!1,n}return t.prototype.onBoxEnd=function(e){var n=this.getMap(),i=n.getView(),o=this.getGeometry();if(this.out_){var a=i.rotatedExtentForGeometry(o),s=i.getResolutionForExtentInternal(a),l=i.getResolution()/s;o=o.clone(),o.scale(l*l)}i.fitInternal(o,{duration:this.duration_,easing:ln})},t}(r0),o0=i0,Dr={LEFT:37,UP:38,RIGHT:39,DOWN:40},a0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),s0=function(r){a0(t,r);function t(e){var n=r.call(this)||this,i=e||{};return n.defaultCondition_=function(o){return Qc(o)&&Jc(o)},n.condition_=i.condition!==void 0?i.condition:n.defaultCondition_,n.duration_=i.duration!==void 0?i.duration:100,n.pixelDelta_=i.pixelDelta!==void 0?i.pixelDelta:128,n}return t.prototype.handleEvent=function(e){var n=!1;if(e.type==ee.KEYDOWN){var i=e.originalEvent,o=i.keyCode;if(this.condition_(e)&&(o==Dr.DOWN||o==Dr.LEFT||o==Dr.RIGHT||o==Dr.UP)){var a=e.map,s=a.getView(),l=s.getResolution()*this.pixelDelta_,u=0,c=0;o==Dr.DOWN?c=-l:o==Dr.LEFT?u=-l:o==Dr.RIGHT?u=l:c=l;var f=[u,c];Za(f,s.getRotation()),Ly(s,f,this.duration_),i.preventDefault(),n=!0}}return!n},t}(Xn),l0=s0,u0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),c0=function(r){u0(t,r);function t(e){var n=r.call(this)||this,i=e||{};return n.condition_=i.condition?i.condition:Jc,n.delta_=i.delta?i.delta:1,n.duration_=i.duration!==void 0?i.duration:100,n}return t.prototype.handleEvent=function(e){var n=!1;if(e.type==ee.KEYDOWN||e.type==ee.KEYPRESS){var i=e.originalEvent,o=i.charCode;if(this.condition_(e)&&(o=="+".charCodeAt(0)||o=="-".charCodeAt(0))){var a=e.map,s=o=="+".charCodeAt(0)?this.delta_:-this.delta_,l=a.getView();fs(l,s,void 0,this.duration_),i.preventDefault(),n=!0}}return!n},t}(Xn),f0=c0,h0=function(){function r(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return r.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},r.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},r.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;var o=this.points_[e]-this.points_[n],a=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(a,o),this.initialVelocity_=Math.sqrt(o*o+a*a)/i,this.initialVelocity_>this.minVelocity_},r.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},r.prototype.getAngle=function(){return this.angle_},r}(),d0=h0,p0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vs={TRACKPAD:"trackpad",WHEEL:"wheel"},g0=function(r){p0(t,r);function t(e){var n=this,i=e||{};n=r.call(this,i)||this,n.totalDelta_=0,n.lastDelta_=0,n.maxDelta_=i.maxDelta!==void 0?i.maxDelta:1,n.duration_=i.duration!==void 0?i.duration:250,n.timeout_=i.timeout!==void 0?i.timeout:80,n.useAnchor_=i.useAnchor!==void 0?i.useAnchor:!0,n.constrainResolution_=i.constrainResolution!==void 0?i.constrainResolution:!1;var o=i.condition?i.condition:zy;return n.condition_=i.onFocusOnly?ds(Yc,o):o,n.lastAnchor_=null,n.startTime_=void 0,n.timeoutId_,n.mode_=void 0,n.trackpadEventGap_=400,n.trackpadTimeoutId_,n.deltaPerZoom_=300,n}return t.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0;var e=this.getMap().getView();e.endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},t.prototype.handleEvent=function(e){if(!this.condition_(e))return!0;var n=e.type;if(n!==ee.WHEEL)return!0;var i=e.map,o=e.originalEvent;o.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.coordinate);var a;if(e.type==ee.WHEEL&&(a=o.deltaY,kg&&o.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(a/=ju),o.deltaMode===WheelEvent.DOM_DELTA_LINE&&(a*=40)),a===0)return!1;this.lastDelta_=a;var s=Date.now();this.startTime_===void 0&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?vs.TRACKPAD:vs.WHEEL);var l=i.getView();if(this.mode_===vs.TRACKPAD&&!(l.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(l.getAnimating()&&l.cancelAnimations(),l.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),l.adjustZoom(-a/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=a;var u=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),u),!1},t.prototype.handleWheelZoom_=function(e){var n=e.getView();n.getAnimating()&&n.cancelAnimations();var i=-Fe(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),fs(n,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},t.prototype.setMouseAnchor=function(e){this.useAnchor_=e,e||(this.lastAnchor_=null)},t}(Xn),v0=g0,_0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),y0=function(r){_0(t,r);function t(e){var n=this,i=e||{},o=i;return o.stopDown||(o.stopDown=Bi),n=r.call(this,o)||this,n.anchor_=null,n.lastAngle_=void 0,n.rotating_=!1,n.rotationDelta_=0,n.threshold_=i.threshold!==void 0?i.threshold:.3,n.duration_=i.duration!==void 0?i.duration:250,n}return t.prototype.handleDragEvent=function(e){var n=0,i=this.targetPointers[0],o=this.targetPointers[1],a=Math.atan2(o.clientY-i.clientY,o.clientX-i.clientX);if(this.lastAngle_!==void 0){var s=a-this.lastAngle_;this.rotationDelta_+=s,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=s}this.lastAngle_=a;var l=e.map,u=l.getView();if(u.getConstraints().rotation!==as){var c=l.getViewport().getBoundingClientRect(),f=hs(this.targetPointers);f[0]-=c.left,f[1]-=c.top,this.anchor_=l.getCoordinateFromPixelInternal(f),this.rotating_&&(l.render(),u.adjustRotationInternal(n,this.anchor_))}},t.prototype.handleUpEvent=function(e){if(this.targetPointers.length<2){var n=e.map,i=n.getView();return i.endInteraction(this.duration_),!1}else return!0},t.prototype.handleDownEvent=function(e){if(this.targetPointers.length>=2){var n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},t}(Hn),m0=y0,T0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),E0=function(r){T0(t,r);function t(e){var n=this,i=e||{},o=i;return o.stopDown||(o.stopDown=Bi),n=r.call(this,o)||this,n.anchor_=null,n.duration_=i.duration!==void 0?i.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return t.prototype.handleDragEvent=function(e){var n=1,i=this.targetPointers[0],o=this.targetPointers[1],a=i.clientX-o.clientX,s=i.clientY-o.clientY,l=Math.sqrt(a*a+s*s);this.lastDistance_!==void 0&&(n=this.lastDistance_/l),this.lastDistance_=l;var u=e.map,c=u.getView();n!=1&&(this.lastScaleDelta_=n);var f=u.getViewport().getBoundingClientRect(),h=hs(this.targetPointers);h[0]-=f.left,h[1]-=f.top,this.anchor_=u.getCoordinateFromPixelInternal(h),u.render(),c.adjustResolutionInternal(n,this.anchor_)},t.prototype.handleUpEvent=function(e){if(this.targetPointers.length<2){var n=e.map,i=n.getView(),o=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,o),!1}else return!0},t.prototype.handleDownEvent=function(e){if(this.targetPointers.length>=2){var n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}else return!1},t}(Hn),x0=E0,vt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},b0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),w0=function(r){b0(t,r);function t(e){var n=r.call(this)||this;return n.boundHandleImageChange_=n.handleImageChange_.bind(n),n.layer_=e,n.declutterExecutorGroup=null,n}return t.prototype.getFeatures=function(e){return Re()},t.prototype.prepareFrame=function(e){return Re()},t.prototype.renderFrame=function(e,n){return Re()},t.prototype.loadedTileCallback=function(e,n,i){e[n]||(e[n]={}),e[n][i.tileCoord.toString()]=i},t.prototype.createLoadedTileFinder=function(e,n,i){return function(o,a){var s=this.loadedTileCallback.bind(this,i,o);return e.forEachLoadedTile(n,o,a,s)}.bind(this)},t.prototype.forEachFeatureAtCoordinate=function(e,n,i,o,a){},t.prototype.getDataAtPixel=function(e,n,i){return null},t.prototype.getLayer=function(){return this.layer_},t.prototype.handleFontsChanged=function(){},t.prototype.handleImageChange_=function(e){var n=e.target;n.getState()===vt.LOADED&&this.renderIfReadyAndVisible()},t.prototype.loadImage=function(e){var n=e.getState();return n!=vt.LOADED&&n!=vt.ERROR&&e.addEventListener(ee.CHANGE,this.boundHandleImageChange_),n==vt.IDLE&&(e.load(),n=e.getState()),n==vt.LOADED},t.prototype.renderIfReadyAndVisible=function(){var e=this.getLayer();e.getVisible()&&e.getSourceState()==Dt.READY&&e.changed()},t}(uc),tf=w0,C0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),R0=function(r){C0(t,r);function t(e){var n=r.call(this,e)||this;return n.container=null,n.renderedResolution,n.tempTransform=Mt(),n.pixelTransform=Mt(),n.inversePixelTransform=Mt(),n.context=null,n.containerReused=!1,n.pixelContext_=null,n}return t.prototype.getBackground=function(e){var n=this.getLayer(),i=n.getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0},t.prototype.useContainer=function(e,n,i,o){var a=this.getLayer().getClassName(),s,l;if(e&&e.className===a&&e.style.opacity===""&&i===1&&(!o||e.style.backgroundColor&&Na(Va(e.style.backgroundColor),Va(o)))){var u=e.firstElementChild;u instanceof HTMLCanvasElement&&(l=u.getContext("2d"))}if(l&&l.canvas.style.transform===n?(this.container=e,this.context=l,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){s=document.createElement("div"),s.className=a;var c=s.style;c.position="absolute",c.width="100%",c.height="100%",o&&(c.backgroundColor=o),l=no();var u=l.canvas;s.appendChild(u),c=u.style,c.position="absolute",c.left="0",c.transformOrigin="top left",this.container=s,this.context=l}},t.prototype.clipUnrotated=function(e,n,i){var o=Ar(i),a=Hi(i),s=Xi(i),l=Vi(i);qe(n.coordinateToPixelTransform,o),qe(n.coordinateToPixelTransform,a),qe(n.coordinateToPixelTransform,s),qe(n.coordinateToPixelTransform,l);var u=this.inversePixelTransform;qe(u,o),qe(u,a),qe(u,s),qe(u,l),e.save(),e.beginPath(),e.moveTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(l[0]),Math.round(l[1])),e.clip()},t.prototype.dispatchRenderEvent_=function(e,n,i){var o=this.getLayer();if(o.hasListener(e)){var a=new zn(e,this.inversePixelTransform,i,n);o.dispatchEvent(a)}},t.prototype.preRender=function(e,n){this.dispatchRenderEvent_(at.PRERENDER,e,n)},t.prototype.postRender=function(e,n){this.dispatchRenderEvent_(at.POSTRENDER,e,n)},t.prototype.getRenderTransform=function(e,n,i,o,a,s,l){var u=a/2,c=s/2,f=o/n,h=-f,d=-e[0]+l,p=-e[1];return nr(this.tempTransform,u,c,f,h,-i,d,p)},t.prototype.getDataAtPixel=function(e,n,i){var o=qe(this.inversePixelTransform,e.slice()),a=this.context,s=this.getLayer(),l=s.getExtent();if(l){var u=qe(n.pixelToCoordinateTransform,e.slice());if(!$i(l,u))return null}var c=Math.round(o[0]),f=Math.round(o[1]),h=this.pixelContext_;if(!h){var d=document.createElement("canvas");d.width=1,d.height=1,h=d.getContext("2d"),this.pixelContext_=h}h.clearRect(0,0,1,1);var p;try{h.drawImage(a.canvas,c,f,1,1,0,0,1,1),p=h.getImageData(0,0,1,1).data}catch(g){return g.name==="SecurityError"?(this.pixelContext_=null,new Uint8Array):p}return p[3]===0?null:p},t}(tf),S0=R0,A0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),O0=function(r){A0(t,r);function t(e,n,i,o){var a=r.call(this)||this;return a.extent=e,a.pixelRatio_=i,a.resolution=n,a.state=o,a}return t.prototype.changed=function(){this.dispatchEvent(ee.CHANGE)},t.prototype.getExtent=function(){return this.extent},t.prototype.getImage=function(){return Re()},t.prototype.getPixelRatio=function(){return this.pixelRatio_},t.prototype.getResolution=function(){return this.resolution},t.prototype.getState=function(){return this.state},t.prototype.load=function(){Re()},t}(nn),P0=O0,I0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();(function(r){I0(t,r);function t(e,n,i,o,a,s){var l=r.call(this,e,n,i,vt.IDLE)||this;return l.src_=o,l.image_=new Image,a!==null&&(l.image_.crossOrigin=a),l.unlisten_=null,l.state=vt.IDLE,l.imageLoadFunction_=s,l}return t.prototype.getImage=function(){return this.image_},t.prototype.handleImageError_=function(){this.state=vt.ERROR,this.unlistenImage_(),this.changed()},t.prototype.handleImageLoad_=function(){this.resolution===void 0&&(this.resolution=mt(this.extent)/this.image_.height),this.state=vt.LOADED,this.unlistenImage_(),this.changed()},t.prototype.load=function(){(this.state==vt.IDLE||this.state==vt.ERROR)&&(this.state=vt.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=rf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},t.prototype.setImage=function(e){this.image_=e,this.resolution=mt(this.extent)/this.image_.height},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t})(P0);function rf(r,t,e){var n=r,i=!0,o=!1,a=!1,s=[Qi(n,ee.LOAD,function(){a=!0,o||t()})];return n.src&&Ug?(o=!0,n.decode().then(function(){i&&t()}).catch(function(l){i&&(a?t():e())})):s.push(Qi(n,ee.ERROR,e)),function(){i=!1,s.forEach(Le)}}var M0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),D0=function(r){M0(t,r);function t(e){var n=r.call(this)||this;n.projection=Ue(e.projection),n.attributions_=nf(e.attributions),n.attributionsCollapsible_=e.attributionsCollapsible!==void 0?e.attributionsCollapsible:!0,n.loading=!1,n.state_=e.state!==void 0?e.state:Dt.READY,n.wrapX_=e.wrapX!==void 0?e.wrapX:!1,n.interpolate_=!!e.interpolate,n.viewResolver=null,n.viewRejector=null;var i=n;return n.viewPromise_=new Promise(function(o,a){i.viewResolver=o,i.viewRejector=a}),n}return t.prototype.getAttributions=function(){return this.attributions_},t.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},t.prototype.getProjection=function(){return this.projection},t.prototype.getResolutions=function(){return Re()},t.prototype.getView=function(){return this.viewPromise_},t.prototype.getState=function(){return this.state_},t.prototype.getWrapX=function(){return this.wrapX_},t.prototype.getInterpolate=function(){return this.interpolate_},t.prototype.refresh=function(){this.changed()},t.prototype.setAttributions=function(e){this.attributions_=nf(e),this.changed()},t.prototype.setState=function(e){this.state_=e,this.changed()},t}(Kt);function nf(r){return r?Array.isArray(r)?function(t){return r}:typeof r=="function"?r:function(t){return[r]}:null}var L0=D0;function k0(r){var t=r||{},e=new Tt,n=new d0(-.005,.05,100),i=t.altShiftDragRotate!==void 0?t.altShiftDragRotate:!0;i&&e.push(new qy);var o=t.doubleClickZoom!==void 0?t.doubleClickZoom:!0;o&&e.push(new Fy({delta:t.zoomDelta,duration:t.zoomDuration}));var a=t.dragPan!==void 0?t.dragPan:!0;a&&e.push(new Zy({onFocusOnly:t.onFocusOnly,kinetic:n}));var s=t.pinchRotate!==void 0?t.pinchRotate:!0;s&&e.push(new m0);var l=t.pinchZoom!==void 0?t.pinchZoom:!0;l&&e.push(new x0({duration:t.zoomDuration}));var u=t.keyboard!==void 0?t.keyboard:!0;u&&(e.push(new l0),e.push(new f0({delta:t.zoomDelta,duration:t.zoomDuration})));var c=t.mouseWheelZoom!==void 0?t.mouseWheelZoom:!0;c&&e.push(new v0({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration}));var f=t.shiftDragZoom!==void 0?t.shiftDragZoom:!0;return f&&e.push(new o0({duration:t.zoomDuration})),e}var N0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),F0=function(r){N0(t,r);function t(e){var n=this;return e=Pe({},e),e.controls||(e.controls=Iy()),e.interactions||(e.interactions=k0({onFocusOnly:!0})),n=r.call(this,e)||this,n}return t.prototype.createRenderer=function(){return new Gv(this)},t}(my),Bb=F0,_s=34962,ys=34963,U0=35040,ms=35044,G0=35048,j0=5121,B0=5123,$0=5125,of=5126,af=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function sf(r,t){for(var e=Pe({preserveDrawingBuffer:!0},t),n=af.length,i=0;i<n;++i)try{var o=r.getContext(af[i],e);if(o)return o}catch{}return null}var z0={STATIC_DRAW:ms,STREAM_DRAW:U0,DYNAMIC_DRAW:G0},K0=function(){function r(t,e){this.array=null,this.type=t,ye(t===_s||t===ys,62),this.usage=e!==void 0?e:z0.STATIC_DRAW}return r.prototype.ofSize=function(t){this.array=new(Ts(this.type))(t)},r.prototype.fromArray=function(t){var e=Ts(this.type);this.array=e.from?e.from(t):new e(t)},r.prototype.fromArrayBuffer=function(t){this.array=new(Ts(this.type))(t)},r.prototype.getType=function(){return this.type},r.prototype.getArray=function(){return this.array},r.prototype.getUsage=function(){return this.usage},r.prototype.getSize=function(){return this.array?this.array.length:0},r}();function Ts(r){switch(r){case _s:return Float32Array;case ys:return Uint32Array;default:return Float32Array}}var lf=K0,_o={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},V0=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,X0=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`,H0=function(){function r(t){this.gl_=t.webGlContext;var e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer();var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,t.vertexShader||V0),e.compileShader(n);var i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,t.fragmentShader||X0),e.compileShader(i),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,n),e.attachShader(this.renderTargetProgram_,i),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();var o=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array(o),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(function(a){this.uniforms_.push({value:t.uniforms[a],location:e.getUniformLocation(this.renderTargetProgram_,a)})}.bind(this))}return r.prototype.getGL=function(){return this.gl_},r.prototype.init=function(t){var e=this.getGL(),n=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,n[0],n[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==n[0]||this.renderTargetTextureSize_[1]!==n[1]){this.renderTargetTextureSize_=n;var i=0,o=e.RGBA,a=0,s=e.RGBA,l=e.UNSIGNED_BYTE,u=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,i,o,n[0],n[1],a,s,l,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}},r.prototype.apply=function(t,e,n,i){var o=this.getGL(),a=t.size;if(o.bindFramebuffer(o.FRAMEBUFFER,e?e.getFrameBuffer():null),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,this.renderTargetTexture_),!e){var s=Ne(o.canvas);if(!t.renderTargets[s]){var l=o.getContextAttributes();l&&l.preserveDrawingBuffer&&(o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT)),t.renderTargets[s]=!0}}o.enable(o.BLEND),o.blendFunc(o.ONE,o.ONE_MINUS_SRC_ALPHA),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.bindBuffer(o.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),o.useProgram(this.renderTargetProgram_),o.enableVertexAttribArray(this.renderTargetAttribLocation_),o.vertexAttribPointer(this.renderTargetAttribLocation_,2,o.FLOAT,!1,0,0),o.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),o.uniform1i(this.renderTargetTextureLocation_,0);var u=t.layerStatesArray[t.layerIndex].opacity;o.uniform1f(this.renderTargetOpacityLocation_,u),this.applyUniforms(t),n&&n(o,t),o.drawArrays(o.TRIANGLES,0,6),i&&i(o,t)},r.prototype.getFrameBuffer=function(){return this.frameBuffer_},r.prototype.applyUniforms=function(t){var e=this.getGL(),n,i=1;this.uniforms_.forEach(function(o){if(n=typeof o.value=="function"?o.value(t):o.value,n instanceof HTMLCanvasElement||n instanceof ImageData)o.texture||(o.texture=e.createTexture()),e.activeTexture(e["TEXTURE"+i]),e.bindTexture(e.TEXTURE_2D,o.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n instanceof ImageData?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,n.width,n.height,0,e.UNSIGNED_BYTE,new Uint8Array(n.data)):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.uniform1i(o.location,i++);else if(Array.isArray(n))switch(n.length){case 2:e.uniform2f(o.location,n[0],n[1]);return;case 3:e.uniform3f(o.location,n[0],n[1],n[2]);return;case 4:e.uniform4f(o.location,n[0],n[1],n[2],n[3]);return;default:return}else typeof n=="number"&&e.uniform1f(o.location,n)})},r}(),uf=H0;function cf(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yo(r,t){return r[0]=t[0],r[1]=t[1],r[4]=t[2],r[5]=t[3],r[12]=t[4],r[13]=t[5],r}var Z0=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Zn={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},Wn={UNSIGNED_BYTE:j0,UNSIGNED_SHORT:B0,UNSIGNED_INT:$0,FLOAT:of},mo={};function ff(r){return"shared/"+r}var hf=0;function W0(){var r="unique/"+hf;return hf+=1,r}function Y0(r){var t=mo[r];if(!t){var e=document.createElement("canvas");e.style.position="absolute",e.style.left="0",t={users:0,canvas:e},mo[r]=t}return t.users+=1,t.canvas}function q0(r){var t=mo[r];if(!!t&&(t.users-=1,!(t.users>0))){var e=t.canvas,n=sf(e),i=n.getExtension("WEBGL_lose_context");i&&i.loseContext(),delete mo[r]}}var Q0=function(r){Z0(t,r);function t(e){var n=r.call(this)||this,i=e||{};n.boundHandleWebGLContextLost_=n.handleWebGLContextLost.bind(n),n.boundHandleWebGLContextRestored_=n.handleWebGLContextRestored.bind(n),n.canvasCacheKey_=i.canvasCacheKey?ff(i.canvasCacheKey):W0(),n.canvas_=Y0(n.canvasCacheKey_),n.gl_=sf(n.canvas_),n.bufferCache_={},n.extensionCache_={},n.currentProgram_=null,n.canvas_.addEventListener(_o.LOST,n.boundHandleWebGLContextLost_),n.canvas_.addEventListener(_o.RESTORED,n.boundHandleWebGLContextRestored_),n.offsetRotateMatrix_=Mt(),n.offsetScaleMatrix_=Mt(),n.tmpMat4_=cf(),n.uniformLocations_={},n.attribLocations_={},n.uniforms_=[],i.uniforms&&n.setUniforms(i.uniforms);var o=n.getGL();return n.postProcessPasses_=i.postProcesses?i.postProcesses.map(function(a){return new uf({webGlContext:o,scaleRatio:a.scaleRatio,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,uniforms:a.uniforms})}):[new uf({webGlContext:o})],n.shaderCompileErrors_=null,n.startTime_=Date.now(),n}return t.prototype.setUniforms=function(e){this.uniforms_=[];for(var n in e)this.uniforms_.push({name:n,value:e[n]});this.uniformLocations_={}},t.prototype.canvasCacheKeyMatches=function(e){return this.canvasCacheKey_===ff(e)},t.prototype.getExtension=function(e){if(e in this.extensionCache_)return this.extensionCache_[e];var n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n},t.prototype.bindBuffer=function(e){var n=this.getGL(),i=Ne(e),o=this.bufferCache_[i];if(!o){var a=n.createBuffer();o={buffer:e,webGlBuffer:a},this.bufferCache_[i]=o}n.bindBuffer(e.getType(),o.webGlBuffer)},t.prototype.flushBufferData=function(e){var n=this.getGL();this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())},t.prototype.deleteBuffer=function(e){var n=this.getGL(),i=Ne(e),o=this.bufferCache_[i];o&&!n.isContextLost()&&n.deleteBuffer(o.webGlBuffer),delete this.bufferCache_[i]},t.prototype.disposeInternal=function(){this.canvas_.removeEventListener(_o.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(_o.RESTORED,this.boundHandleWebGLContextRestored_),q0(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},t.prototype.prepareDraw=function(e,n){var i=this.getGL(),o=this.getCanvas(),a=e.size,s=e.pixelRatio;o.width=a[0]*s,o.height=a[1]*s,o.style.width=a[0]+"px",o.style.height=a[1]+"px",i.useProgram(this.currentProgram_);for(var l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.prepareDrawToRenderTarget=function(e,n,i){var o=this.getGL(),a=n.getSize();o.bindFramebuffer(o.FRAMEBUFFER,n.getFramebuffer()),o.viewport(0,0,a[0],a[1]),o.bindTexture(o.TEXTURE_2D,n.getTexture()),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,i?o.ZERO:o.ONE_MINUS_SRC_ALPHA),o.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.drawElements=function(e,n){var i=this.getGL();this.getExtension("OES_element_index_uint");var o=i.UNSIGNED_INT,a=4,s=n-e,l=e*a;i.drawElements(i.TRIANGLES,s,o,l)},t.prototype.finalizeDraw=function(e,n,i){for(var o=0,a=this.postProcessPasses_.length;o<a;o++)o===a-1?this.postProcessPasses_[o].apply(e,null,n,i):this.postProcessPasses_[o].apply(e,this.postProcessPasses_[o+1])},t.prototype.getCanvas=function(){return this.canvas_},t.prototype.getGL=function(){return this.gl_},t.prototype.applyFrameState=function(e){var n=e.size,i=e.viewState.rotation,o=Ua(this.offsetScaleMatrix_);$g(o,2/n[0],2/n[1]);var a=Ua(this.offsetRotateMatrix_);i!==0&&Bg(a,-i),this.setUniformMatrixValue(Zn.OFFSET_SCALE_MATRIX,yo(this.tmpMat4_,o)),this.setUniformMatrixValue(Zn.OFFSET_ROTATION_MATRIX,yo(this.tmpMat4_,a)),this.setUniformFloatValue(Zn.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Zn.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Zn.RESOLUTION,e.viewState.resolution)},t.prototype.applyUniforms=function(e){var n=this.getGL(),i,o=0;this.uniforms_.forEach(function(a){if(i=typeof a.value=="function"?a.value(e):a.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData){a.texture||(a.prevValue=void 0,a.texture=n.createTexture()),n.activeTexture(n["TEXTURE"+o]),n.bindTexture(n.TEXTURE_2D,a.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);var s=!(i instanceof HTMLImageElement)||i.complete;s&&a.prevValue!==i&&(a.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),n.uniform1i(this.getUniformLocation(a.name),o++)}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(a.name,yo(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:n.uniform2f(this.getUniformLocation(a.name),i[0],i[1]);return;case 3:n.uniform3f(this.getUniformLocation(a.name),i[0],i[1],i[2]);return;case 4:n.uniform4f(this.getUniformLocation(a.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(this.getUniformLocation(a.name),i)}.bind(this))},t.prototype.useProgram=function(e){if(e==this.currentProgram_)return!1;var n=this.getGL();return n.useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},!0},t.prototype.compileShader=function(e,n){var i=this.getGL(),o=i.createShader(n);return i.shaderSource(o,e),i.compileShader(o),o},t.prototype.getProgram=function(e,n){var i=this.getGL(),o=this.compileShader(e,i.FRAGMENT_SHADER),a=this.compileShader(n,i.VERTEX_SHADER),s=i.createProgram();if(i.attachShader(s,o),i.attachShader(s,a),i.linkProgram(s),!i.getShaderParameter(o,i.COMPILE_STATUS)){var l="Fragment shader compliation failed: "+i.getShaderInfoLog(o);throw new Error(l)}if(i.deleteShader(o),!i.getShaderParameter(a,i.COMPILE_STATUS)){var l="Vertex shader compilation failed: "+i.getShaderInfoLog(a);throw new Error(l)}if(i.deleteShader(a),!i.getProgramParameter(s,i.LINK_STATUS)){var l="GL program linking failed: "+i.getShaderInfoLog(a);throw new Error(l)}return s},t.prototype.getUniformLocation=function(e){return this.uniformLocations_[e]===void 0&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]},t.prototype.getAttributeLocation=function(e){return this.attribLocations_[e]===void 0&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]},t.prototype.makeProjectionTransform=function(e,n){var i=e.size,o=e.viewState.rotation,a=e.viewState.resolution,s=e.viewState.center;return Ua(n),nr(n,0,0,2/(a*i[0]),2/(a*i[1]),-o,-s[0],-s[1]),n},t.prototype.setUniformFloatValue=function(e,n){this.getGL().uniform1f(this.getUniformLocation(e),n)},t.prototype.setUniformMatrixValue=function(e,n){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,n)},t.prototype.enableAttributeArray_=function(e,n,i,o,a){var s=this.getAttributeLocation(e);s<0||(this.getGL().enableVertexAttribArray(s),this.getGL().vertexAttribPointer(s,n,i,!1,o,a))},t.prototype.enableAttributes=function(e){for(var n=J0(e),i=0,o=0;o<e.length;o++){var a=e[o];this.enableAttributeArray_(a.name,a.size,a.type||of,n,i),i+=a.size*df(a.type)}},t.prototype.handleWebGLContextLost=function(){$n(this.bufferCache_),this.currentProgram_=null},t.prototype.handleWebGLContextRestored=function(){},t.prototype.createTexture=function(e,n,i){var o=this.getGL(),a=i||o.createTexture(),s=0,l=o.RGBA,u=0,c=o.RGBA,f=o.UNSIGNED_BYTE;return o.bindTexture(o.TEXTURE_2D,a),n?o.texImage2D(o.TEXTURE_2D,s,l,c,f,n):o.texImage2D(o.TEXTURE_2D,s,l,e[0],e[1],u,c,f,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),a},t}(Gi);function J0(r){for(var t=0,e=0;e<r.length;e++){var n=r[e];t+=n.size*df(n.type)}return t}function df(r){switch(r){case Wn.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Wn.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Wn.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Wn.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var em=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),tm=function(r){em(t,r);function t(e,n){var i=r.call(this,e)||this,o=n||{};return i.inversePixelTransform_=Mt(),i.pixelContext_=null,i.postProcesses_=o.postProcesses,i.uniforms_=o.uniforms,i.helper,e.addChangeListener(he.MAP,i.removeHelper_.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return t.prototype.dispatchPreComposeEvent=function(e,n){var i=this.getLayer();if(i.hasListener(at.PRECOMPOSE)){var o=new zn(at.PRECOMPOSE,void 0,n,e);i.dispatchEvent(o)}},t.prototype.dispatchPostComposeEvent=function(e,n){var i=this.getLayer();if(i.hasListener(at.POSTCOMPOSE)){var o=new zn(at.POSTCOMPOSE,void 0,n,e);i.dispatchEvent(o)}},t.prototype.reset=function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},t.prototype.removeHelper_=function(){this.helper&&(this.helper.dispose(),delete this.helper)},t.prototype.prepareFrame=function(e){if(this.getLayer().getSource()){for(var n=!0,i=-1,o=void 0,a=0,s=e.layerStatesArray.length;a<s;a++){var l=e.layerStatesArray[a].layer,u=l.getRenderer();if(!(u instanceof t)){n=!0;continue}var c=l.getClassName();if((n||c!==o)&&(i+=1,n=!1),o=c,u===this)break}var f="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(f))&&(this.helper&&this.helper.dispose(),this.helper=new Q0({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:f}),o&&(this.helper.getCanvas().className=o),this.afterHelperCreated())}return this.prepareFrameInternal(e)},t.prototype.afterHelperCreated=function(){},t.prototype.prepareFrameInternal=function(e){return!0},t.prototype.disposeInternal=function(){this.removeHelper_(),r.prototype.disposeInternal.call(this)},t.prototype.dispatchRenderEvent_=function(e,n,i){var o=this.getLayer();if(o.hasListener(e)){nr(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);var a=new zn(e,this.inversePixelTransform_,i,n);o.dispatchEvent(a)}},t.prototype.preRender=function(e,n){this.dispatchRenderEvent_(at.PRERENDER,e,n)},t.prototype.postRender=function(e,n){this.dispatchRenderEvent_(at.POSTRENDER,e,n)},t.prototype.getDataAtPixel=function(e,n,i){var o=qe([n.pixelRatio,0,0,n.pixelRatio,0,0],e.slice()),a=this.helper.getGL();if(!a)return null;var s=this.getLayer(),l=s.getExtent();if(l){var u=qe(n.pixelToCoordinateTransform,e.slice());if(!$i(l,u))return null}var c=a.getContextAttributes();if(!c||!c.preserveDrawingBuffer)return new Uint8Array;var f=Math.round(o[0]),h=Math.round(o[1]),d=this.pixelContext_;if(!d){var p=document.createElement("canvas");p.width=1,p.height=1,d=p.getContext("2d"),this.pixelContext_=d}d.clearRect(0,0,1,1);var g;try{d.drawImage(a.canvas,f,h,1,1,0,0,1,1),g=d.getImageData(0,0,1,1).data}catch{return g}return g[3]===0?null:g},t}(tf),rm=tm,nm=.5,Xt=!0,Es={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},im={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0},pf=function(){function r(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i}return r.prototype.contains=function(t){return this.containsXY(t[1],t[2])},r.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},r.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},r.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},r.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},r.prototype.getHeight=function(){return this.maxY-this.minY+1},r.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},r.prototype.getWidth=function(){return this.maxX-this.minX+1},r.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},r}();function cn(r,t,e,n,i){return i!==void 0?(i.minX=r,i.maxX=t,i.minY=e,i.maxY=n,i):new pf(r,t,e,n)}var xs=pf,om=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),gf=function(r){om(t,r);function t(e){var n=r.call(this,e)||this;return n.extentChanged=!0,n.renderedExtent_=null,n.renderedPixelRatio,n.renderedProjection=null,n.renderedRevision,n.renderedTiles=[],n.newTiles_=!1,n.tmpExtent=Rr(),n.tmpTileRange_=new xs(0,0,0,0),n}return t.prototype.isDrawableTile=function(e){var n=this.getLayer(),i=e.getState(),o=n.getUseInterimTilesOnError();return i==z.LOADED||i==z.EMPTY||i==z.ERROR&&!o},t.prototype.getTile=function(e,n,i,o){var a=o.pixelRatio,s=o.viewState.projection,l=this.getLayer(),u=l.getSource(),c=u.getTile(e,n,i,a,s);return c.getState()==z.ERROR&&(l.getUseInterimTilesOnError()?l.getPreload()>0&&(this.newTiles_=!0):c.setState(z.LOADED)),this.isDrawableTile(c)||(c=c.getInterimTile()),c},t.prototype.loadedTileCallback=function(e,n,i){return this.isDrawableTile(i)?r.prototype.loadedTileCallback.call(this,e,n,i):!1},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,n){var i=e.layerStatesArray[e.layerIndex],o=e.viewState,a=o.projection,s=o.resolution,l=o.center,u=o.rotation,c=e.pixelRatio,f=this.getLayer(),h=f.getSource(),d=h.getRevision(),p=h.getTileGridForProjection(a),g=p.getZForResolution(s,h.zDirection),_=p.getResolution(g),x=e.extent,T=i.extent&&Pr(i.extent);T&&(x=ir(x,Pr(i.extent)));var E=h.getTilePixelRatio(c),y=Math.round(e.size[0]*E),w=Math.round(e.size[1]*E);if(u){var O=Math.round(Math.sqrt(y*y+w*w));y=O,w=O}var S=_*y/2/E,P=_*w/2/E,L=[l[0]-S,l[1]-P,l[0]+S,l[1]+P],N=p.getTileRangeForExtentAndZ(x,g),j={};j[g]={};var W=this.createLoadedTileFinder(h,a,j),ne=this.tmpExtent,se=this.tmpTileRange_;this.newTiles_=!1;for(var V=N.minX;V<=N.maxX;++V)for(var G=N.minY;G<=N.maxY;++G){var F=this.getTile(g,V,G,e);if(this.isDrawableTile(F)){var U=Ne(this);if(F.getState()==z.LOADED){j[g][F.tileCoord.toString()]=F;var oe=F.inTransition(U);!this.newTiles_&&(oe||this.renderedTiles.indexOf(F)===-1)&&(this.newTiles_=!0)}if(F.getAlpha(U,e.time)===1)continue}var me=p.getTileCoordChildTileRange(F.tileCoord,se,ne),Ie=!1;me&&(Ie=W(g+1,me)),Ie||p.forEachTileCoordParentTileRange(F.tileCoord,W,se,ne)}var Y=_/s;nr(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/E,1/E,u,-y/2,-w/2);var xe=Kg(this.pixelTransform);this.useContainer(n,xe,i.opacity,this.getBackground(e));var J=this.context,be=J.canvas;Xu(this.inversePixelTransform,this.pixelTransform),nr(this.tempTransform,y/2,w/2,Y,Y,0,-y/2,-w/2),be.width!=y||be.height!=w?(be.width=y,be.height=w):this.containerReused||J.clearRect(0,0,y,w),T&&this.clipUnrotated(J,e,T),h.getInterpolate()||Pe(J,Es),this.preRender(J,e),this.renderedTiles.length=0;var Te=Object.keys(j).map(Number);Te.sort(ji);var Ce,Oe,de;i.opacity===1&&(!this.containerReused||h.getOpaque(e.viewState.projection))?Te=Te.reverse():(Ce=[],Oe=[]);for(var ct=Te.length-1;ct>=0;--ct){var Je=Te[ct],Ct=h.getTilePixelSize(Je,c,a),v=p.getResolution(Je),m=v/_,b=Ct[0]*m*Y,R=Ct[1]*m*Y,C=p.getTileCoordForCoordAndZ(Ar(L),Je),I=p.getTileCoordExtent(C),k=qe(this.tempTransform,[E*(I[0]-L[0])/_,E*(L[3]-I[3])/_]),M=E*h.getGutterForProjection(a),D=j[Je];for(var A in D){var F=D[A],X=F.tileCoord,$=C[1]-X[1],H=Math.round(k[0]-($-1)*b),q=C[2]-X[2],ae=Math.round(k[1]-(q-1)*R),V=Math.round(k[0]-$*b),G=Math.round(k[1]-q*R),ve=H-V,ue=ae-G,Ee=g===Je,oe=Ee&&F.getAlpha(Ne(this),e.time)!==1;if(!oe)if(Ce){J.save(),de=[V,G,V+ve,G,V+ve,G+ue,V,G+ue];for(var He=0,Yt=Ce.length;He<Yt;++He)if(g!==Je&&Je<Oe[He]){var _t=Ce[He];J.beginPath(),J.moveTo(de[0],de[1]),J.lineTo(de[2],de[3]),J.lineTo(de[4],de[5]),J.lineTo(de[6],de[7]),J.moveTo(_t[6],_t[7]),J.lineTo(_t[4],_t[5]),J.lineTo(_t[2],_t[3]),J.lineTo(_t[0],_t[1]),J.clip()}Ce.push(de),Oe.push(Je)}else J.clearRect(V,G,ve,ue);this.drawTileImage(F,e,V,G,ve,ue,M,Ee),Ce&&!oe?(J.restore(),this.renderedTiles.unshift(F)):this.renderedTiles.push(F),this.updateUsedTiles(e.usedTiles,h,F)}}this.renderedRevision=d,this.renderedResolution=_,this.extentChanged=!this.renderedExtent_||!Ba(this.renderedExtent_,L),this.renderedExtent_=L,this.renderedPixelRatio=c,this.renderedProjection=a,this.manageTilePyramid(e,h,p,c,a,x,g,f.getPreload()),this.scheduleExpireCache(e,h),this.postRender(J,e),i.extent&&J.restore(),Pe(J,im),xe!==be.style.transform&&(be.style.transform=xe);var qt=Mv(i.opacity),Sn=this.container;return qt!==Sn.style.opacity&&(Sn.style.opacity=qt),this.container},t.prototype.drawTileImage=function(e,n,i,o,a,s,l,u){var c=this.getTileImage(e);if(!!c){var f=Ne(this),h=u?e.getAlpha(f,n.time):1,d=h!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(c,l,l,c.width-2*l,c.height-2*l,i,o,a,s),d&&this.context.restore(),h!==1?n.animate=!0:u&&e.endTransition(f)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,n){if(n.canExpireCache()){var i=function(o,a,s){var l=Ne(o);l in s.usedTiles&&o.expireCache(s.viewState.projection,s.usedTiles[l])}.bind(null,n);e.postRenderFunctions.push(i)}},t.prototype.updateUsedTiles=function(e,n,i){var o=Ne(n);o in e||(e[o]={}),e[o][i.getKey()]=!0},t.prototype.manageTilePyramid=function(e,n,i,o,a,s,l,u,c){var f=Ne(n);f in e.wantedTiles||(e.wantedTiles[f]={});var h=e.wantedTiles[f],d=e.tileQueue,p=i.getMinZoom(),g=0,_,x,T,E,y,w;for(w=p;w<=l;++w)for(x=i.getTileRangeForExtentAndZ(s,w,x),T=i.getResolution(w),E=x.minX;E<=x.maxX;++E)for(y=x.minY;y<=x.maxY;++y)l-w<=u?(++g,_=n.getTile(w,E,y,o,a),_.getState()==z.IDLE&&(h[_.getKey()]=!0,d.isKeyQueued(_.getKey())||d.enqueue([_,f,i.getTileCoordCenter(_.tileCoord),T])),c!==void 0&&c(_)):n.useTile(w,E,y,a);n.updateCacheSize(g,a)},t}(S0);gf.prototype.getLayer;var am=gf,To={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},sm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),lm=function(r){sm(t,r);function t(e,n,i){var o=r.call(this)||this,a=i||{};return o.tileCoord=e,o.state=n,o.interimTile=null,o.key="",o.transition_=a.transition===void 0?250:a.transition,o.transitionStarts_={},o.interpolate=!!a.interpolate,o}return t.prototype.changed=function(){this.dispatchEvent(ee.CHANGE)},t.prototype.release=function(){},t.prototype.getKey=function(){return this.key+"/"+this.tileCoord},t.prototype.getInterimTile=function(){if(!this.interimTile)return this;var e=this.interimTile;do{if(e.getState()==z.LOADED)return this.transition_=0,e;e=e.interimTile}while(e);return this},t.prototype.refreshInterimChain=function(){if(!!this.interimTile){var e=this.interimTile,n=this;do{if(e.getState()==z.LOADED){e.interimTile=null;break}else e.getState()==z.LOADING?n=e:e.getState()==z.IDLE?n.interimTile=e.interimTile:n=e;e=n.interimTile}while(e)}},t.prototype.getTileCoord=function(){return this.tileCoord},t.prototype.getState=function(){return this.state},t.prototype.setState=function(e){if(this.state!==z.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()},t.prototype.load=function(){Re()},t.prototype.getAlpha=function(e,n){if(!this.transition_)return 1;var i=this.transitionStarts_[e];if(!i)i=n,this.transitionStarts_[e]=i;else if(i===-1)return 1;var o=n-i+1e3/60;return o>=this.transition_?1:Pc(o/this.transition_)},t.prototype.inTransition=function(e){return this.transition_?this.transitionStarts_[e]!==-1:!1},t.prototype.endTransition=function(e){this.transition_&&(this.transitionStarts_[e]=-1)},t}(nn),bs=lm,um=function(){function r(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return r.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},r.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null},r.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},r.prototype.forEach=function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer},r.prototype.get=function(t,e){var n=this.entries_[t];return ye(n!==void 0,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_},r.prototype.remove=function(t){var e=this.entries_[t];return ye(e!==void 0,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},r.prototype.getCount=function(){return this.count_},r.prototype.getKeys=function(){var t=new Array(this.count_),e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t},r.prototype.getValues=function(){var t=new Array(this.count_),e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t},r.prototype.peekLast=function(){return this.oldest_.value_},r.prototype.peekLastKey=function(){return this.oldest_.key_},r.prototype.peekFirstKey=function(){return this.newest_.key_},r.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},r.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},r.prototype.set=function(t,e){ye(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},r.prototype.setSize=function(t){this.highWaterMark=t},r}(),vf=um;function Eo(r,t,e,n){return n!==void 0?(n[0]=r,n[1]=t,n[2]=e,n):[r,t,e]}function fn(r,t,e){return r+"/"+t+"/"+e}function Yn(r){return fn(r[0],r[1],r[2])}function cm(r){return r.split("/").map(Number)}function fm(r){return(r[1]<<r[0])+r[2]}function hm(r,t){var e=r[0],n=r[1],i=r[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;var o=t.getFullTileRange(e);return o?o.containsXY(n,i):!0}var dm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),pm=function(r){dm(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.expireCache=function(e){for(;this.canExpireCache();){var n=this.peekLast();if(n.getKey()in e)break;this.pop().release()}},t.prototype.pruneExceptNewestZ=function(){if(this.getCount()!==0){var e=this.peekFirstKey(),n=cm(e),i=n[0];this.forEach(function(o){o.tileCoord[0]!==i&&(this.remove(Yn(o.tileCoord)),o.release())}.bind(this))}},t}(vf),_f=pm,hn={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},gm=[0,0,0],cr=5,vm=function(){function r(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,ye(Pg(this.resolutions_,function(a,s){return s-a},!0),17);var e;if(!t.origins){for(var n=0,i=this.resolutions_.length-1;n<i;++n)if(!e)e=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,ye(this.origins_.length==this.resolutions_.length,20));var o=t.extent;o!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Ar(o)),ye(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,ye(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Ja,ye(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=o!==void 0?o:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map(function(a,s){var l=new xs(Math.min(0,a[0]),Math.max(a[0]-1,-1),Math.min(0,a[1]),Math.max(a[1]-1,-1));if(o){var u=this.getTileRangeForExtentAndZ(o,s);l.minX=Math.max(u.minX,l.minX),l.maxX=Math.min(u.maxX,l.maxX),l.minY=Math.max(u.minY,l.minY),l.maxY=Math.min(u.maxY,l.maxY)}return l},this):o&&this.calculateTileRanges_(o)}return r.prototype.forEachTileCoord=function(t,e,n){for(var i=this.getTileRangeForExtentAndZ(t,e),o=i.minX,a=i.maxX;o<=a;++o)for(var s=i.minY,l=i.maxY;s<=l;++s)n([e,o,s])},r.prototype.forEachTileCoordParentTileRange=function(t,e,n,i){var o,a,s,l=null,u=t[0]-1;for(this.zoomFactor_===2?(a=t[1],s=t[2]):l=this.getTileCoordExtent(t,i);u>=this.minZoom;){if(this.zoomFactor_===2?(a=Math.floor(a/2),s=Math.floor(s/2),o=cn(a,a,s,s,n)):o=this.getTileRangeForExtentAndZ(l,u,n),e(u,o))return!0;--u}return!1},r.prototype.getExtent=function(){return this.extent_},r.prototype.getMaxZoom=function(){return this.maxZoom},r.prototype.getMinZoom=function(){return this.minZoom},r.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},r.prototype.getResolution=function(t){return this.resolutions_[t]},r.prototype.getResolutions=function(){return this.resolutions_},r.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){var i=t[1]*2,o=t[2]*2;return cn(i,i+1,o,o+1,e)}var a=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t[0]+1,e)}return null},r.prototype.getTileRangeForTileCoordAndZ=function(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;var i=t[0],o=t[1],a=t[2];if(e===i)return cn(o,a,o,a,n);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,e-i),l=Math.floor(o*s),u=Math.floor(a*s);if(e<i)return cn(l,l,u,u,n);var c=Math.floor(s*(o+1))-1,f=Math.floor(s*(a+1))-1;return cn(l,c,u,f,n)}var h=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(h,e,n)},r.prototype.getTileRangeExtent=function(t,e,n){var i=this.getOrigin(t),o=this.getResolution(t),a=bt(this.getTileSize(t),this.tmpSize_),s=i[0]+e.minX*a[0]*o,l=i[0]+(e.maxX+1)*a[0]*o,u=i[1]+e.minY*a[1]*o,c=i[1]+(e.maxY+1)*a[1]*o;return Sr(s,u,l,c,n)},r.prototype.getTileRangeForExtentAndZ=function(t,e,n){var i=gm;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,i);var o=i[1],a=i[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,i),cn(o,i[1],a,i[2],n)},r.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=bt(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]},r.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),o=bt(this.getTileSize(t[0]),this.tmpSize_),a=n[0]+t[1]*o[0]*i,s=n[1]-(t[2]+1)*o[1]*i,l=a+o[0]*i,u=s+o[1]*i;return Sr(a,s,l,u,e)},r.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},r.prototype.getTileCoordForXYAndResolution_=function(t,e,n,i,o){var a=this.getZForResolution(n),s=n/this.getResolution(a),l=this.getOrigin(a),u=bt(this.getTileSize(a),this.tmpSize_),c=s*(t-l[0])/n/u[0],f=s*(l[1]-e)/n/u[1];return i?(c=qi(c,cr)-1,f=qi(f,cr)-1):(c=Yi(c,cr),f=Yi(f,cr)),Eo(a,c,f,o)},r.prototype.getTileCoordForXYAndZ_=function(t,e,n,i,o){var a=this.getOrigin(n),s=this.getResolution(n),l=bt(this.getTileSize(n),this.tmpSize_),u=(t-a[0])/s/l[0],c=(a[1]-e)/s/l[1];return i?(u=qi(u,cr)-1,c=qi(c,cr)-1):(u=Yi(u,cr),c=Yi(c,cr)),Eo(n,u,c,o)},r.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},r.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},r.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},r.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null},r.prototype.getZForResolution=function(t,e){var n=ka(this.resolutions_,t,e||0);return Fe(n,this.minZoom,this.maxZoom)},r.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n},r}(),xo=vm;function yf(r){var t=r.getDefaultTileGrid();return t||(t=Tm(r),r.setDefaultTileGrid(t)),t}function _m(r,t,e){var n=t[0],i=r.getTileCoordCenter(t),o=ws(e);if($i(o,i))return t;var a=Ve(o),s=Math.ceil((o[0]-i[0])/a);return i[0]+=a*s,r.getTileCoordForCoordAndZ(i,n)}function ym(r,t,e,n){var i=n!==void 0?n:jn.TOP_LEFT,o=mf(r,t,e);return new xo({extent:r,origin:qg(r,i),resolutions:o,tileSize:e})}function mm(r){var t=r||{},e=t.extent||Ue("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:mf(e,t.maxZoom,t.tileSize,t.maxResolution)};return new xo(n)}function mf(r,t,e,n){for(var i=t!==void 0?t:r_,o=mt(r),a=Ve(r),s=bt(e!==void 0?e:Ja),l=n>0?n:Math.max(a/s[0],o/s[1]),u=i+1,c=new Array(u),f=0;f<u;++f)c[f]=l/Math.pow(2,f);return c}function Tm(r,t,e,n){var i=ws(r);return ym(i,t,e,n)}function ws(r){r=Ue(r);var t=r.getExtent();if(!t){var e=180*Lt[lr.DEGREES]/r.getMetersPerUnit();t=Sr(-e,-e,e,e)}return t}var Tf=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Em=function(r){Tf(t,r);function t(e){var n=r.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate})||this;n.on,n.once,n.un,n.opaque_=e.opaque!==void 0?e.opaque:!1,n.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,n.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;var i=[256,256],o=e.tileGrid;return o&&bt(o.getTileSize(o.getMinZoom()),i),n.tileCache=new _f(e.cacheSize||0),n.tmpSize=[0,0],n.key_=e.key||"",n.tileOptions={transition:e.transition,interpolate:e.interpolate},n.zDirection=e.zDirection?e.zDirection:0,n}return t.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},t.prototype.expireCache=function(e,n){var i=this.getTileCacheForProjection(e);i&&i.expireCache(n)},t.prototype.forEachLoadedTile=function(e,n,i,o){var a=this.getTileCacheForProjection(e);if(!a)return!1;for(var s=!0,l,u,c,f=i.minX;f<=i.maxX;++f)for(var h=i.minY;h<=i.maxY;++h)u=fn(n,f,h),c=!1,a.containsKey(u)&&(l=a.get(u),c=l.getState()===z.LOADED,c&&(c=o(l)!==!1)),c||(s=!1);return s},t.prototype.getGutterForProjection=function(e){return 0},t.prototype.getKey=function(){return this.key_},t.prototype.setKey=function(e){this.key_!==e&&(this.key_=e,this.changed())},t.prototype.getOpaque=function(e){return this.opaque_},t.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},t.prototype.getTile=function(e,n,i,o,a){return Re()},t.prototype.getTileGrid=function(){return this.tileGrid},t.prototype.getTileGridForProjection=function(e){return this.tileGrid?this.tileGrid:yf(e)},t.prototype.getTileCacheForProjection=function(e){return ye(ur(this.getProjection(),e),68),this.tileCache},t.prototype.getTilePixelRatio=function(e){return this.tilePixelRatio_},t.prototype.getTilePixelSize=function(e,n,i){var o=this.getTileGridForProjection(i),a=this.getTilePixelRatio(n),s=bt(o.getTileSize(e),this.tmpSize);return a==1?s:gy(s,a,this.tmpSize)},t.prototype.getTileCoordForTileUrlFunction=function(e,n){var i=n!==void 0?n:this.getProjection(),o=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=_m(o,e,i)),hm(e,o)?e:null},t.prototype.clear=function(){this.tileCache.clear()},t.prototype.refresh=function(){this.clear(),r.prototype.refresh.call(this)},t.prototype.updateCacheSize=function(e,n){var i=this.getTileCacheForProjection(n);e>i.highWaterMark&&(i.highWaterMark=e)},t.prototype.useTile=function(e,n,i,o){},t}(L0),Ef=function(r){Tf(t,r);function t(e,n){var i=r.call(this,e)||this;return i.tile=n,i}return t}(or),xf=Em;function xm(r,t){var e=/\{z\}/g,n=/\{x\}/g,i=/\{y\}/g,o=/\{-y\}/g;return function(a,s,l){if(a)return r.replace(e,a[0].toString()).replace(n,a[1].toString()).replace(i,a[2].toString()).replace(o,function(){var u=a[0],c=t.getFullTileRange(u);ye(c,55);var f=c.getHeight()-a[2]-1;return f.toString()})}}function bm(r,t){for(var e=r.length,n=new Array(e),i=0;i<e;++i)n[i]=xm(r[i],t);return Cs(n)}function Cs(r){return r.length===1?r[0]:function(t,e,n){if(t){var i=fm(t),o=rn(i,r.length);return r[o](t,e,n)}else return}}function bf(r){var t=[],e=/\{([a-z])-([a-z])\}/.exec(r);if(e){var n=e[1].charCodeAt(0),i=e[2].charCodeAt(0),o=void 0;for(o=n;o<=i;++o)t.push(r.replace(e[0],String.fromCharCode(o)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(r),e){for(var a=parseInt(e[2],10),s=parseInt(e[1],10);s<=a;s++)t.push(r.replace(e[0],s.toString()));return t}return t.push(r),t}var wm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Cm=function(r){wm(t,r);function t(e){var n=r.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this;return n.generateTileUrlFunction_=n.tileUrlFunction===t.prototype.tileUrlFunction,n.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(n.tileUrlFunction=e.tileUrlFunction),n.urls=null,e.urls?n.setUrls(e.urls):e.url&&n.setUrl(e.url),n.tileLoadingKeys_={},n}return t.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},t.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},t.prototype.getUrls=function(){return this.urls},t.prototype.handleTileChange=function(e){var n=e.target,i=Ne(n),o=n.getState(),a;o==z.LOADING?(this.tileLoadingKeys_[i]=!0,a=hn.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],a=o==z.ERROR?hn.TILELOADERROR:o==z.LOADED?hn.TILELOADEND:void 0),a!=null&&this.dispatchEvent(new Ef(a,n))},t.prototype.setTileLoadFunction=function(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()},t.prototype.setTileUrlFunction=function(e,n){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),typeof n!="undefined"?this.setKey(n):this.changed()},t.prototype.setUrl=function(e){var n=bf(e);this.urls=n,this.setUrls(n)},t.prototype.setUrls=function(e){this.urls=e;var n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(bm(e,this.tileGrid),n):this.setKey(n)},t.prototype.tileUrlFunction=function(e,n,i){},t.prototype.useTile=function(e,n,i){var o=fn(e,n,i);this.tileCache.containsKey(o)&&this.tileCache.get(o)},t}(xf),Rm=Cm,Sm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Am=function(r){Sm(t,r);function t(e,n,i,o,a,s){var l=r.call(this,e,n,s)||this;return l.crossOrigin_=o,l.src_=i,l.key=i,l.image_=new Image,o!==null&&(l.image_.crossOrigin=o),l.unlisten_=null,l.tileLoadFunction_=a,l}return t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(e){this.image_=e,this.state=z.LOADED,this.unlistenImage_(),this.changed()},t.prototype.handleImageError_=function(){this.state=z.ERROR,this.unlistenImage_(),this.image_=Om(),this.changed()},t.prototype.handleImageLoad_=function(){var e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=z.LOADED:this.state=z.EMPTY,this.unlistenImage_(),this.changed()},t.prototype.load=function(){this.state==z.ERROR&&(this.state=z.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==z.IDLE&&(this.state=z.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=rf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},t.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},t}(bs);function Om(){var r=no(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}var Rs=Am,Pm=10,wf=.25,Im=function(){function r(t,e,n,i,o,a){this.sourceProj_=t,this.targetProj_=e;var s={},l=Vn(this.targetProj_,this.sourceProj_);this.transformInv_=function(E){var y=E[0]+"/"+E[1];return s[y]||(s[y]=l(E)),s[y]},this.maxSourceExtent_=i,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Ve(i)==Ve(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Ve(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Ve(this.targetProj_.getExtent()):null;var u=Ar(n),c=Hi(n),f=Xi(n),h=Vi(n),d=this.transformInv_(u),p=this.transformInv_(c),g=this.transformInv_(f),_=this.transformInv_(h),x=Pm+(a?Math.max(0,Math.ceil(ec($a(n)/(a*a*256*256)))):0);if(this.addQuad_(u,c,f,h,d,p,g,_,x),this.wrapsXInSource_){var T=1/0;this.triangles_.forEach(function(E,y,w){T=Math.min(T,E.source[0][0],E.source[1][0],E.source[2][0])}),this.triangles_.forEach(function(E){if(Math.max(E.source[0][0],E.source[1][0],E.source[2][0])-T>this.sourceWorldWidth_/2){var y=[[E.source[0][0],E.source[0][1]],[E.source[1][0],E.source[1][1]],[E.source[2][0],E.source[2][1]]];y[0][0]-T>this.sourceWorldWidth_/2&&(y[0][0]-=this.sourceWorldWidth_),y[1][0]-T>this.sourceWorldWidth_/2&&(y[1][0]-=this.sourceWorldWidth_),y[2][0]-T>this.sourceWorldWidth_/2&&(y[2][0]-=this.sourceWorldWidth_);var w=Math.min(y[0][0],y[1][0],y[2][0]),O=Math.max(y[0][0],y[1][0],y[2][0]);O-w<this.sourceWorldWidth_/2&&(E.source=y)}}.bind(this))}s={}}return r.prototype.addTriangle_=function(t,e,n,i,o,a){this.triangles_.push({source:[i,o,a],target:[t,e,n]})},r.prototype.addQuad_=function(t,e,n,i,o,a,s,l,u){var c=ja([o,a,s,l]),f=this.sourceWorldWidth_?Ve(c)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&f>.5&&f<1,p=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var g=ja([t,e,n,i]),_=Ve(g)/this.targetWorldWidth_;p=_>wf||p}!d&&this.sourceProj_.isGlobal()&&f&&(p=f>wf||p)}if(!(!p&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!Ka(c,this.maxSourceExtent_))){var x=0;if(!p&&(!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(s[0])||!isFinite(s[1])||!isFinite(l[0])||!isFinite(l[1]))){if(u>0)p=!0;else if(x=(!isFinite(o[0])||!isFinite(o[1])?8:0)+(!isFinite(a[0])||!isFinite(a[1])?4:0)+(!isFinite(s[0])||!isFinite(s[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),x!=1&&x!=2&&x!=4&&x!=8)return}if(u>0){if(!p){var T=[(t[0]+n[0])/2,(t[1]+n[1])/2],E=this.transformInv_(T),y=void 0;if(d){var w=(rn(o[0],h)+rn(s[0],h))/2;y=w-rn(E[0],h)}else y=(o[0]+s[0])/2-E[0];var O=(o[1]+s[1])/2-E[1],S=y*y+O*O;p=S>this.errorThresholdSquared_}if(p){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var P=[(e[0]+n[0])/2,(e[1]+n[1])/2],L=this.transformInv_(P),N=[(i[0]+t[0])/2,(i[1]+t[1])/2],j=this.transformInv_(N);this.addQuad_(t,e,P,N,o,a,L,j,u-1),this.addQuad_(N,P,n,i,j,L,s,l,u-1)}else{var W=[(t[0]+e[0])/2,(t[1]+e[1])/2],ne=this.transformInv_(W),se=[(n[0]+i[0])/2,(n[1]+i[1])/2],V=this.transformInv_(se);this.addQuad_(t,W,se,i,o,ne,V,l,u-1),this.addQuad_(W,e,n,se,ne,a,s,V,u-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(x&11)==0&&this.addTriangle_(t,n,i,o,s,l),(x&14)==0&&this.addTriangle_(t,n,e,o,s,a),x&&((x&13)==0&&this.addTriangle_(e,i,t,a,l,o),(x&7)==0&&this.addTriangle_(e,i,n,a,l,s))}},r.prototype.calculateSourceExtent=function(){var t=Rr();return this.triangles_.forEach(function(e,n,i){var o=e.source;Ki(t,o[0]),Ki(t,o[1]),Ki(t,o[2])}),t},r.prototype.getTriangles=function(){return this.triangles_},r}(),Mm=Im,Ss;function Cf(r,t,e,n,i){r.beginPath(),r.moveTo(0,0),r.lineTo(t,e),r.lineTo(n,i),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(t,n)+1,Math.max(e,i)),r.restore()}function As(r,t){return Math.abs(r[t*4]-210)>2||Math.abs(r[t*4+3]-.75*255)>2}function Dm(){if(Ss===void 0){var r=document.createElement("canvas").getContext("2d");r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",Cf(r,4,5,4,0),Cf(r,4,5,0,5);var t=r.getImageData(0,0,3,3).data;Ss=As(t,0)||As(t,4)||As(t,8)}return Ss}function Rf(r,t,e,n){var i=m_(e,t,r),o=wc(t,n,e),a=t.getMetersPerUnit();a!==void 0&&(o*=a);var s=r.getMetersPerUnit();s!==void 0&&(o/=s);var l=r.getExtent();if(!l||$i(l,i)){var u=wc(r,o,i)/o;isFinite(u)&&u>0&&(o/=u)}return o}function Lm(r,t,e,n){var i=en(e),o=Rf(r,t,i,n);return(!isFinite(o)||o<=0)&&Ju(e,function(a){return o=Rf(r,t,a,n),isFinite(o)&&o>0}),o}function km(r,t,e,n,i,o,a,s,l,u,c,f){var h=no(Math.round(e*r),Math.round(e*t));if(f||Pe(h,Es),l.length===0)return h.canvas;h.scale(e,e);function d(y){return Math.round(y*e)/e}h.globalCompositeOperation="lighter";var p=Rr();l.forEach(function(y,w,O){Wg(p,y.extent)});var g=Ve(p),_=mt(p),x=no(Math.round(e*g/n),Math.round(e*_/n));f||Pe(x,Es);var T=e/n;l.forEach(function(y,w,O){var S=y.extent[0]-p[0],P=-(y.extent[3]-p[3]),L=Ve(y.extent),N=mt(y.extent);y.image.width>0&&y.image.height>0&&x.drawImage(y.image,u,u,y.image.width-2*u,y.image.height-2*u,S*T,P*T,L*T,N*T)});var E=Ar(a);return s.getTriangles().forEach(function(y,w,O){var S=y.source,P=y.target,L=S[0][0],N=S[0][1],j=S[1][0],W=S[1][1],ne=S[2][0],se=S[2][1],V=d((P[0][0]-E[0])/o),G=d(-(P[0][1]-E[1])/o),F=d((P[1][0]-E[0])/o),U=d(-(P[1][1]-E[1])/o),oe=d((P[2][0]-E[0])/o),me=d(-(P[2][1]-E[1])/o),Ie=L,Y=N;L=0,N=0,j-=Ie,W-=Y,ne-=Ie,se-=Y;var xe=[[j,W,0,0,F-V],[ne,se,0,0,oe-V],[0,0,j,W,U-G],[0,0,ne,se,me-G]],J=nv(xe);if(!!J){if(h.save(),h.beginPath(),Dm()||!f){h.moveTo(F,U);for(var be=4,Te=V-F,Ce=G-U,Oe=0;Oe<be;Oe++)h.lineTo(F+d((Oe+1)*Te/be),U+d(Oe*Ce/(be-1))),Oe!=be-1&&h.lineTo(F+d((Oe+1)*Te/be),U+d((Oe+1)*Ce/(be-1)));h.lineTo(oe,me)}else h.moveTo(F,U),h.lineTo(V,G),h.lineTo(oe,me);h.clip(),h.transform(J[0],J[2],J[1],J[3],V,G),h.translate(p[0]-Ie,p[3]-Y),h.scale(n/e,-n/e),h.drawImage(x.canvas,0,0),h.restore()}}),c&&(h.save(),h.globalCompositeOperation="source-over",h.strokeStyle="black",h.lineWidth=1,s.getTriangles().forEach(function(y,w,O){var S=y.target,P=(S[0][0]-E[0])/o,L=-(S[0][1]-E[1])/o,N=(S[1][0]-E[0])/o,j=-(S[1][1]-E[1])/o,W=(S[2][0]-E[0])/o,ne=-(S[2][1]-E[1])/o;h.beginPath(),h.moveTo(N,j),h.lineTo(P,L),h.lineTo(W,ne),h.closePath(),h.stroke()}),h.restore()),h.canvas}var Nm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Fm=function(r){Nm(t,r);function t(e,n,i,o,a,s,l,u,c,f,h,d){var p=r.call(this,a,z.IDLE,{interpolate:!!d})||this;p.renderEdges_=h!==void 0?h:!1,p.pixelRatio_=l,p.gutter_=u,p.canvas_=null,p.sourceTileGrid_=n,p.targetTileGrid_=o,p.wrappedTileCoord_=s||a,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0;var g=o.getTileCoordExtent(p.wrappedTileCoord_),_=p.targetTileGrid_.getExtent(),x=p.sourceTileGrid_.getExtent(),T=_?ir(g,_):g;if($a(T)===0)return p.state=z.EMPTY,p;var E=e.getExtent();E&&(x?x=ir(x,E):x=E);var y=o.getResolution(p.wrappedTileCoord_[0]),w=Lm(e,i,T,y);if(!isFinite(w)||w<=0)return p.state=z.EMPTY,p;var O=f!==void 0?f:nm;if(p.triangulation_=new Mm(e,i,T,x,w*O,y),p.triangulation_.getTriangles().length===0)return p.state=z.EMPTY,p;p.sourceZ_=n.getZForResolution(w);var S=p.triangulation_.calculateSourceExtent();if(x&&(e.canWrapX()?(S[1]=Fe(S[1],x[1],x[3]),S[3]=Fe(S[3],x[1],x[3])):S=ir(S,x)),!$a(S))p.state=z.EMPTY;else{for(var P=n.getTileRangeForExtentAndZ(S,p.sourceZ_),L=P.minX;L<=P.maxX;L++)for(var N=P.minY;N<=P.maxY;N++){var j=c(p.sourceZ_,L,N,l);j&&p.sourceTiles_.push(j)}p.sourceTiles_.length===0&&(p.state=z.EMPTY)}return p}return t.prototype.getImage=function(){return this.canvas_},t.prototype.reproject_=function(){var e=[];if(this.sourceTiles_.forEach(function(c,f,h){c&&c.getState()==z.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(c.tileCoord),image:c.getImage()})}.bind(this)),this.sourceTiles_.length=0,e.length===0)this.state=z.ERROR;else{var n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),o=typeof i=="number"?i:i[0],a=typeof i=="number"?i:i[1],s=this.targetTileGrid_.getResolution(n),l=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=km(o,a,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),s,u,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=z.LOADED}this.changed()},t.prototype.load=function(){if(this.state==z.IDLE){this.state=z.LOADING,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(n,i,o){var a=n.getState();if(a==z.IDLE||a==z.LOADING){e++;var s=pe(n,ee.CHANGE,function(l){var u=n.getState();(u==z.LOADED||u==z.ERROR||u==z.EMPTY)&&(Le(s),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}.bind(this)),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(n,i,o){var a=n.getState();a==z.IDLE&&n.load()})}},t.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Le),this.sourcesListenerKeys_=null},t}(bs),Sf=Fm,Um=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Gm=function(r){Um(t,r);function t(e){var n=this,i=e.imageSmoothing!==void 0?e.imageSmoothing:!0;return e.interpolate!==void 0&&(i=e.interpolate),n=r.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:jm,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:i,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection})||this,n.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,n.tileClass=e.tileClass!==void 0?e.tileClass:Rs,n.tileCacheForProjection={},n.tileGridForProjection={},n.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,n.renderReprojectionEdges_=!1,n}return t.prototype.canExpireCache=function(){if(!Xt)return r.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1},t.prototype.expireCache=function(e,n){if(!Xt){r.prototype.expireCache.call(this,e,n);return}var i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?n:{});for(var o in this.tileCacheForProjection){var a=this.tileCacheForProjection[o];a.expireCache(a==i?n:{})}},t.prototype.getGutterForProjection=function(e){return Xt&&this.getProjection()&&e&&!ur(this.getProjection(),e)?0:this.getGutter()},t.prototype.getGutter=function(){return 0},t.prototype.getKey=function(){var e=r.prototype.getKey.call(this);return this.getInterpolate()||(e+=":disable-interpolation"),e},t.prototype.getOpaque=function(e){return Xt&&this.getProjection()&&e&&!ur(this.getProjection(),e)?!1:r.prototype.getOpaque.call(this,e)},t.prototype.getTileGridForProjection=function(e){if(!Xt)return r.prototype.getTileGridForProjection.call(this,e);var n=this.getProjection();if(this.tileGrid&&(!n||ur(n,e)))return this.tileGrid;var i=Ne(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=yf(e)),this.tileGridForProjection[i]},t.prototype.getTileCacheForProjection=function(e){if(!Xt)return r.prototype.getTileCacheForProjection.call(this,e);var n=this.getProjection();if(!n||ur(n,e))return this.tileCache;var i=Ne(e);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new _f(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},t.prototype.createTile_=function(e,n,i,o,a,s){var l=[e,n,i],u=this.getTileCoordForTileUrlFunction(l,a),c=u?this.tileUrlFunction(u,o,a):void 0,f=new this.tileClass(l,c!==void 0?z.IDLE:z.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=s,f.addEventListener(ee.CHANGE,this.handleTileChange.bind(this)),f},t.prototype.getTile=function(e,n,i,o,a){var s=this.getProjection();if(!Xt||!s||!a||ur(s,a))return this.getTileInternal(e,n,i,o,s||a);var l=this.getTileCacheForProjection(a),u=[e,n,i],c=void 0,f=Yn(u);l.containsKey(f)&&(c=l.get(f));var h=this.getKey();if(c&&c.key==h)return c;var d=this.getTileGridForProjection(s),p=this.getTileGridForProjection(a),g=this.getTileCoordForTileUrlFunction(u,a),_=new Sf(s,d,a,p,u,g,this.getTilePixelRatio(o),this.getGutter(),function(x,T,E,y){return this.getTileInternal(x,T,E,y,s)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return _.key=h,c?(_.interimTile=c,_.refreshInterimChain(),l.replace(f,_)):l.set(f,_),_},t.prototype.getTileInternal=function(e,n,i,o,a){var s=null,l=fn(e,n,i),u=this.getKey();if(!this.tileCache.containsKey(l))s=this.createTile_(e,n,i,o,a,u),this.tileCache.set(l,s);else if(s=this.tileCache.get(l),s.key!=u){var c=s;s=this.createTile_(e,n,i,o,a,u),c.getState()==z.IDLE?s.interimTile=c.interimTile:s.interimTile=c,s.refreshInterimChain(),this.tileCache.replace(l,s)}return s},t.prototype.setRenderReprojectionEdges=function(e){if(!(!Xt||this.renderReprojectionEdges_==e)){this.renderReprojectionEdges_=e;for(var n in this.tileCacheForProjection)this.tileCacheForProjection[n].clear();this.changed()}},t.prototype.setTileGridForProjection=function(e,n){if(Xt){var i=Ue(e);if(i){var o=Ne(i);o in this.tileGridForProjection||(this.tileGridForProjection[o]=n)}}},t}(Rm);function jm(r,t){r.getImage().src=t}var Bm=Gm,$m=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),zm=function(r){$m(t,r);function t(e){var n=this,i=e||{},o=Pe({},i);return delete o.preload,delete o.useInterimTilesOnError,n=r.call(this,o)||this,n.on,n.once,n.un,n.setPreload(i.preload!==void 0?i.preload:0),n.setUseInterimTilesOnError(i.useInterimTilesOnError!==void 0?i.useInterimTilesOnError:!0),n}return t.prototype.getPreload=function(){return this.get(To.PRELOAD)},t.prototype.setPreload=function(e){this.set(To.PRELOAD,e)},t.prototype.getUseInterimTilesOnError=function(){return this.get(To.USE_INTERIM_TILES_ON_ERROR)},t.prototype.setUseInterimTilesOnError=function(e){this.set(To.USE_INTERIM_TILES_ON_ERROR,e)},t}(Xa),Af=zm,Km=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Vm=function(r){Km(t,r);function t(e){return r.call(this,e)||this}return t.prototype.createRenderer=function(){return new am(this)},t}(Af),$b=Vm,Xm=function(){function r(t,e){this.name=t,this.data=e,this.texture_=null}return r.prototype.getTexture=function(t){if(!this.texture_){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.data.length/4,1,0,t.RGBA,t.UNSIGNED_BYTE,this.data),this.texture_=e}return this.texture_},r}(),Hm=Xm,Zm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function Of(r,t,e){var n=e?r.LINEAR:r.NEAREST;r.bindTexture(r.TEXTURE_2D,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n)}function Wm(r,t,e,n){Of(r,t,n),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)}function Pf(r,t,e,n,i,o){var a=r.getGL();Of(a,t,o);var s=e.byteLength/n[1],l=1;s%8==0?l=8:s%4==0?l=4:s%2==0&&(l=2);var u;switch(i){case 1:{u=a.LUMINANCE;break}case 2:{u=a.LUMINANCE_ALPHA;break}case 3:{u=a.RGB;break}case 4:{u=a.RGBA;break}default:throw new Error("Unsupported number of bands: "+i)}var c;e instanceof Float32Array?(c=a.FLOAT,r.getExtension("OES_texture_float"),r.getExtension("OES_texture_float_linear")):c=a.UNSIGNED_BYTE;var f=a.getParameter(a.UNPACK_ALIGNMENT);a.pixelStorei(a.UNPACK_ALIGNMENT,l),a.texImage2D(a.TEXTURE_2D,0,u,n[0],n[1],0,u,c,e),a.pixelStorei(a.UNPACK_ALIGNMENT,f)}var Ym=function(r){Zm(t,r);function t(e,n,i){var o=r.call(this)||this;o.tile,o.textures=[],o.handleTileChange_=o.handleTileChange_.bind(o),o.size=bt(n.getTileSize(e.tileCoord[0])),o.bandCount=NaN,o.helper_=i;var a=new lf(_s,ms);return a.fromArray([0,1,1,1,1,0,0,0]),i.flushBufferData(a),o.coords=a,o.setTile(e),o}return t.prototype.setTile=function(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(ee.CHANGE,this.handleTileChange_),this.tile=e,this.textures.length=0,this.loaded=e.getState()===z.LOADED,this.loaded)this.uploadTile_();else{if(e instanceof Rs){var n=e.getImage();n instanceof Image&&!n.crossOrigin&&(n.crossOrigin="anonymous")}e.addEventListener(ee.CHANGE,this.handleTileChange_)}},t.prototype.uploadTile_=function(){var e=this.helper_,n=e.getGL(),i=this.tile;if(i instanceof Rs||i instanceof Sf){var o=n.createTexture();this.textures.push(o),this.bandCount=4,Wm(n,o,i.getImage(),i.interpolate);return}var a=i.getData(),s=a instanceof Float32Array,l=this.size[0]*this.size[1],u=s?Float32Array:Uint8Array,c=u.BYTES_PER_ELEMENT,f=a.byteLength/this.size[1];this.bandCount=Math.floor(f/c/this.size[0]);var h=Math.ceil(this.bandCount/4);if(h===1){var o=n.createTexture();this.textures.push(o),Pf(e,o,a,this.size,this.bandCount,i.interpolate);return}for(var d=new Array(h),p=0;p<h;++p){var o=n.createTexture();this.textures.push(o);var g=p<h-1?4:this.bandCount%4;d[p]=new u(l*g)}for(var _=0,x=0,T=this.size[0]*this.bandCount,E=0;E<this.size[1];++E){for(var y=0;y<T;++y){var w=a[x+y],O=Math.floor(_/this.bandCount),S=y%this.bandCount,p=Math.floor(S/4),P=d[p],g=P.length/l,L=S%4;P[O*g+L]=w,++_}x+=f/c}for(var p=0;p<h;++p){var o=this.textures[p],P=d[p],g=P.length/l;Pf(e,o,P,this.size,g,i.interpolate)}},t.prototype.handleTileChange_=function(){this.tile.getState()===z.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(ee.CHANGE))},t.prototype.disposeInternal=function(){var e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var n=0;n<this.textures.length;++n)e.deleteTexture(this.textures[n]);this.tile.removeEventListener(ee.CHANGE,this.handleTileChange_)},t}(nn),qm=Ym,Qm=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Me={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},bo={TEXTURE_COORD:"a_textureCoord"},Jm=[{name:bo.TEXTURE_COORD,size:2,type:Wn.FLOAT}],e1={};function t1(r){return 2*(1-1/(r+1))-1}function If(r,t,e){e in r||(r[e]=[]),r[e].push(t)}function Os(r,t){var e=r.layerStatesArray[r.layerIndex];e.extent&&(t=ir(t,Pr(e.extent,r.viewState.projection)));var n=e.layer.getSource();if(!n.getWrapX()){var i=n.getTileGridForProjection(r.viewState.projection).getExtent();i&&(t=ir(t,i))}return t}var Mf=function(r){Qm(t,r);function t(e,n){var i=r.call(this,e,{uniforms:n.uniforms})||this;i.tileTransform_=Mt(),i.tempMat4_=cf(),i.tempTileRange_=new xs(0,0,0,0),i.tempTileCoord_=Eo(0,0,0),i.tempSize_=[0,0],i.program_,i.vertexShader_=n.vertexShader,i.fragmentShader_=n.fragmentShader,i.indices_=new lf(ys,ms),i.indices_.fromArray([0,1,3,1,2,3]);var o=n.cacheSize!==void 0?n.cacheSize:512;return i.tileTextureCache_=new vf(o),i.paletteTextures_=n.paletteTextures||[],i}return t.prototype.reset=function(e){r.prototype.reset.call(this,{uniforms:e.uniforms}),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))},t.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)},t.prototype.isDrawableTile_=function(e){var n=this.getLayer(),i=e.getState(),o=n.getUseInterimTilesOnError();return i==z.LOADED||i==z.EMPTY||i==z.ERROR&&!o},t.prototype.prepareFrameInternal=function(e){var n=this.getLayer(),i=n.getSource();return!i||Zi(Os(e,e.extent))?!1:i.getState()===Dt.READY},t.prototype.enqueueTiles=function(e,n,i,o){var a=e.viewState,s=this.getLayer(),l=s.getSource(),u=l.getTileGridForProjection(a.projection),c=this.tileTextureCache_,f=u.getTileRangeForExtentAndZ(n,i,this.tempTileRange_),h=Ne(l);h in e.wantedTiles||(e.wantedTiles[h]={});for(var d=e.wantedTiles[h],p=u.getResolution(i),g=f.minX;g<=f.maxX;++g)for(var _=f.minY;_<=f.maxY;++_){var x=Eo(i,g,_,this.tempTileCoord_),T=Yn(x),E=void 0,y=void 0;if(c.containsKey(T)&&(E=c.get(T),y=E.tile),!E||E.tile.key!==l.getKey())if(y=l.getTile(i,g,_,e.pixelRatio,a.projection),!E)E=new qm(y,u,this.helper),c.set(T,E);else if(this.isDrawableTile_(y))E.setTile(y);else{var w=y.getInterimTile();E.setTile(w)}If(o,E,i);var O=y.getKey();d[O]=!0,y.getState()===z.IDLE&&(e.tileQueue.isKeyQueued(O)||e.tileQueue.enqueue([y,h,u.getTileCoordCenter(x),p]))}},t.prototype.renderFrame=function(e){var n=this.helper.getGL();this.preRender(n,e);var i=e.viewState,o=this.getLayer(),a=o.getSource(),s=a.getTileGridForProjection(i.projection),l=Os(e,e.extent),u=s.getZForResolution(i.resolution,a.zDirection),c={};if(e.nextExtent){var f=s.getZForResolution(i.nextResolution,a.zDirection),h=Os(e,e.nextExtent);this.enqueueTiles(e,h,f,c)}this.enqueueTiles(e,l,u,c);for(var d={},p=Ne(this),g=e.time,_=!1,x=c[u],T=0,E=x.length;T<E;++T){var y=x[T],w=y.tile,O=w.tileCoord;if(y.loaded){var S=w.getAlpha(p,g);if(S===1){w.endTransition(p);continue}_=!0;var P=Yn(O);d[P]=S}var L=this.findAltTiles_(s,O,u+1,c);if(!L)for(var N=s.getMinZoom(),j=u-1;j>=N;--j){var W=this.findAltTiles_(s,O,j,c);if(W)break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(e,!_);for(var ne=Object.keys(c).map(Number).sort(ji),se=i.center[0],V=i.center[1],G=0,F=ne.length;G<F;++G)for(var U=ne[G],oe=s.getResolution(U),me=bt(s.getTileSize(U),this.tempSize_),Ie=s.getOrigin(U),Y=(se-Ie[0])/(me[0]*oe),xe=(Ie[1]-V)/(me[1]*oe),J=i.resolution/oe,be=t1(U),Te=c[U],T=0,E=Te.length;T<E;++T){var y=Te[T];if(!!y.loaded){var w=y.tile,O=w.tileCoord,P=Yn(O),Ce=O[1],Oe=O[2];nr(this.tileTransform_,0,0,2/(e.size[0]*J/me[0]),-2/(e.size[1]*J/me[1]),i.rotation,-(Y-Ce),-(xe-Oe)),this.helper.setUniformMatrixValue(Me.TILE_TRANSFORM,yo(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(y.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(Jm);for(var de=0;de<y.textures.length;){var ct="TEXTURE"+de,Je=Me.TILE_TEXTURE_ARRAY+"["+de+"]";n.activeTexture(n[ct]),n.bindTexture(n.TEXTURE_2D,y.textures[de]),n.uniform1i(this.helper.getUniformLocation(Je),de),++de}for(var Ct=0;Ct<this.paletteTextures_.length;++Ct){var v=this.paletteTextures_[Ct];n.activeTexture(n["TEXTURE"+de]);var m=v.getTexture(n);n.bindTexture(n.TEXTURE_2D,m),n.uniform1i(this.helper.getUniformLocation(v.name),de),++de}var S=P in d?d[P]:1;S<1&&(e.animate=!0),this.helper.setUniformFloatValue(Me.TRANSITION_ALPHA,S),this.helper.setUniformFloatValue(Me.DEPTH,be),this.helper.setUniformFloatValue(Me.TEXTURE_PIXEL_WIDTH,me[0]),this.helper.setUniformFloatValue(Me.TEXTURE_PIXEL_HEIGHT,me[1]),this.helper.setUniformFloatValue(Me.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(Me.ZOOM,i.zoom),this.helper.drawElements(0,this.indices_.getSize())}}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var b=this.helper.getCanvas(),R=this.tileTextureCache_;R.canExpireCache();){var y=R.pop();y.dispose()}var C=function(I,k){a.expireCache(k.viewState.projection,e1)};return e.postRenderFunctions.push(C),this.postRender(n,e),b},t.prototype.findAltTiles_=function(e,n,i,o){var a=e.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!a)return!1;for(var s=!0,l=this.tileTextureCache_,u=a.minX;u<=a.maxX;++u)for(var c=a.minY;c<=a.maxY;++c){var f=fn(i,u,c),h=!1;if(l.containsKey(f)){var d=l.get(f);d.loaded&&(If(o,d,i),h=!0)}h||(s=!1)}return s},t.prototype.disposeInternal=function(){var e=this.helper,n=e.getGL();e.deleteBuffer(this.indices_),delete this.indices_,n.deleteProgram(this.program_),delete this.program_;var i=this.tileTextureCache_;i.forEach(function(o){o.dispose()}),i.clear(),delete this.tileTextureCache_,r.prototype.disposeInternal.call(this)},t}(rm);Mf.prototype.getLayer;var r1=Mf,B={NUMBER:1,STRING:2,COLOR:4,BOOLEAN:8,NUMBER_ARRAY:16,ANY:31,NONE:0},ie={};function kt(r){if(typeof r=="number")return B.NUMBER;if(typeof r=="boolean")return B.BOOLEAN;if(typeof r=="string")return lv(r)?B.COLOR|B.STRING:B.STRING;if(!Array.isArray(r))throw new Error("Unhandled value type: "+JSON.stringify(r));var t=r,e=t.every(function(i){return typeof i=="number"});if(e)return t.length===3||t.length===4?B.COLOR|B.NUMBER_ARRAY:B.NUMBER_ARRAY;if(typeof t[0]!="string")throw new Error("Expected an expression operator but received: "+JSON.stringify(t));var n=ie[t[0]];if(n===void 0)throw new Error("Unrecognized expression operator: "+JSON.stringify(t));return n.getReturnType(t.slice(1))}function n1(r){return ec(r)%1==0}function wo(r){var t=r.toString();return t.indexOf(".")===-1?t+".0":t}function Df(r){if(r.length<2||r.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec"+r.length+"("+r.map(wo).join(", ")+")"}function i1(r){var t=Va(r).slice();return t.length<4&&t.push(1),Df(t.map(function(e,n){return n<3?e/255:e}))}function Lf(r,t){return r.stringLiteralsMap[t]===void 0&&(r.stringLiteralsMap[t]=Object.keys(r.stringLiteralsMap).length),r.stringLiteralsMap[t]}function o1(r,t){return wo(Lf(r,t))}function K(r,t,e){if(Array.isArray(t)&&typeof t[0]=="string"){var n=ie[t[0]];if(n===void 0)throw new Error("Unrecognized expression operator: "+JSON.stringify(t));return n.toGlsl(r,t.slice(1),e)}var i=kt(t);if((i&B.NUMBER)>0)return wo(t);if((i&B.BOOLEAN)>0)return t.toString();if((i&B.STRING)>0&&(e===void 0||e==B.STRING))return o1(r,t.toString());if((i&B.COLOR)>0&&(e===void 0||e==B.COLOR))return i1(t);if((i&B.NUMBER_ARRAY)>0)return Df(t);throw new Error("Unexpected expression "+t+" (expected type "+e+")")}function kf(r){if(!(kt(r)&B.NUMBER))throw new Error("A numeric value was expected, got "+JSON.stringify(r)+" instead")}function Be(r){for(var t=0;t<r.length;t++)kf(r[t])}function Nf(r){if(!(kt(r)&B.STRING))throw new Error("A string value was expected, got "+JSON.stringify(r)+" instead")}function Ps(r){if(!(kt(r)&B.BOOLEAN))throw new Error("A boolean value was expected, got "+JSON.stringify(r)+" instead")}function De(r,t){if(r.length!==t)throw new Error("Exactly "+t+" arguments were expected, got "+r.length+" instead")}function fr(r,t){if(r.length<t)throw new Error("At least "+t+" arguments were expected, got "+r.length+" instead")}function Co(r,t){if(r.length>t)throw new Error("At most "+t+" arguments were expected, got "+r.length+" instead")}function Ff(r){if(r.length%2!=0)throw new Error("An even amount of arguments was expected, got "+r+" instead")}function a1(r){if(r.length%2==0)throw new Error("An odd amount of arguments was expected, got "+r+" instead")}function Is(r,t){if(!n1(t))throw new Error("Could not infer only one type from the following expression: "+JSON.stringify(r))}ie.get={getReturnType:function(r){return B.ANY},toGlsl:function(r,t){De(t,1),Nf(t[0]);var e=t[0].toString();r.attributes.indexOf(e)===-1&&r.attributes.push(e);var n=r.inFragmentShader?"v_":"a_";return n+e}};function Uf(r){return"u_var_"+r}ie.var={getReturnType:function(r){return B.ANY},toGlsl:function(r,t){De(t,1),Nf(t[0]);var e=t[0].toString();return r.variables.indexOf(e)===-1&&r.variables.push(e),Uf(e)}};var Gf="u_paletteTextures";ie.palette={getReturnType:function(r){return B.COLOR},toGlsl:function(r,t){De(t,2),kf(t[0]);var e=K(r,t[0]),n=t[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");for(var i=n.length,o=new Uint8Array(i*4),a=0;a<i;a++){var s=n[a],l=void 0;if(typeof s=="string")l=oc(s);else{if(!Array.isArray(s))throw new Error("The second argument of palette must be an array of strings or colors");var u=s.length;if(u===4)l=s;else{if(u!==3)throw new Error("Expected palette color to have 3 or 4 values, got "+u);l=[s[0],s[1],s[2],1]}}var c=a*4;o[c]=l[0],o[c+1]=l[1],o[c+2]=l[2],o[c+3]=l[3]*255}r.paletteTextures||(r.paletteTextures=[]);var f=Gf+"["+r.paletteTextures.length+"]",h=new Hm(f,o);return r.paletteTextures.push(h),"texture2D("+f+", vec2(("+e+" + 0.5) / "+i+".0, 0.5))"}};var Ms="getBandValue";ie.band={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){fr(t,1),Co(t,3);var e=t[0];if(!(Ms in r.functions)){for(var n="",i=r.bandCount||1,o=0;o<i;o++){var a=Math.floor(o/4),s=o%4;s===i-1&&s===1&&(s=3);var l=Me.TILE_TEXTURE_ARRAY+"["+a+"]";n+=`
          if (band == `+(o+1)+`.0) {
            return texture2D(`+l+", v_textureCoord + vec2(dx, dy))["+s+`];
          }
        `}r.functions[Ms]=`
        float getBandValue(float band, float xOffset, float yOffset) {
          float dx = xOffset / `+Me.TEXTURE_PIXEL_WIDTH+`;
          float dy = yOffset / `+Me.TEXTURE_PIXEL_HEIGHT+`;
          `+n+`
        }
      `}var u=K(r,e),c=K(r,t[1]||0),f=K(r,t[2]||0);return Ms+"("+u+", "+c+", "+f+")"}};ie.time={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,0),"u_time"}};ie.zoom={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,0),"u_zoom"}};ie.resolution={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,0),"u_resolution"}};ie["*"]={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" * "+K(r,t[1])+")"}};ie["/"]={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" / "+K(r,t[1])+")"}};ie["+"]={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" + "+K(r,t[1])+")"}};ie["-"]={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" - "+K(r,t[1])+")"}};ie.clamp={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){De(t,3),Be(t);var e=K(r,t[1]),n=K(r,t[2]);return"clamp("+K(r,t[0])+", "+e+", "+n+")"}};ie["%"]={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,2),Be(t),"mod("+K(r,t[0])+", "+K(r,t[1])+")"}};ie["^"]={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,2),Be(t),"pow("+K(r,t[0])+", "+K(r,t[1])+")"}};ie.abs={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,1),Be(t),"abs("+K(r,t[0])+")"}};ie.sin={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,1),Be(t),"sin("+K(r,t[0])+")"}};ie.cos={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return De(t,1),Be(t),"cos("+K(r,t[0])+")"}};ie.atan={getReturnType:function(r){return B.NUMBER},toGlsl:function(r,t){return fr(t,1),Co(t,2),Be(t),t.length===2?"atan("+K(r,t[0])+", "+K(r,t[1])+")":"atan("+K(r,t[0])+")"}};ie[">"]={getReturnType:function(r){return B.BOOLEAN},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" > "+K(r,t[1])+")"}};ie[">="]={getReturnType:function(r){return B.BOOLEAN},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" >= "+K(r,t[1])+")"}};ie["<"]={getReturnType:function(r){return B.BOOLEAN},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" < "+K(r,t[1])+")"}};ie["<="]={getReturnType:function(r){return B.BOOLEAN},toGlsl:function(r,t){return De(t,2),Be(t),"("+K(r,t[0])+" <= "+K(r,t[1])+")"}};function jf(r){return{getReturnType:function(t){return B.BOOLEAN},toGlsl:function(t,e){De(e,2);for(var n=B.ANY,i=0;i<e.length;i++)n&=kt(e[i]);if(n===B.NONE)throw new Error("All arguments should be of compatible type, got "+JSON.stringify(e)+" instead");return n&=~B.COLOR,"("+K(t,e[0],n)+" "+r+" "+K(t,e[1],n)+")"}}}ie["=="]=jf("==");ie["!="]=jf("!=");ie["!"]={getReturnType:function(r){return B.BOOLEAN},toGlsl:function(r,t){return De(t,1),Ps(t[0]),"(!"+K(r,t[0])+")"}};function Bf(r){return{getReturnType:function(t){return B.BOOLEAN},toGlsl:function(t,e){fr(e,2);for(var n=0;n<e.length;n++)Ps(e[n]);var i="";return i=e.map(function(o){return K(t,o)}).join(" "+r+" "),i="("+i+")",i}}}ie.all=Bf("&&");ie.any=Bf("||");ie.between={getReturnType:function(r){return B.BOOLEAN},toGlsl:function(r,t){De(t,3),Be(t);var e=K(r,t[1]),n=K(r,t[2]),i=K(r,t[0]);return"("+i+" >= "+e+" && "+i+" <= "+n+")"}};ie.array={getReturnType:function(r){return B.NUMBER_ARRAY},toGlsl:function(r,t){fr(t,2),Co(t,4),Be(t);var e=t.map(function(n){return K(r,n,B.NUMBER)});return"vec"+t.length+"("+e.join(", ")+")"}};ie.color={getReturnType:function(r){return B.COLOR},toGlsl:function(r,t){fr(t,3),Co(t,4),Be(t);var e=t;t.length===3&&e.push(1);var n=t.map(function(i,o){return K(r,i,B.NUMBER)+(o<3?" / 255.0":"")});return"vec"+t.length+"("+n.join(", ")+")"}};ie.interpolate={getReturnType:function(r){for(var t=B.COLOR|B.NUMBER,e=3;e<r.length;e+=2)t=t&kt(r[e]);return t},toGlsl:function(r,t,e){Ff(t),fr(t,6);var n=t[0],i;switch(n[0]){case"linear":i=1;break;case"exponential":i=n[1];break;default:i=null}if(!i)throw new Error('Invalid interpolation type for "interpolate" operator, received: '+JSON.stringify(n));var o=e!==void 0?e:B.ANY,a=ie.interpolate.getReturnType(t)&o;Is(t,a);for(var s=K(r,t[1]),l=wo(i),u="",c=2;c<t.length-2;c+=2){var f=K(r,t[c]),h=u||K(r,t[c+1],a),d=K(r,t[c+2]),p=K(r,t[c+3],a);u="mix("+h+", "+p+", pow(clamp(("+s+" - "+f+") / ("+d+" - "+f+"), 0.0, 1.0), "+l+"))"}return u}};ie.match={getReturnType:function(r){for(var t=B.ANY,e=2;e<r.length;e+=2)t=t&kt(r[e]);return t=t&kt(r[r.length-1]),t},toGlsl:function(r,t,e){Ff(t),fr(t,4);var n=e!==void 0?e:B.ANY,i=ie.match.getReturnType(t)&n;Is(t,i);for(var o=K(r,t[0]),a=K(r,t[t.length-1],i),s=null,l=t.length-3;l>=1;l-=2){var u=K(r,t[l]),c=K(r,t[l+1],i);s="("+o+" == "+u+" ? "+c+" : "+(s||a)+")"}return s}};ie.case={getReturnType:function(r){for(var t=B.ANY,e=1;e<r.length;e+=2)t=t&kt(r[e]);return t=t&kt(r[r.length-1]),t},toGlsl:function(r,t,e){a1(t),fr(t,3);var n=e!==void 0?e:B.ANY,i=ie.case.getReturnType(t)&n;Is(t,i);for(var o=0;o<t.length-1;o+=2)Ps(t[o]);for(var a=K(r,t[t.length-1],i),s=null,o=t.length-3;o>=0;o-=2){var l=K(r,t[o]),u=K(r,t[o+1],i);s="("+l+" ? "+u+" : "+(s||a)+")"}return s}};var s1=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();function $f(r,t){var e=`
    attribute vec2 `+bo.TEXTURE_COORD+`;
    uniform mat4 `+Me.TILE_TRANSFORM+`;
    uniform float `+Me.DEPTH+`;

    varying vec2 v_textureCoord;

    void main() {
      v_textureCoord = `+bo.TEXTURE_COORD+`;
      gl_Position = `+Me.TILE_TRANSFORM+" * vec4("+bo.TEXTURE_COORD+", "+Me.DEPTH+`, 1.0);
    }
  `,n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:t},i=[];if(r.color!==void 0){var o=K(n,r.color,B.COLOR);i.push("color = "+o+";")}if(r.contrast!==void 0){var a=K(n,r.contrast,B.NUMBER);i.push("color.rgb = clamp(("+a+" + 1.0) * color.rgb - ("+a+" / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}if(r.exposure!==void 0){var s=K(n,r.exposure,B.NUMBER);i.push("color.rgb = clamp(("+s+" + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}if(r.saturation!==void 0){var l=K(n,r.saturation,B.NUMBER);i.push(`
      float saturation = `+l+` + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `)}if(r.gamma!==void 0){var u=K(n,r.gamma,B.NUMBER);i.push("color.rgb = pow(color.rgb, vec3(1.0 / "+u+"));")}if(r.brightness!==void 0){var c=K(n,r.brightness,B.NUMBER);i.push("color.rgb = clamp(color.rgb + "+c+", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}var f={},h=n.variables.length;if(h>1&&!r.variables)throw new Error("Missing variables in style (expected "+n.variables+")");for(var d=function(E){var y=n.variables[E];if(!(y in r.variables))throw new Error("Missing '"+y+"' in style variables");var w=Uf(y);f[w]=function(){var O=r.variables[y];return typeof O=="string"&&(O=Lf(n,O)),O!==void 0?O:-9999999}},p=0;p<h;++p)d(p);var g=Object.keys(f).map(function(E){return"uniform float "+E+";"}),_=Math.ceil(t/4);g.push("uniform sampler2D "+Me.TILE_TEXTURE_ARRAY+"["+_+"];"),n.paletteTextures&&g.push("uniform sampler2D "+Gf+"["+n.paletteTextures.length+"];");var x=Object.keys(n.functions).map(function(E){return n.functions[E]}),T=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    uniform float `+Me.TRANSITION_ALPHA+`;
    uniform float `+Me.TEXTURE_PIXEL_WIDTH+`;
    uniform float `+Me.TEXTURE_PIXEL_HEIGHT+`;
    uniform float `+Me.RESOLUTION+`;
    uniform float `+Me.ZOOM+`;

    `+g.join(`
`)+`

    `+x.join(`
`)+`

    void main() {
      vec4 color = texture2D(`+Me.TILE_TEXTURE_ARRAY+`[0],  v_textureCoord);

      `+i.join(`
`)+`

      if (color.a == 0.0) {
        discard;
      }

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= `+Me.TRANSITION_ALPHA+`;
    }`;return{vertexShader:e,fragmentShader:T,uniforms:f,paletteTextures:n.paletteTextures}}var zf=function(r){s1(t,r);function t(e){var n=this,i=e?Pe({},e):{},o=i.style||{};delete i.style;var a=i.cacheSize;return delete i.cacheSize,n=r.call(this,i)||this,n.style_=o,n.cacheSize_=a,n.styleVariables_=n.style_.variables||{},n.addChangeListener(he.SOURCE,n.handleSourceUpdate_),n}return t.prototype.handleSourceUpdate_=function(){this.setStyle(this.style_)},t.prototype.getSourceBandCount_=function(){var e=this.getSource();return e&&"bandCount"in e?e.bandCount:4},t.prototype.createRenderer=function(){var e=$f(this.style_,this.getSourceBandCount_());return new r1(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})},t.prototype.setStyle=function(e){this.style_=e;var n=$f(this.style_,this.getSourceBandCount_()),i=this.getRenderer();i.reset({vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms,paletteTextures:n.paletteTextures}),this.changed()},t.prototype.updateStyleVariables=function(e){Pe(this.styleVariables_,e),this.changed()},t}(Af);zf.prototype.dispose;var zb=zf,l1=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),u1=function(r){l1(t,r);function t(e){var n=this,i=z.IDLE;return n=r.call(this,e.tileCoord,i,{transition:e.transition,interpolate:e.interpolate})||this,n.loader_=e.loader,n.data_=null,n.error_=null,n}return t.prototype.getData=function(){return this.data_},t.prototype.getError=function(){return this.error_},t.prototype.load=function(){this.state=z.LOADING,this.changed();var e=this;this.loader_().then(function(n){e.data_=n,e.state=z.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=z.ERROR,e.changed()})},t}(bs),c1=u1,f1=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),h1=function(r){f1(t,r);function t(e){var n=this,i=e.projection===void 0?"EPSG:3857":e.projection,o=e.tileGrid;return o===void 0&&i&&(o=mm({extent:ws(i),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),n=r.call(this,{cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:i,tileGrid:o,opaque:e.opaque,state:e.state,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate})||this,n.tileLoadingKeys_={},n.loader_=e.loader,n.handleTileChange_=n.handleTileChange_.bind(n),n.bandCount=e.bandCount===void 0?4:e.bandCount,n}return t.prototype.setLoader=function(e){this.loader_=e},t.prototype.getTile=function(e,n,i,o,a){var s=fn(e,n,i);if(this.tileCache.containsKey(s))return this.tileCache.get(s);var l=this.loader_;function u(){return Mg(function(){return l(e,n,i)})}var c=new c1(Pe({tileCoord:[e,n,i],loader:u},this.tileOptions));return c.key=this.getKey(),c.addEventListener(ee.CHANGE,this.handleTileChange_),this.tileCache.set(s,c),c},t.prototype.handleTileChange_=function(e){var n=e.target,i=Ne(n),o=n.getState(),a;o==z.LOADING?(this.tileLoadingKeys_[i]=!0,a=hn.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],a=o==z.ERROR?hn.TILELOADERROR:o==z.LOADED?hn.TILELOADEND:void 0),a&&this.dispatchEvent(new Ef(a,n))},t}(xf),d1=h1;function Xe(r){return(t,...e)=>p1(r,t,e)}function dn(r,t){return Xe(Kf(r,t).get)}const{apply:p1,construct:Kb,defineProperty:Vb,get:Xb,getOwnPropertyDescriptor:Kf,getPrototypeOf:Ds,has:Hb,ownKeys:g1,set:Zb,setPrototypeOf:Wb}=Reflect,{iterator:qn,species:Yb,toStringTag:v1,for:qb}=Symbol,_1=Object,{create:Ls,defineProperty:y1,freeze:Qb,is:Jb}=_1,m1=Array,T1=m1.prototype,Vf=T1[qn],E1=Xe(Vf),Xf=ArrayBuffer;dn(Xf.prototype,"byteLength");const Hf=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:null;Hf&&dn(Hf.prototype,"byteLength");const Zf=Ds(Uint8Array);Zf.from;const Qe=Zf.prototype;Qe[qn];Xe(Qe.keys);Xe(Qe.values);Xe(Qe.entries);Xe(Qe.set);Xe(Qe.reverse);Xe(Qe.fill);Xe(Qe.copyWithin);Xe(Qe.sort);Xe(Qe.slice);Xe(Qe.subarray);dn(Qe,"buffer");dn(Qe,"byteOffset");dn(Qe,"length");dn(Qe,v1);const pn=Uint32Array,x1=Float32Array,Ro=Ds([][qn]()),b1=Xe(Ro.next),w1=Xe(function*(){}().next),C1=Ds(Ro),R1=DataView.prototype,S1=Xe(R1.getUint16),ks=WeakMap,Wf=ks.prototype,Yf=Xe(Wf.get),A1=Xe(Wf.set),qf=new ks,O1=Ls(null,{next:{value:function(){const t=Yf(qf,this);return b1(t)}},[qn]:{value:function(){return this}}});function P1(r){if(r[qn]===Vf)return r;const t=Ls(O1);return A1(qf,t,E1(r)),t}const I1=new ks,M1=Ls(C1,{next:{value:function(){const t=Yf(I1,this);return w1(t)},writable:!0,configurable:!0}});for(const r of g1(Ro))r!=="next"&&y1(M1,r,Kf(Ro,r));const Qf=new Xf(4),D1=new x1(Qf),L1=new pn(Qf),Nt=new pn(512),Ft=new pn(512);for(let r=0;r<256;++r){const t=r-127;t<-27?(Nt[r]=0,Nt[r|256]=32768,Ft[r]=24,Ft[r|256]=24):t<-14?(Nt[r]=1024>>-t-14,Nt[r|256]=1024>>-t-14|32768,Ft[r]=-t-1,Ft[r|256]=-t-1):t<=15?(Nt[r]=t+15<<10,Nt[r|256]=t+15<<10|32768,Ft[r]=13,Ft[r|256]=13):t<128?(Nt[r]=31744,Nt[r|256]=64512,Ft[r]=24,Ft[r|256]=24):(Nt[r]=31744,Nt[r|256]=64512,Ft[r]=13,Ft[r|256]=13)}const So=new pn(2048),Lr=new pn(64),Ao=new pn(64);So[0]=0;for(let r=1;r<1024;++r){let t=r<<13,e=0;for(;(t&8388608)==0;)e-=8388608,t<<=1;t&=~8388608,e+=947912704,So[r]=t|e}for(let r=1024;r<2048;++r)So[r]=939524096+(r-1024<<13);Lr[0]=0;for(let r=1;r<31;++r)Lr[r]=r<<23;Lr[31]=1199570944;Lr[32]=2147483648;for(let r=33;r<63;++r)Lr[r]=2147483648+(r-32<<23);Lr[63]=3347054592;Ao[0]=0;for(let r=1;r<64;++r)r===32?Ao[r]=0:Ao[r]=1024;function k1(r){const t=r>>10;return L1[0]=So[Ao[t]+(r&1023)]+Lr[t],D1[0]}function Jf(r,t,...e){return k1(S1(r,t,...P1(e)))}function N1(r,t,e){const n=e&&e.debug||!1;n&&console.log("getting "+t+" in "+r);const i=typeof r=="object"?r.outer:r,o=`${t}\\="([^"]*)"`;n&&console.log("pattern:",o);const s=new RegExp(o).exec(i);if(n&&console.log("match:",s),s)return s[1]}var eh=N1;function F1(r,t,e){const i=new RegExp(t).exec(r.slice(e));return i?e+i.index:-1}var U1=F1;const Ns=U1;function G1(r,t,e){const n=e&&e.debug||!1,i=e&&e.startIndex||0;n&&console.log("starting findTagByName with",t," and ",e);const o=Ns(r,`<${t}[ >]`,i);if(n&&console.log("start:",o),o===-1)return;const a=r.slice(o+t.length);let s=Ns(a,"[ /]"+t+">",0);const l=s===-1;l&&(s=Ns(a,"[ /]>",0));const u=o+t.length+s+1+(l?0:t.length)+1;if(n&&console.log("end:",u),u===-1)return;const c=r.slice(o,u);let f;return l?f=null:f=c.slice(c.indexOf(">")+1,c.lastIndexOf("<")),{inner:f,outer:c,start:o,end:u}}var j1=G1;const B1=j1;function $1(r,t,e){const n=[],i=e&&e.debug||!1;let o=e&&e.startIndex||0,a;for(;a=B1(r,t,{debug:i,startIndex:o});)o=a.end,n.push(a);return i&&console.log("findTagsByName found",n.length,"tags"),n}var z1=$1;const Qn={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Ut={};for(const r in Qn)Qn.hasOwnProperty(r)&&(Ut[Qn[r]]=parseInt(r,10));const K1=[Ut.BitsPerSample,Ut.ExtraSamples,Ut.SampleFormat,Ut.StripByteCounts,Ut.StripOffsets,Ut.StripRowCounts,Ut.TileByteCounts,Ut.TileOffsets,Ut.SubIFDs],Fs={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},te={};for(const r in Fs)Fs.hasOwnProperty(r)&&(te[Fs[r]]=parseInt(r,10));const lt={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},V1={Unspecified:0,Assocalpha:1,Unassalpha:2},ew={Version:0,AddCompression:1},tw={None:0,Deflate:1},Oo={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},X1={};for(const r in Oo)Oo.hasOwnProperty(r)&&(X1[Oo[r]]=parseInt(r,10));function H1(r,t){const{width:e,height:n}=r,i=new Uint8Array(e*n*3);let o;for(let a=0,s=0;a<r.length;++a,s+=3)o=256-r[a]/t*256,i[s]=o,i[s+1]=o,i[s+2]=o;return i}function Z1(r,t){const{width:e,height:n}=r,i=new Uint8Array(e*n*3);let o;for(let a=0,s=0;a<r.length;++a,s+=3)o=r[a]/t*256,i[s]=o,i[s+1]=o,i[s+2]=o;return i}function W1(r,t){const{width:e,height:n}=r,i=new Uint8Array(e*n*3),o=t.length/3,a=t.length/3*2;for(let s=0,l=0;s<r.length;++s,l+=3){const u=r[s];i[l]=t[u]/65536*256,i[l+1]=t[u+o]/65536*256,i[l+2]=t[u+a]/65536*256}return i}function Y1(r){const{width:t,height:e}=r,n=new Uint8Array(t*e*3);for(let i=0,o=0;i<r.length;i+=4,o+=3){const a=r[i],s=r[i+1],l=r[i+2],u=r[i+3];n[o]=255*((255-a)/256)*((255-u)/256),n[o+1]=255*((255-s)/256)*((255-u)/256),n[o+2]=255*((255-l)/256)*((255-u)/256)}return n}function q1(r){const{width:t,height:e}=r,n=new Uint8ClampedArray(t*e*3);for(let i=0,o=0;i<r.length;i+=3,o+=3){const a=r[i],s=r[i+1],l=r[i+2];n[o]=a+1.402*(l-128),n[o+1]=a-.34414*(s-128)-.71414*(l-128),n[o+2]=a+1.772*(s-128)}return n}const Q1=.95047,J1=1,eT=1.08883;function tT(r){const{width:t,height:e}=r,n=new Uint8Array(t*e*3);for(let i=0,o=0;i<r.length;i+=3,o+=3){const a=r[i+0],s=r[i+1]<<24>>24,l=r[i+2]<<24>>24;let u=(a+16)/116,c=s/500+u,f=u-l/200,h,d,p;c=Q1*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),u=J1*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),f=eT*(f*f*f>.008856?f*f*f:(f-16/116)/7.787),h=c*3.2406+u*-1.5372+f*-.4986,d=c*-.9689+u*1.8758+f*.0415,p=c*.0557+u*-.204+f*1.057,h=h>.0031308?1.055*h**(1/2.4)-.055:12.92*h,d=d>.0031308?1.055*d**(1/2.4)-.055:12.92*d,p=p>.0031308?1.055*p**(1/2.4)-.055:12.92*p,n[o]=Math.max(0,Math.min(1,h))*255,n[o+1]=Math.max(0,Math.min(1,d))*255,n[o+2]=Math.max(0,Math.min(1,p))*255}return n}const th=new Map;function kr(r,t){Array.isArray(r)||(r=[r]),r.forEach(e=>th.set(e,t))}async function rT(r){const t=th.get(r.Compression);if(!t)throw new Error(`Unknown compression method identifier: ${r.Compression}`);const e=await t();return new e(r)}kr([void 0,1],()=>import("./raw.f9f795b5.js").then(r=>r.default));kr(5,()=>import("./lzw.af7f834f.js").then(r=>r.default));kr(6,()=>{throw new Error("old style JPEG compression is not supported.")});kr(7,()=>import("./jpeg.d77a600d.js").then(r=>r.default));kr([8,32946],()=>import("./deflate.786b05f1.js").then(r=>r.default));kr(32773,()=>import("./packbits.13c43dee.js").then(r=>r.default));kr(34887,()=>import("./lerc.74d4afd6.js").then(r=>r.default));function Po(r,t,e,n=1){return new(Object.getPrototypeOf(r)).constructor(t*e*n)}function nT(r,t,e,n,i){const o=t/n,a=e/i;return r.map(s=>{const l=Po(s,n,i);for(let u=0;u<i;++u){const c=Math.min(Math.round(a*u),e-1);for(let f=0;f<n;++f){const h=Math.min(Math.round(o*f),t-1),d=s[c*t+h];l[u*n+f]=d}}return l})}function gn(r,t,e){return(1-e)*r+e*t}function iT(r,t,e,n,i){const o=t/n,a=e/i;return r.map(s=>{const l=Po(s,n,i);for(let u=0;u<i;++u){const c=a*u,f=Math.floor(c),h=Math.min(Math.ceil(c),e-1);for(let d=0;d<n;++d){const p=o*d,g=p%1,_=Math.floor(p),x=Math.min(Math.ceil(p),t-1),T=s[f*t+_],E=s[f*t+x],y=s[h*t+_],w=s[h*t+x],O=gn(gn(T,E,g),gn(y,w,g),c%1);l[u*n+d]=O}}return l})}function oT(r,t,e,n,i,o="nearest"){switch(o.toLowerCase()){case"nearest":return nT(r,t,e,n,i);case"bilinear":case"linear":return iT(r,t,e,n,i);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function aT(r,t,e,n,i,o){const a=t/n,s=e/i,l=Po(r,n,i,o);for(let u=0;u<i;++u){const c=Math.min(Math.round(s*u),e-1);for(let f=0;f<n;++f){const h=Math.min(Math.round(a*f),t-1);for(let d=0;d<o;++d){const p=r[c*t*o+h*o+d];l[u*n*o+f*o+d]=p}}}return l}function sT(r,t,e,n,i,o){const a=t/n,s=e/i,l=Po(r,n,i,o);for(let u=0;u<i;++u){const c=s*u,f=Math.floor(c),h=Math.min(Math.ceil(c),e-1);for(let d=0;d<n;++d){const p=a*d,g=p%1,_=Math.floor(p),x=Math.min(Math.ceil(p),t-1);for(let T=0;T<o;++T){const E=r[f*t*o+_*o+T],y=r[f*t*o+x*o+T],w=r[h*t*o+_*o+T],O=r[h*t*o+x*o+T],S=gn(gn(E,y,g),gn(w,O,g),c%1);l[u*n*o+d*o+T]=S}}}return l}function lT(r,t,e,n,i,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return aT(r,t,e,n,i,o);case"bilinear":case"linear":return sT(r,t,e,n,i,o);default:throw new Error(`Unsupported resampling method: '${a}'`)}}function uT(r,t,e){let n=0;for(let i=t;i<e;++i)n+=r[i];return n}function Us(r,t,e){switch(r){case 1:if(t<=8)return new Uint8Array(e);if(t<=16)return new Uint16Array(e);if(t<=32)return new Uint32Array(e);break;case 2:if(t===8)return new Int8Array(e);if(t===16)return new Int16Array(e);if(t===32)return new Int32Array(e);break;case 3:switch(t){case 16:case 32:return new Float32Array(e);case 64:return new Float64Array(e)}break}throw Error("Unsupported data format/bitsPerSample")}function cT(r,t){return(r===1||r===2)&&t<=32&&t%8==0?!1:!(r===3&&(t===16||t===32||t===64))}function fT(r,t,e,n,i,o,a){const s=new DataView(r),l=e===2?a*o:a*o*n,u=e===2?1:n,c=Us(t,i,l),f=parseInt("1".repeat(i),2);if(t===1){let h;e===1?h=n*i:h=i;let d=o*h;(d&7)!=0&&(d=d+7&~7);for(let p=0;p<a;++p){const g=p*d;for(let _=0;_<o;++_){const x=g+_*u*i;for(let T=0;T<u;++T){const E=x+T*i,y=(p*o+_)*u+T,w=Math.floor(E/8),O=E%8;if(O+i<=8)c[y]=s.getUint8(w)>>8-i-O&f;else if(O+i<=16)c[y]=s.getUint16(w)>>16-i-O&f;else if(O+i<=24){const S=s.getUint16(w)<<8|s.getUint8(w+2);c[y]=S>>24-i-O&f}else c[y]=s.getUint32(w)>>32-i-O&f}}}}return c.buffer}class hT{constructor(t,e,n,i,o,a){this.fileDirectory=t,this.geoKeys=e,this.dataView=n,this.littleEndian=i,this.tiles=o?{}:null,this.isTiled=!t.StripOffsets;const s=t.PlanarConfiguration;if(this.planarConfiguration=typeof s=="undefined"?1:s,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=a}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel!="undefined"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip!="undefined"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,n=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(i,o){return Jf(this,i,o)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,e){const n=this.getSampleFormat(t),i=this.getBitsPerSample(t);return Us(n,i,e)}async getTileOrStrip(t,e,n,i,o){const a=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:u}=this;this.planarConfiguration===1?l=e*a+t:this.planarConfiguration===2&&(l=n*a*s+e*a+t);let c,f;this.isTiled?(c=this.fileDirectory.TileOffsets[l],f=this.fileDirectory.TileByteCounts[l]):(c=this.fileDirectory.StripOffsets[l],f=this.fileDirectory.StripByteCounts[l]);const h=(await this.source.fetch([{offset:c,length:f}],o))[0];let d;return u===null||!u[l]?(d=(async()=>{let p=await i.decode(this.fileDirectory,h);const g=this.getSampleFormat(),_=this.getBitsPerSample();return cT(g,_)&&(p=fT(p,g,this.planarConfiguration,this.getSamplesPerPixel(),_,this.getTileWidth(),this.getBlockHeight(e))),p})(),u!==null&&(u[l]=d)):d=u[l],{x:t,y:e,sample:n,data:await d}}async _readRaster(t,e,n,i,o,a,s,l,u){const c=this.getTileWidth(),f=this.getTileHeight(),h=this.getWidth(),d=this.getHeight(),p=Math.max(Math.floor(t[0]/c),0),g=Math.min(Math.ceil(t[2]/c),Math.ceil(h/c)),_=Math.max(Math.floor(t[1]/f),0),x=Math.min(Math.ceil(t[3]/f),Math.ceil(d/f)),T=t[2]-t[0];let E=this.getBytesPerPixel();const y=[],w=[];for(let P=0;P<e.length;++P)this.planarConfiguration===1?y.push(uT(this.fileDirectory.BitsPerSample,0,e[P])/8):y.push(0),w.push(this.getReaderForSample(e[P]));const O=[],{littleEndian:S}=this;for(let P=_;P<x;++P)for(let L=p;L<g;++L)for(let N=0;N<e.length;++N){const j=N,W=e[N];this.planarConfiguration===2&&(E=this.getSampleByteSize(N));const ne=this.getTileOrStrip(L,P,W,o,u);O.push(ne),ne.then(se=>{const V=se.data,G=new DataView(V),F=this.getBlockHeight(se.y),U=se.y*f,oe=se.x*c,me=U+F,Ie=(se.x+1)*c,Y=w[j],xe=Math.min(F,F-(me-t[3]),d-U),J=Math.min(c,c-(Ie-t[2]),h-oe);for(let be=Math.max(0,t[1]-U);be<xe;++be)for(let Te=Math.max(0,t[0]-oe);Te<J;++Te){const Ce=(be*c+Te)*E,Oe=Y.call(G,Ce+y[j],S);let de;i?(de=(be+U-t[1])*T*e.length+(Te+oe-t[0])*e.length+j,n[de]=Oe):(de=(be+U-t[1])*T+Te+oe-t[0],n[j][de]=Oe)}})}if(await Promise.all(O),a&&t[2]-t[0]!==a||s&&t[3]-t[1]!==s){let P;return i?P=lT(n,t[2]-t[0],t[3]-t[1],a,s,e.length,l):P=oT(n,t[2]-t[0],t[3]-t[1],a,s,l),P.width=a,P.height=s,P}return n.width=a||t[2]-t[0],n.height=s||t[3]-t[1],n}async readRasters({window:t,samples:e=[],interleave:n,pool:i=null,width:o,height:a,resampleMethod:s,fillValue:l,signal:u}={}){const c=t||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const f=c[2]-c[0],h=c[3]-c[1],d=f*h,p=this.getSamplesPerPixel();if(!e||!e.length)for(let T=0;T<p;++T)e.push(T);else for(let T=0;T<e.length;++T)if(e[T]>=p)return Promise.reject(new RangeError(`Invalid sample index '${e[T]}'.`));let g;if(n){const T=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,E=Math.max.apply(null,this.fileDirectory.BitsPerSample);g=Us(T,E,d*e.length),l&&g.fill(l)}else{g=[];for(let T=0;T<e.length;++T){const E=this.getArrayForSample(e[T],d);Array.isArray(l)&&T<l.length?E.fill(l[T]):l&&!Array.isArray(l)&&E.fill(l),g.push(E)}}const _=i||await rT(this.fileDirectory);return await this._readRaster(c,e,g,n,_,o,a,s,u)}async readRGB({window:t,interleave:e=!0,pool:n=null,width:i,height:o,resampleMethod:a,enableAlpha:s=!1,signal:l}={}){const u=t||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===lt.RGB){let x=[0,1,2];if(this.fileDirectory.ExtraSamples!==V1.Unspecified&&s){x=[];for(let T=0;T<this.fileDirectory.BitsPerSample.length;T+=1)x.push(T)}return this.readRasters({window:t,interleave:e,samples:x,pool:n,width:i,height:o,resampleMethod:a,signal:l})}let f;switch(c){case lt.WhiteIsZero:case lt.BlackIsZero:case lt.Palette:f=[0];break;case lt.CMYK:f=[0,1,2,3];break;case lt.YCbCr:case lt.CIELab:f=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const h={window:u,interleave:!0,samples:f,pool:n,width:i,height:o,resampleMethod:a,signal:l},{fileDirectory:d}=this,p=await this.readRasters(h),g=2**this.fileDirectory.BitsPerSample[0];let _;switch(c){case lt.WhiteIsZero:_=H1(p,g);break;case lt.BlackIsZero:_=Z1(p,g);break;case lt.Palette:_=W1(p,d.ColorMap);break;case lt.CMYK:_=Y1(p);break;case lt.YCbCr:_=q1(p);break;case lt.CIELab:_=tT(p);break;default:throw new Error("Unsupported photometric interpretation.")}if(!e){const x=new Uint8Array(_.length/3),T=new Uint8Array(_.length/3),E=new Uint8Array(_.length/3);for(let y=0,w=0;y<_.length;y+=3,++w)x[w]=_[y],T[w]=_[y+1],E[w]=_[y+2];_=[x,T,E]}return _.width=p.width,_.height=p.height,_}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}getGDALMetadata(t=null){const e={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let i=z1(n,"Item");t!==null&&(i=i.filter(o=>Number(eh(o,"sample"))===t));for(let o=0;o<i.length;++o){const a=i[o];e[eh(a,"name")]=a.inner}return e}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&t.length===6)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const e=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(n)return[n[0],n[5],n[10]];if(t){const[i,o,a]=t.getResolution();return[i*t.getWidth()/this.getWidth(),o*t.getHeight()/this.getHeight(),a*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const t=this.getOrigin(),e=this.getResolution(),n=t[0],i=t[1],o=n+e[0]*this.getWidth(),a=i+e[1]*this.getHeight();return[Math.min(n,o),Math.min(i,a),Math.max(n,o),Math.max(i,a)]}}var rh=hT;class dT{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,e){const n=this.getUint32(t,e),i=this.getUint32(t+4,e);let o;if(e){if(o=n+2**32*i,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}if(o=2**32*n+i,!Number.isSafeInteger(o))throw new Error(`${o} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return o}getInt64(t,e){let n=0;const i=(this._dataView.getUint8(t+(e?7:0))&128)>0;let o=!0;for(let a=0;a<8;a++){let s=this._dataView.getUint8(t+(e?a:7-a));i&&(o?s!==0&&(s=~(s-1)&255,o=!1):s=~s&255),n+=s*256**a}return i&&(n=-n),n}getUint8(t,e){return this._dataView.getUint8(t,e)}getInt8(t,e){return this._dataView.getInt8(t,e)}getUint16(t,e){return this._dataView.getUint16(t,e)}getInt16(t,e){return this._dataView.getInt16(t,e)}getUint32(t,e){return this._dataView.getUint32(t,e)}getInt32(t,e){return this._dataView.getInt32(t,e)}getFloat16(t,e){return Jf(this._dataView,t,e)}getFloat32(t,e){return this._dataView.getFloat32(t,e)}getFloat64(t,e){return this._dataView.getFloat64(t,e)}}class pT{constructor(t,e,n,i){this._dataView=new DataView(t),this._sliceOffset=e,this._littleEndian=n,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const e=this.readUint32(t),n=this.readUint32(t+4);let i;if(this._littleEndian){if(i=e+2**32*n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*e+n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(t){let e=0;const n=(this._dataView.getUint8(t+(this._littleEndian?7:0))&128)>0;let i=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(t+(this._littleEndian?o:7-o));n&&(i?a!==0&&(a=~(a-1)&255,i=!1):a=~a&255),e+=a*256**o}return n&&(e=-e),e}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}const nh={deserialize(r){return Object.assign(Error(r.message),{name:r.name,stack:r.stack})},serialize(r){return{__error_marker:"$$error",message:r.message,name:r.name,stack:r.stack}}},gT=r=>r&&typeof r=="object"&&"__error_marker"in r&&r.__error_marker==="$$error",vT={deserialize(r){return gT(r)?nh.deserialize(r):r},serialize(r){return r instanceof Error?nh.serialize(r):r}};let ih=vT;function Io(r){return ih.deserialize(r)}function oh(r){return ih.serialize(r)}let Gs;function ah(){return Gs||(Gs=_T()),Gs}function _T(){try{throw new Error}catch(r){const t=(""+r.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return yT(t[0])}return"/"}function yT(r){return(""+r).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}const mT=typeof navigator!="undefined"&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,sh=r=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(r);function lh(r){const t=new Blob([r],{type:"application/javascript"});return URL.createObjectURL(t)}function TT(){if(typeof Worker=="undefined")return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class r extends Worker{constructor(n,i){var o,a;typeof n=="string"&&i&&i._baseURL?n=new URL(n,i._baseURL):typeof n=="string"&&!sh(n)&&ah().match(/^file:\/\//i)&&(n=new URL(n,ah().replace(/\/[^\/]+$/,"/")),((o=i==null?void 0:i.CORSWorkaround)!==null&&o!==void 0?o:!0)&&(n=lh(`importScripts(${JSON.stringify(n)});`))),typeof n=="string"&&sh(n)&&((a=i==null?void 0:i.CORSWorkaround)!==null&&a!==void 0?a:!0)&&(n=lh(`importScripts(${JSON.stringify(n)});`));super(n,i)}}class t extends r{constructor(n,i){const o=window.URL.createObjectURL(n);super(o,i)}static fromText(n,i){const o=new window.Blob([n],{type:"text/javascript"});return new t(o,i)}}return{blob:t,default:r}}let js;function uh(){return js||(js=TT()),js}var Bs={exports:{}},vn=1e3,_n=vn*60,yn=_n*60,Nr=yn*24,ET=Nr*7,xT=Nr*365.25,bT=function(r,t){t=t||{};var e=typeof r;if(e==="string"&&r.length>0)return wT(r);if(e==="number"&&isFinite(r))return t.long?RT(r):CT(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function wT(r){if(r=String(r),!(r.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!t){var e=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return e*xT;case"weeks":case"week":case"w":return e*ET;case"days":case"day":case"d":return e*Nr;case"hours":case"hour":case"hrs":case"hr":case"h":return e*yn;case"minutes":case"minute":case"mins":case"min":case"m":return e*_n;case"seconds":case"second":case"secs":case"sec":case"s":return e*vn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return e;default:return}}}}function CT(r){var t=Math.abs(r);return t>=Nr?Math.round(r/Nr)+"d":t>=yn?Math.round(r/yn)+"h":t>=_n?Math.round(r/_n)+"m":t>=vn?Math.round(r/vn)+"s":r+"ms"}function RT(r){var t=Math.abs(r);return t>=Nr?Mo(r,t,Nr,"day"):t>=yn?Mo(r,t,yn,"hour"):t>=_n?Mo(r,t,_n,"minute"):t>=vn?Mo(r,t,vn,"second"):r+" ms"}function Mo(r,t,e,n){var i=t>=e*1.5;return Math.round(r/e)+" "+n+(i?"s":"")}function ST(r){e.debug=e,e.default=e,e.coerce=l,e.disable=o,e.enable=i,e.enabled=a,e.humanize=bT,e.destroy=u,Object.keys(r).forEach(c=>{e[c]=r[c]}),e.names=[],e.skips=[],e.formatters={};function t(c){let f=0;for(let h=0;h<c.length;h++)f=(f<<5)-f+c.charCodeAt(h),f|=0;return e.colors[Math.abs(f)%e.colors.length]}e.selectColor=t;function e(c){let f,h=null,d,p;function g(..._){if(!g.enabled)return;const x=g,T=Number(new Date),E=T-(f||T);x.diff=E,x.prev=f,x.curr=T,f=T,_[0]=e.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let y=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(O,S)=>{if(O==="%%")return"%";y++;const P=e.formatters[S];if(typeof P=="function"){const L=_[y];O=P.call(x,L),_.splice(y,1),y--}return O}),e.formatArgs.call(x,_),(x.log||e.log).apply(x,_)}return g.namespace=c,g.useColors=e.useColors(),g.color=e.selectColor(c),g.extend=n,g.destroy=e.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(d!==e.namespaces&&(d=e.namespaces,p=e.enabled(c)),p),set:_=>{h=_}}),typeof e.init=="function"&&e.init(g),g}function n(c,f){const h=e(this.namespace+(typeof f=="undefined"?":":f)+c);return h.log=this.log,h}function i(c){e.save(c),e.namespaces=c,e.names=[],e.skips=[];let f;const h=(typeof c=="string"?c:"").split(/[\s,]+/),d=h.length;for(f=0;f<d;f++)!h[f]||(c=h[f].replace(/\*/g,".*?"),c[0]==="-"?e.skips.push(new RegExp("^"+c.substr(1)+"$")):e.names.push(new RegExp("^"+c+"$")))}function o(){const c=[...e.names.map(s),...e.skips.map(s).map(f=>"-"+f)].join(",");return e.enable(""),c}function a(c){if(c[c.length-1]==="*")return!0;let f,h;for(f=0,h=e.skips.length;f<h;f++)if(e.skips[f].test(c))return!1;for(f=0,h=e.names.length;f<h;f++)if(e.names[f].test(c))return!0;return!1}function s(c){return c.toString().substring(2,c.toString().length-2).replace(/\.\*\?$/,"*")}function l(c){return c instanceof Error?c.stack||c.message:c}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}var AT=ST;(function(r,t){t.formatArgs=n,t.save=i,t.load=o,t.useColors=e,t.storage=a(),t.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function e(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function n(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let c=0,f=0;l[0].replace(/%[a-zA-Z%]/g,h=>{h!=="%%"&&(c++,h==="%c"&&(f=c))}),l.splice(f,0,u)}t.log=console.debug||console.log||(()=>{});function i(l){try{l?t.storage.setItem("debug",l):t.storage.removeItem("debug")}catch{}}function o(){let l;try{l=t.storage.getItem("debug")}catch{}return!l&&typeof process!="undefined"&&"env"in process&&(l={}.DEBUG),l}function a(){try{return localStorage}catch{}}r.exports=AT(t);const{formatters:s}=r.exports;s.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(Bs,Bs.exports);var Jn=Bs.exports;const ch=()=>typeof Symbol=="function",$s=r=>ch()&&Boolean(Symbol[r]),zs=r=>$s(r)?Symbol[r]:"@@"+r;$s("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const OT=zs("iterator"),Ks=zs("observable"),fh=zs("species");function Do(r,t){const e=r[t];if(e!=null){if(typeof e!="function")throw new TypeError(e+" is not a function");return e}}function ei(r){let t=r.constructor;return t!==void 0&&(t=t[fh],t===null&&(t=void 0)),t!==void 0?t:Ht}function PT(r){return r instanceof Ht}function mn(r){mn.log?mn.log(r):setTimeout(()=>{throw r},0)}function Lo(r){Promise.resolve().then(()=>{try{r()}catch(t){mn(t)}})}function hh(r){const t=r._cleanup;if(t!==void 0&&(r._cleanup=void 0,!!t))try{if(typeof t=="function")t();else{const e=Do(t,"unsubscribe");e&&e.call(t)}}catch(e){mn(e)}}function Vs(r){r._observer=void 0,r._queue=void 0,r._state="closed"}function IT(r){const t=r._queue;if(!!t){r._queue=void 0,r._state="ready";for(const e of t)if(dh(r,e.type,e.value),r._state==="closed")break}}function dh(r,t,e){r._state="running";const n=r._observer;try{const i=n?Do(n,t):void 0;switch(t){case"next":i&&i.call(n,e);break;case"error":if(Vs(r),i)i.call(n,e);else throw e;break;case"complete":Vs(r),i&&i.call(n);break}}catch(i){mn(i)}r._state==="closed"?hh(r):r._state==="running"&&(r._state="ready")}function Xs(r,t,e){if(r._state!=="closed"){if(r._state==="buffering"){r._queue=r._queue||[],r._queue.push({type:t,value:e});return}if(r._state!=="ready"){r._state="buffering",r._queue=[{type:t,value:e}],Lo(()=>IT(r));return}dh(r,t,e)}}class MT{constructor(t,e){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const n=new DT(this);try{this._cleanup=e.call(void 0,n)}catch(i){n.error(i)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(Vs(this),hh(this))}}class DT{constructor(t){this._subscription=t}get closed(){return this._subscription._state==="closed"}next(t){Xs(this._subscription,"next",t)}error(t){Xs(this._subscription,"error",t)}complete(){Xs(this._subscription,"complete")}}class Ht{constructor(t){if(!(this instanceof Ht))throw new TypeError("Observable cannot be called as a function");if(typeof t!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,e,n){return(typeof t!="object"||t===null)&&(t={next:t,error:e,complete:n}),new MT(t,this._subscriber)}pipe(t,...e){let n=this;for(const i of[t,...e])n=i(n);return n}tap(t,e,n){const i=typeof t!="object"||t===null?{next:t,error:e,complete:n}:t;return new Ht(o=>this.subscribe({next(a){i.next&&i.next(a),o.next(a)},error(a){i.error&&i.error(a),o.error(a)},complete(){i.complete&&i.complete(),o.complete()},start(a){i.start&&i.start(a)}}))}forEach(t){return new Promise((e,n)=>{if(typeof t!="function"){n(new TypeError(t+" is not a function"));return}function i(){o.unsubscribe(),e(void 0)}const o=this.subscribe({next(a){try{t(a,i)}catch(s){n(s),o.unsubscribe()}},error(a){n(a)},complete(){e(void 0)}})})}map(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const e=ei(this);return new e(n=>this.subscribe({next(i){let o=i;try{o=t(i)}catch(a){return n.error(a)}n.next(o)},error(i){n.error(i)},complete(){n.complete()}}))}filter(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const e=ei(this);return new e(n=>this.subscribe({next(i){try{if(!t(i))return}catch(o){return n.error(o)}n.next(i)},error(i){n.error(i)},complete(){n.complete()}}))}reduce(t,e){if(typeof t!="function")throw new TypeError(t+" is not a function");const n=ei(this),i=arguments.length>1;let o=!1,a=e;return new n(s=>this.subscribe({next(l){const u=!o;if(o=!0,!u||i)try{a=t(a,l)}catch(c){return s.error(c)}else a=l},error(l){s.error(l)},complete(){if(!o&&!i)return s.error(new TypeError("Cannot reduce an empty sequence"));s.next(a),s.complete()}}))}concat(...t){const e=ei(this);return new e(n=>{let i,o=0;function a(s){i=s.subscribe({next(l){n.next(l)},error(l){n.error(l)},complete(){o===t.length?(i=void 0,n.complete()):a(e.from(t[o++]))}})}return a(this),()=>{i&&(i.unsubscribe(),i=void 0)}})}flatMap(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const e=ei(this);return new e(n=>{const i=[],o=this.subscribe({next(s){let l;if(t)try{l=t(s)}catch(c){return n.error(c)}else l=s;const u=e.from(l).subscribe({next(c){n.next(c)},error(c){n.error(c)},complete(){const c=i.indexOf(u);c>=0&&i.splice(c,1),a()}});i.push(u)},error(s){n.error(s)},complete(){a()}});function a(){o.closed&&i.length===0&&n.complete()}return()=>{i.forEach(s=>s.unsubscribe()),o.unsubscribe()}})}[Ks](){return this}static from(t){const e=typeof this=="function"?this:Ht;if(t==null)throw new TypeError(t+" is not an object");const n=Do(t,Ks);if(n){const i=n.call(t);if(Object(i)!==i)throw new TypeError(i+" is not an object");return PT(i)&&i.constructor===e?i:new e(o=>i.subscribe(o))}if($s("iterator")){const i=Do(t,OT);if(i)return new e(o=>{Lo(()=>{if(!o.closed){for(const a of i.call(t))if(o.next(a),o.closed)return;o.complete()}})})}if(Array.isArray(t))return new e(i=>{Lo(()=>{if(!i.closed){for(const o of t)if(i.next(o),i.closed)return;i.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){const e=typeof this=="function"?this:Ht;return new e(n=>{Lo(()=>{if(!n.closed){for(const i of t)if(n.next(i),n.closed)return;n.complete()}})})}static get[fh](){return this}}ch()&&Object.defineProperty(Ht,Symbol("extensions"),{value:{symbol:Ks,hostReportError:mn},configurable:!0});var Tn=Ht;function LT(r){typeof r=="function"?r():r&&typeof r.unsubscribe=="function"&&r.unsubscribe()}class kT extends Tn{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t)));this._observers=new Set}next(t){for(const e of this._observers)e.next(t)}error(t){for(const e of this._observers)e.error(t)}complete(){for(const t of this._observers)t.complete()}}var ph=kT;function gh(r){const t=new ph;let e,n=0;return new Tn(i=>{e||(e=r.subscribe(t));const o=t.subscribe(i);return n++,()=>{n--,o.unsubscribe(),n===0&&(LT(e),e=void 0)}})}function vh(r){return Promise.all(r.map(t=>{const e=o=>({status:"fulfilled",value:o}),n=o=>({status:"rejected",reason:o}),i=Promise.resolve(t);try{return i.then(e,n)}catch(o){return Promise.reject(o)}}))}var Ge;(function(r){r.initialized="initialized",r.taskCanceled="taskCanceled",r.taskCompleted="taskCompleted",r.taskFailed="taskFailed",r.taskQueued="taskQueued",r.taskQueueDrained="taskQueueDrained",r.taskStart="taskStart",r.terminated="terminated"})(Ge||(Ge={}));const _h=Symbol("thread.errors"),yh=Symbol("thread.events"),mh=Symbol("thread.terminate"),Th=Symbol("thread.transferable"),NT=Symbol("thread.worker");function Eh(r){throw Error(r)}const FT={errors(r){return r[_h]||Eh("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events(r){return r[yh]||Eh("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate(r){return r[mh]()}};var Fr=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{u(n.next(c))}catch(f){a(f)}}function l(c){try{u(n.throw(c))}catch(f){a(f)}}function u(c){c.done?o(c.value):i(c.value).then(s,l)}u((n=n.apply(r,t||[])).next())})};let UT=1;function GT(r){const t=[];for(let e=0;e<r;e++)t.push(e);return t}function jT(r){return new Promise(t=>setTimeout(t,r))}function BT(r,t){return r.reduce((e,n)=>[...e,...t(n)],[])}function $T(r){return r.replace(/\W/g," ").trim().replace(/\s+/g,"-")}function zT(r,t){return GT(t).map(()=>({init:r(),runningTasks:[]}))}class xh{constructor(t,e){this.eventSubject=new ph,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const n=typeof e=="number"?{size:e}:e||{},{size:i=mT}=n;this.debug=Jn(`threads:pool:${$T(n.name||String(UT++))}`),this.options=n,this.workers=zT(t,i),this.eventObservable=gh(Tn.from(this.eventSubject)),Promise.all(this.workers.map(o=>o.init)).then(()=>this.eventSubject.next({type:Ge.initialized,size:this.workers.length}),o=>{this.debug("Error while initializing pool worker:",o),this.eventSubject.error(o),this.initErrors.push(o)})}findIdlingWorker(){const{concurrency:t=1}=this.options;return this.workers.find(e=>e.runningTasks.length<t)}runPoolTask(t,e){return Fr(this,void 0,void 0,function*(){const n=this.workers.indexOf(t)+1;this.debug(`Running task #${e.id} on worker #${n}...`),this.eventSubject.next({type:Ge.taskStart,taskID:e.id,workerID:n});try{const i=yield e.run(yield t.init);this.debug(`Task #${e.id} completed successfully`),this.eventSubject.next({type:Ge.taskCompleted,returnValue:i,taskID:e.id,workerID:n})}catch(i){this.debug(`Task #${e.id} failed`),this.eventSubject.next({type:Ge.taskFailed,taskID:e.id,error:i,workerID:n})}})}run(t,e){return Fr(this,void 0,void 0,function*(){const n=(()=>Fr(this,void 0,void 0,function*(){const i=()=>{t.runningTasks=t.runningTasks.filter(o=>o!==n)};yield jT(0);try{yield this.runPoolTask(t,e)}finally{i(),this.isClosing||this.scheduleWork()}}))();t.runningTasks.push(n)})}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const t=this.findIdlingWorker();if(!t)return;const e=this.taskQueue.shift();if(!e){this.debug("Task queue is empty"),this.eventSubject.next({type:Ge.taskQueueDrained});return}this.run(t,e)}taskCompletion(t){return new Promise((e,n)=>{const i=this.events().subscribe(o=>{o.type===Ge.taskCompleted&&o.taskID===t?(i.unsubscribe(),e(o.returnValue)):o.type===Ge.taskFailed&&o.taskID===t?(i.unsubscribe(),n(o.error)):o.type===Ge.terminated&&(i.unsubscribe(),n(Error("Pool has been terminated before task was run.")))})})}settled(t=!1){return Fr(this,void 0,void 0,function*(){const e=()=>BT(this.workers,o=>o.runningTasks),n=[],i=this.eventObservable.subscribe(o=>{o.type===Ge.taskFailed&&n.push(o.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):t&&this.taskQueue.length===0?(yield vh(e()),n):(yield new Promise((o,a)=>{const s=this.eventObservable.subscribe({next(l){l.type===Ge.taskQueueDrained&&(s.unsubscribe(),o(void 0))},error:a})}),yield vh(e()),i.unsubscribe(),n)})}completed(t=!1){return Fr(this,void 0,void 0,function*(){const e=this.settled(t),n=new Promise((o,a)=>{const s=this.eventObservable.subscribe({next(l){l.type===Ge.taskQueueDrained?(s.unsubscribe(),o(e)):l.type===Ge.taskFailed&&(s.unsubscribe(),a(l.error))},error:a})}),i=yield Promise.race([e,n]);if(i.length>0)throw i[0]})}events(){return this.eventObservable}queue(t){const{maxQueuedJobs:e=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const n=this.nextTaskID++,i=this.taskCompletion(n);i.catch(a=>{this.debug(`Task #${n} errored:`,a)});const o={id:n,run:t,cancel:()=>{this.taskQueue.indexOf(o)!==-1&&(this.taskQueue=this.taskQueue.filter(a=>a!==o),this.eventSubject.next({type:Ge.taskCanceled,taskID:o.id}))},then:i.then.bind(i)};if(this.taskQueue.length>=e)throw Error(`Maximum number of pool tasks queued. Refusing to queue another one.
This usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.`);return this.debug(`Queueing task #${o.id}...`),this.taskQueue.push(o),this.eventSubject.next({type:Ge.taskQueued,taskID:o.id}),this.scheduleWork(),o}terminate(t){return Fr(this,void 0,void 0,function*(){this.isClosing=!0,t||(yield this.completed(!0)),this.eventSubject.next({type:Ge.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(e=>Fr(this,void 0,void 0,function*(){return FT.terminate(yield e.init)})))})}}xh.EventType=Ge;function bh(r,t){return new xh(r,t)}bh.EventType=Ge;const KT=bh,VT=()=>{};function XT(){let r=!1,t,e=VT;return[new Promise(o=>{r?o(t):e=o}),o=>{r=!0,t=o,e(t)}]}var En;(function(r){r.internalError="internalError",r.message="message",r.termination="termination"})(En||(En={}));const HT=()=>{},ZT=r=>r,wh=r=>Promise.resolve().then(r);function WT(r){throw r}function YT(r){return r&&typeof r.then=="function"}class ko extends Tn{constructor(t){super(e=>{const n=this,i=Object.assign(Object.assign({},e),{complete(){e.complete(),n.onCompletion()},error(o){e.error(o),n.onError(o)},next(o){e.next(o),n.onNext(o)}});try{return this.initHasRun=!0,t(i)}catch(o){i.error(o)}});this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(t){this.firstValueSet||(this.firstValue=t,this.firstValueSet=!0)}onError(t){this.state="rejected",this.rejection=t;for(const e of this.rejectionCallbacks)wh(()=>e(t))}onCompletion(){this.state="fulfilled";for(const t of this.fulfillmentCallbacks)wh(()=>t(this.firstValue))}then(t,e){const n=t||ZT,i=e||WT;let o=!1;return new Promise((a,s)=>{const l=c=>{if(!o){o=!0;try{a(i(c))}catch(f){s(f)}}},u=c=>{try{a(n(c))}catch(f){l(f)}};if(this.initHasRun||this.subscribe({error:l}),this.state==="fulfilled")return a(n(this.firstValue));if(this.state==="rejected")return o=!0,a(i(this.rejection));this.fulfillmentCallbacks.push(u),this.rejectionCallbacks.push(l)})}catch(t){return this.then(void 0,t)}finally(t){const e=t||HT;return this.then(n=>(e(),n),()=>e())}static from(t){return YT(t)?new ko(e=>{const n=o=>{e.next(o),e.complete()},i=o=>{e.error(o)};t.then(n,i)}):super.from(t)}}function qT(r){return!(!r||typeof r!="object")}function QT(r){return r&&typeof r=="object"&&r[Th]}function JT(r,t){if(!t){if(!qT(r))throw Error();t=[r]}return{[Th]:!0,send:r,transferables:t}}var No;(function(r){r.cancel="cancel",r.run="run"})(No||(No={}));var ti;(function(r){r.error="error",r.init="init",r.result="result",r.running="running",r.uncaughtError="uncaughtError"})(ti||(ti={}));const Ch=Jn("threads:master:messages");let eE=1;const tE=r=>Array.from(new Set(r)),rE=r=>r&&r.type===ti.error,nE=r=>r&&r.type===ti.result,iE=r=>r&&r.type===ti.running;function oE(r,t){return new Tn(e=>{let n;const i=o=>{if(Ch("Message from worker:",o.data),!(!o.data||o.data.uid!==t)){if(iE(o.data))n=o.data.resultType;else if(nE(o.data))n==="promise"?(typeof o.data.payload!="undefined"&&e.next(Io(o.data.payload)),e.complete(),r.removeEventListener("message",i)):(o.data.payload&&e.next(Io(o.data.payload)),o.data.complete&&(e.complete(),r.removeEventListener("message",i)));else if(rE(o.data)){const a=Io(o.data.error);e.error(a),r.removeEventListener("message",i)}}};return r.addEventListener("message",i),()=>{if(n==="observable"||!n){const o={type:No.cancel,uid:t};r.postMessage(o)}r.removeEventListener("message",i)}})}function aE(r){if(r.length===0)return{args:[],transferables:[]};const t=[],e=[];for(const n of r)QT(n)?(t.push(oh(n.send)),e.push(...n.transferables)):t.push(oh(n));return{args:t,transferables:e.length===0?e:tE(e)}}function Rh(r,t){return(...e)=>{const n=eE++,{args:i,transferables:o}=aE(e),a={type:No.run,uid:n,method:t,args:i};Ch("Sending command to run function to worker:",a);try{r.postMessage(a,o)}catch(s){return ko.from(Promise.reject(s))}return ko.from(gh(oE(r,n)))}}function sE(r,t){const e={};for(const n of t)e[n]=Rh(r,n);return e}var Hs=globalThis&&globalThis.__awaiter||function(r,t,e,n){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function s(c){try{u(n.next(c))}catch(f){a(f)}}function l(c){try{u(n.throw(c))}catch(f){a(f)}}function u(c){c.done?o(c.value):i(c.value).then(s,l)}u((n=n.apply(r,t||[])).next())})};const lE=Jn("threads:master:messages"),uE=Jn("threads:master:spawn"),Sh=Jn("threads:master:thread-utils"),cE=r=>r&&r.type==="init",fE=r=>r&&r.type==="uncaughtError",hE=typeof process!="undefined"&&{}.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt({}.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function dE(r,t,e){return Hs(this,void 0,void 0,function*(){let n;const i=new Promise((a,s)=>{n=setTimeout(()=>s(Error(e)),t)}),o=yield Promise.race([r,i]);return clearTimeout(n),o})}function pE(r){return new Promise((t,e)=>{const n=i=>{lE("Message from worker before finishing initialization:",i.data),cE(i.data)?(r.removeEventListener("message",n),t(i.data)):fE(i.data)&&(r.removeEventListener("message",n),e(Io(i.data.error)))};r.addEventListener("message",n)})}function gE(r,t){return new Tn(e=>{const n=o=>{const a={type:En.message,data:o.data};e.next(a)},i=o=>{Sh("Unhandled promise rejection event in thread:",o);const a={type:En.internalError,error:Error(o.reason)};e.next(a)};r.addEventListener("message",n),r.addEventListener("unhandledrejection",i),t.then(()=>{const o={type:En.termination};r.removeEventListener("message",n),r.removeEventListener("unhandledrejection",i),e.next(o),e.complete()})})}function vE(r){const[t,e]=XT();return{terminate:()=>Hs(this,void 0,void 0,function*(){Sh("Terminating worker"),yield r.terminate(),e()}),termination:t}}function Ah(r,t,e,n){const i=e.filter(o=>o.type===En.internalError).map(o=>o.error);return Object.assign(r,{[_h]:i,[yh]:e,[mh]:n,[NT]:t})}function _E(r,t){return Hs(this,void 0,void 0,function*(){uE("Initializing new thread");const e=t&&t.timeout?t.timeout:hE,i=(yield dE(pE(r),e,`Timeout: Did not receive an init message from worker after ${e}ms. Make sure the worker calls expose().`)).exposed,{termination:o,terminate:a}=vE(r),s=gE(r,o);if(i.type==="function"){const l=Rh(r);return Ah(l,r,s,a)}else if(i.type==="module"){const l=sE(r,i.methods);return Ah(l,r,s,a)}else{const l=i.type;throw Error(`Worker init message states unexpected type of expose(): ${l}`)}})}uh().blob;const yE=uh().default,mE=typeof navigator!="undefined"?navigator.hardwareConcurrency:null;class TE{constructor(t=mE,e=new yE("./decoder.worker.js")){this.pool=KT(()=>_E(e),t)}async decode(t,e){return new Promise((n,i)=>{this.pool.queue(async o=>{try{const a=await o(t,JT(e));n(a)}catch(a){i(a)}})})}destroy(){this.pool.terminate(!0)}}var EE=TE;const Oh=`\r
\r
`;function Ph(r){if(typeof Object.fromEntries!="undefined")return Object.fromEntries(r);const t={};for(const[e,n]of r)t[e.toLowerCase()]=n;return t}function xE(r){const t=r.split(`\r
`).map(e=>{const n=e.split(":").map(i=>i.trim());return n[0]=n[0].toLowerCase(),n});return Ph(t)}function bE(r){const[t,...e]=r.split(";").map(i=>i.trim()),n=e.map(i=>i.split("="));return{type:t,params:Ph(n)}}function Zs(r){let t,e,n;return r&&([,t,e,n]=r.match(/bytes (\d+)-(\d+)\/(\d+)/),t=parseInt(t,10),e=parseInt(e,10),n=parseInt(n,10)),{start:t,end:e,total:n}}function wE(r,t){let e=null;const n=new TextDecoder("ascii"),i=[],o=`--${t}`,a=`${o}--`;for(let s=0;s<10;++s)n.decode(new Uint8Array(r,s,o.length))===o&&(e=s);if(e===null)throw new Error("Could not find initial boundary");for(;e<r.byteLength;){const s=n.decode(new Uint8Array(r,e,Math.min(o.length+1024,r.byteLength-e)));if(s.length===0||s.startsWith(a))break;if(!s.startsWith(o))throw new Error("Part does not start with boundary");const l=s.substr(o.length+2);if(l.length===0)break;const u=l.indexOf(Oh),c=xE(l.substr(0,u)),{start:f,end:h,total:d}=Zs(c["content-range"]),p=e+o.length+u+Oh.length,g=parseInt(h,10)+1-parseInt(f,10);i.push({headers:c,data:r.slice(p,p+g),offset:f,length:g,fileSize:d}),e=p+g+4}return i}class Ih{async fetch(t,e=void 0){return Promise.all(t.map(n=>this.fetchSlice(n,e)))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}var CE=fe;fe.Node=Ur;fe.create=fe;function fe(r){var t=this;if(t instanceof fe||(t=new fe),t.tail=null,t.head=null,t.length=0,r&&typeof r.forEach=="function")r.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var e=0,n=arguments.length;e<n;e++)t.push(arguments[e]);return t}fe.prototype.removeNode=function(r){if(r.list!==this)throw new Error("removing node which does not belong to this list");var t=r.next,e=r.prev;return t&&(t.prev=e),e&&(e.next=t),r===this.head&&(this.head=t),r===this.tail&&(this.tail=e),r.list.length--,r.next=null,r.prev=null,r.list=null,t};fe.prototype.unshiftNode=function(r){if(r!==this.head){r.list&&r.list.removeNode(r);var t=this.head;r.list=this,r.next=t,t&&(t.prev=r),this.head=r,this.tail||(this.tail=r),this.length++}};fe.prototype.pushNode=function(r){if(r!==this.tail){r.list&&r.list.removeNode(r);var t=this.tail;r.list=this,r.prev=t,t&&(t.next=r),this.tail=r,this.head||(this.head=r),this.length++}};fe.prototype.push=function(){for(var r=0,t=arguments.length;r<t;r++)SE(this,arguments[r]);return this.length};fe.prototype.unshift=function(){for(var r=0,t=arguments.length;r<t;r++)AE(this,arguments[r]);return this.length};fe.prototype.pop=function(){if(!!this.tail){var r=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,r}};fe.prototype.shift=function(){if(!!this.head){var r=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,r}};fe.prototype.forEach=function(r,t){t=t||this;for(var e=this.head,n=0;e!==null;n++)r.call(t,e.value,n,this),e=e.next};fe.prototype.forEachReverse=function(r,t){t=t||this;for(var e=this.tail,n=this.length-1;e!==null;n--)r.call(t,e.value,n,this),e=e.prev};fe.prototype.get=function(r){for(var t=0,e=this.head;e!==null&&t<r;t++)e=e.next;if(t===r&&e!==null)return e.value};fe.prototype.getReverse=function(r){for(var t=0,e=this.tail;e!==null&&t<r;t++)e=e.prev;if(t===r&&e!==null)return e.value};fe.prototype.map=function(r,t){t=t||this;for(var e=new fe,n=this.head;n!==null;)e.push(r.call(t,n.value,this)),n=n.next;return e};fe.prototype.mapReverse=function(r,t){t=t||this;for(var e=new fe,n=this.tail;n!==null;)e.push(r.call(t,n.value,this)),n=n.prev;return e};fe.prototype.reduce=function(r,t){var e,n=this.head;if(arguments.length>1)e=t;else if(this.head)n=this.head.next,e=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)e=r(e,n.value,i),n=n.next;return e};fe.prototype.reduceReverse=function(r,t){var e,n=this.tail;if(arguments.length>1)e=t;else if(this.tail)n=this.tail.prev,e=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)e=r(e,n.value,i),n=n.prev;return e};fe.prototype.toArray=function(){for(var r=new Array(this.length),t=0,e=this.head;e!==null;t++)r[t]=e.value,e=e.next;return r};fe.prototype.toArrayReverse=function(){for(var r=new Array(this.length),t=0,e=this.tail;e!==null;t++)r[t]=e.value,e=e.prev;return r};fe.prototype.slice=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new fe;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)e.push(i.value);return e};fe.prototype.sliceReverse=function(r,t){t=t||this.length,t<0&&(t+=this.length),r=r||0,r<0&&(r+=this.length);var e=new fe;if(t<r||t<0)return e;r<0&&(r=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>r;n--,i=i.prev)e.push(i.value);return e};fe.prototype.splice=function(r,t,...e){r>this.length&&(r=this.length-1),r<0&&(r=this.length+r);for(var n=0,i=this.head;i!==null&&n<r;n++)i=i.next;for(var o=[],n=0;i&&n<t;n++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<e.length;n++)i=RE(this,i,e[n]);return o};fe.prototype.reverse=function(){for(var r=this.head,t=this.tail,e=r;e!==null;e=e.prev){var n=e.prev;e.prev=e.next,e.next=n}return this.head=t,this.tail=r,this};function RE(r,t,e){var n=t===r.head?new Ur(e,null,t,r):new Ur(e,t,t.next,r);return n.next===null&&(r.tail=n),n.prev===null&&(r.head=n),r.length++,n}function SE(r,t){r.tail=new Ur(t,r.tail,null,r),r.head||(r.head=r.tail),r.length++}function AE(r,t){r.head=new Ur(t,null,r.head,r),r.tail||(r.tail=r.head),r.length++}function Ur(r,t,e,n){if(!(this instanceof Ur))return new Ur(r,t,e,n);this.list=n,this.value=r,t?(t.next=this,this.prev=t):this.prev=null,e?(e.prev=this,this.next=e):this.next=null}try{require("./iterator.js")(fe)}catch{}const OE=CE,Gr=Symbol("max"),Zt=Symbol("length"),xn=Symbol("lengthCalculator"),ri=Symbol("allowStale"),jr=Symbol("maxAge"),Wt=Symbol("dispose"),Mh=Symbol("noDisposeOnSet"),$e=Symbol("lruList"),wt=Symbol("cache"),Dh=Symbol("updateAgeOnGet"),Ws=()=>1;class PE{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[Gr]=t.max||1/0;const e=t.length||Ws;if(this[xn]=typeof e!="function"?Ws:e,this[ri]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[jr]=t.maxAge||0,this[Wt]=t.dispose,this[Mh]=t.noDisposeOnSet||!1,this[Dh]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[Gr]=t||1/0,ni(this)}get max(){return this[Gr]}set allowStale(t){this[ri]=!!t}get allowStale(){return this[ri]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[jr]=t,ni(this)}get maxAge(){return this[jr]}set lengthCalculator(t){typeof t!="function"&&(t=Ws),t!==this[xn]&&(this[xn]=t,this[Zt]=0,this[$e].forEach(e=>{e.length=this[xn](e.value,e.key),this[Zt]+=e.length})),ni(this)}get lengthCalculator(){return this[xn]}get length(){return this[Zt]}get itemCount(){return this[$e].length}rforEach(t,e){e=e||this;for(let n=this[$e].tail;n!==null;){const i=n.prev;Lh(this,t,n,e),n=i}}forEach(t,e){e=e||this;for(let n=this[$e].head;n!==null;){const i=n.next;Lh(this,t,n,e),n=i}}keys(){return this[$e].toArray().map(t=>t.key)}values(){return this[$e].toArray().map(t=>t.value)}reset(){this[Wt]&&this[$e]&&this[$e].length&&this[$e].forEach(t=>this[Wt](t.key,t.value)),this[wt]=new Map,this[$e]=new OE,this[Zt]=0}dump(){return this[$e].map(t=>Fo(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[$e]}set(t,e,n){if(n=n||this[jr],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,o=this[xn](e,t);if(this[wt].has(t)){if(o>this[Gr])return bn(this,this[wt].get(t)),!1;const l=this[wt].get(t).value;return this[Wt]&&(this[Mh]||this[Wt](t,l.value)),l.now=i,l.maxAge=n,l.value=e,this[Zt]+=o-l.length,l.length=o,this.get(t),ni(this),!0}const a=new IE(t,e,o,i,n);return a.length>this[Gr]?(this[Wt]&&this[Wt](t,e),!1):(this[Zt]+=a.length,this[$e].unshift(a),this[wt].set(t,this[$e].head),ni(this),!0)}has(t){if(!this[wt].has(t))return!1;const e=this[wt].get(t).value;return!Fo(this,e)}get(t){return Ys(this,t,!0)}peek(t){return Ys(this,t,!1)}pop(){const t=this[$e].tail;return t?(bn(this,t),t.value):null}del(t){bn(this,this[wt].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const i=t[n],o=i.e||0;if(o===0)this.set(i.k,i.v);else{const a=o-e;a>0&&this.set(i.k,i.v,a)}}}prune(){this[wt].forEach((t,e)=>Ys(this,e,!1))}}const Ys=(r,t,e)=>{const n=r[wt].get(t);if(n){const i=n.value;if(Fo(r,i)){if(bn(r,n),!r[ri])return}else e&&(r[Dh]&&(n.value.now=Date.now()),r[$e].unshiftNode(n));return i.value}},Fo=(r,t)=>{if(!t||!t.maxAge&&!r[jr])return!1;const e=Date.now()-t.now;return t.maxAge?e>t.maxAge:r[jr]&&e>r[jr]},ni=r=>{if(r[Zt]>r[Gr])for(let t=r[$e].tail;r[Zt]>r[Gr]&&t!==null;){const e=t.prev;bn(r,t),t=e}},bn=(r,t)=>{if(t){const e=t.value;r[Wt]&&r[Wt](e.key,e.value),r[Zt]-=e.length,r[wt].delete(e.key),r[$e].removeNode(t)}};class IE{constructor(t,e,n,i,o){this.key=t,this.value=e,this.length=n,this.now=i,this.maxAge=o||0}}const Lh=(r,t,e,n)=>{let i=e.value;Fo(r,i)&&(bn(r,e),r[ri]||(i=void 0)),i&&t.call(n,i.value,i.key,r)};var ME=PE;async function DE(r){return new Promise(t=>setTimeout(t,r))}function kh(r,t){const e=Array.isArray(r)?r:Array.from(r),n=Array.isArray(t)?t:Array.from(t);return e.map((i,o)=>[i,n[o]])}class wn extends Error{constructor(t){super(t);Error.captureStackTrace&&Error.captureStackTrace(this,wn),this.name="AbortError"}}class LE extends Error{constructor(t,e){super(e);this.errors=t,this.message=e,this.name="AggregateError"}}const kE=LE;class NE{constructor(t,e,n=null){this.offset=t,this.length=e,this.data=n}get top(){return this.offset+this.length}}class Nh{constructor(t,e,n){this.offset=t,this.length=e,this.blockIds=n}}class FE extends Ih{constructor(t,{blockSize:e=65536,cacheSize:n=100}={}){super();this.source=t,this.blockSize=e,this.blockCache=new ME({max:n}),this.blockRequests=new Map,this.blockIdsToFetch=new Set}get fileSize(){return this.source.fileSize}async fetch(t,e){const n=new Map,i=new Map,o=new Set;for(const{offset:u,length:c}of t){let f=u+c;const{fileSize:h}=this;h!==null&&(f=Math.min(f,h));const d=Math.floor(u/this.blockSize)*this.blockSize;for(let p=d;p<f;p+=this.blockSize){const g=Math.floor(p/this.blockSize);this.blockCache.has(g)?n.set(g,this.blockCache.get(g)):this.blockRequests.has(g)?i.set(g,this.blockRequests.get(g)):(this.blockIdsToFetch.has(g)||this.blockIdsToFetch.add(g),o.add(g))}}await DE(),this.fetchBlocks(e);for(const u of o){const c=this.blockRequests.get(u),f=this.blockCache.get(u);if(c)i.set(u,c);else if(f)n.set(u,f);else throw new Error(`Block ${u} is not in the block requests`)}let a=await Promise.allSettled(Array.from(i.values()));if(a.some(u=>u.status==="rejected")){const u=new Set;for(const[c,f]of kh(i.keys(),a)){const{rejected:h,reason:d}=f;h&&d.name==="AbortError"&&d.signal!==e&&(this.blockIdsToFetch.add(c),u.add(c))}if(this.blockIdsToFetch.length>0){this.fetchBlocks(e);for(const c of u){const f=this.blockRequests.get(c);if(!f)throw new Error(`Block ${c} is not in the block requests`);i.set(c,f)}a=await Promise.allSettled(Array.from(i.values()))}}if(a.some(u=>u.status==="rejected"))throw e&&e.aborted?new wn("Request was aborted"):new kE(a.filter(u=>u.status==="rejected").map(u=>u.reason),"Request failed");const s=a.map(u=>u.value),l=new Map(kh(Array.from(i.keys()),s));for(const[u,c]of n)l.set(u,c);return this.readSliceData(t,l)}fetchBlocks(t){if(this.blockIdsToFetch.size>0){const e=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(e,t);for(let i=0;i<e.length;++i){const o=e[i];for(const a of o.blockIds){const s=(async()=>{try{const l=(await n)[i],u=a*this.blockSize,c=u-l.offset,f=Math.min(c+this.blockSize,l.data.byteLength),h=l.data.slice(c,f),d=new NE(u,h.byteLength,h);return this.blockCache.set(a,d),d}catch(l){throw l.name==="AbortError"&&(l.signal=t),l}finally{this.blockRequests.delete(a)}})();this.blockRequests.set(a,s)}}this.blockIdsToFetch.clear()}}groupBlocks(t){const e=Array.from(t).sort((a,s)=>a-s);if(e.length===0)return[];let n=[],i=null;const o=[];for(const a of e)i===null||i+1===a?(n.push(a),i=a):(o.push(new Nh(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[a],i=a);return o.push(new Nh(n[0]*this.blockSize,n.length*this.blockSize,n)),o}readSliceData(t,e){return t.map(n=>{const i=n.offset+n.length,o=Math.floor(n.offset/this.blockSize),a=Math.floor((n.offset+n.length)/this.blockSize),s=new ArrayBuffer(n.length),l=new Uint8Array(s);for(let u=o;u<=a;++u){const c=e.get(u),f=c.offset-n.offset,h=c.top-i;let d=0,p=0,g;f<0?d=-f:f>0&&(p=f),h<0?g=c.length-d:g=i-c.offset-d;const _=new Uint8Array(c.data,d,g);l.set(_,p)}return s})}}class qs{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(t){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Qs{constructor(t){this.url=t}async request({headers:t,credentials:e,signal:n}={}){throw new Error("request is not implemented")}}class UE extends qs{constructor(t){super();this.response=t}get status(){return this.response.status}getHeader(t){return this.response.headers.get(t)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class GE extends Qs{constructor(t,e){super(t);this.credentials=e}async request({headers:t,credentials:e,signal:n}={}){const i=await fetch(this.url,{headers:t,credentials:e,signal:n});return new UE(i)}}class jE extends qs{constructor(t,e){super();this.xhr=t,this.data=e}get status(){return this.xhr.status}getHeader(t){return this.xhr.getResponseHeader(t)}async getData(){return this.data}}class BE extends Qs{constructRequest(t,e){return new Promise((n,i)=>{const o=new XMLHttpRequest;o.open("GET",this.url),o.responseType="arraybuffer";for(const[a,s]of Object.entries(t))o.setRequestHeader(a,s);o.onload=()=>{const a=o.response;n(new jE(o,a))},o.onerror=i,o.onabort=()=>i(new wn("Request aborted")),o.send(),e&&(e.aborted&&o.abort(),e.addEventListener("abort",()=>o.abort()))})}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}var Js={};class $E extends qs{constructor(t,e){super();this.response=t,this.dataPromise=e}get status(){return this.response.statusCode}getHeader(t){return this.response.headers[t]}async getData(){return await this.dataPromise}}class zE extends Qs{constructor(t){super(t);this.parsedUrl=Js.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",Js)}constructRequest(t,e){return new Promise((n,i)=>{const o=this.httpApi.get(On(An({},this.parsedUrl),{headers:t}),a=>{const s=new Promise(l=>{const u=[];a.on("data",c=>{u.push(c)}),a.on("end",()=>{const c=Buffer.concat(u).buffer;l(c)}),a.on("error",i)});n(new $E(a,s))});o.on("error",i),e&&(e.aborted&&o.destroy(new wn("Request aborted")),e.addEventListener("abort",()=>o.destroy(new wn("Request aborted"))))})}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}class el extends Ih{constructor(t,e,n,i){super();this.client=t,this.headers=e,this.maxRanges=n,this.allowFullFile=i,this._fileSize=null}async fetch(t,e){return this.maxRanges>=t.length?this.fetchSlices(t,e):(this.maxRanges>0&&t.length>1,Promise.all(t.map(n=>this.fetchSlice(n,e))))}async fetchSlices(t,e){const n=await this.client.request({headers:On(An({},this.headers),{Range:`bytes=${t.map(({offset:i,length:o})=>`${i}-${i+o}`).join(",")}`}),signal:e});if(n.ok)if(n.status===206){const{type:i,params:o}=bE(n.getHeader("content-type"));if(i==="multipart/byteranges"){const f=wE(await n.getData(),o.boundary);return this._fileSize=f[0].fileSize||null,f}const a=await n.getData(),{start:s,end:l,total:u}=Zs(n.getHeader("content-range"));this._fileSize=u||null;const c=[{data:a,offset:s,length:l-s}];if(t.length>1){const f=await Promise.all(t.slice(1).map(h=>this.fetchSlice(h,e)));return c.concat(f)}return c}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const i=await n.getData();return this._fileSize=i.byteLength,[{data:i,offset:0,length:i.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(t,e){const{offset:n,length:i}=t,o=await this.client.request({headers:On(An({},this.headers),{Range:`bytes=${n}-${n+i}`}),signal:e});if(o.ok)if(o.status===206){const a=await o.getData(),{total:s}=Zs(o.getHeader("content-range"));return this._fileSize=s||null,{data:a,offset:n,length:i}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const a=await o.getData();return this._fileSize=a.byteLength,{data:a,offset:0,length:a.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function tl(r,{blockSize:t,cacheSize:e}){return t===null?r:new FE(r,t,e)}function KE(r,a={}){var s=a,{headers:t={},credentials:e,maxRanges:n=0,allowFullFile:i=!1}=s,o=Pn(s,["headers","credentials","maxRanges","allowFullFile"]);const l=new GE(r,e),u=new el(l,t,n,i);return tl(u,o)}function VE(r,o={}){var a=o,{headers:t={},maxRanges:e=0,allowFullFile:n=!1}=a,i=Pn(a,["headers","maxRanges","allowFullFile"]);const s=new BE(r),l=new el(s,t,e,n);return tl(l,i)}function XE(r,o={}){var a=o,{headers:t={},maxRanges:e=0,allowFullFile:n=!1}=a,i=Pn(a,["headers","maxRanges","allowFullFile"]);const s=new zE(r),l=new el(s,t,e,n);return tl(l,i)}function rl(r,n={}){var i=n,{forceXHR:t=!1}=i,e=Pn(i,["forceXHR"]);return typeof fetch=="function"&&!t?KE(r,e):typeof XMLHttpRequest!="undefined"?VE(r,e):XE(r,e)}function nl(r){switch(r){case te.BYTE:case te.ASCII:case te.SBYTE:case te.UNDEFINED:return 1;case te.SHORT:case te.SSHORT:return 2;case te.LONG:case te.SLONG:case te.FLOAT:case te.IFD:return 4;case te.RATIONAL:case te.SRATIONAL:case te.DOUBLE:case te.LONG8:case te.SLONG8:case te.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${r}`)}}function HE(r){const t=r.GeoKeyDirectory;if(!t)return null;const e={};for(let n=4;n<=t[3]*4;n+=4){const i=Oo[t[n]],o=t[n+1]?Qn[t[n+1]]:null,a=t[n+2],s=t[n+3];let l=null;if(!o)l=s;else{if(l=r[o],typeof l=="undefined"||l===null)throw new Error(`Could not get value of geoKey '${i}'.`);typeof l=="string"?l=l.substring(s,s+a-1):l.subarray&&(l=l.subarray(s,s+a),a===1&&(l=l[0]))}e[i]=l}return e}function Cn(r,t,e,n){let i=null,o=null;const a=nl(t);switch(t){case te.BYTE:case te.ASCII:case te.UNDEFINED:i=new Uint8Array(e),o=r.readUint8;break;case te.SBYTE:i=new Int8Array(e),o=r.readInt8;break;case te.SHORT:i=new Uint16Array(e),o=r.readUint16;break;case te.SSHORT:i=new Int16Array(e),o=r.readInt16;break;case te.LONG:case te.IFD:i=new Uint32Array(e),o=r.readUint32;break;case te.SLONG:i=new Int32Array(e),o=r.readInt32;break;case te.LONG8:case te.IFD8:i=new Array(e),o=r.readUint64;break;case te.SLONG8:i=new Array(e),o=r.readInt64;break;case te.RATIONAL:i=new Uint32Array(e*2),o=r.readUint32;break;case te.SRATIONAL:i=new Int32Array(e*2),o=r.readInt32;break;case te.FLOAT:i=new Float32Array(e),o=r.readFloat32;break;case te.DOUBLE:i=new Float64Array(e),o=r.readFloat64;break;default:throw new RangeError(`Invalid field type: ${t}`)}if(t===te.RATIONAL||t===te.SRATIONAL)for(let s=0;s<e;s+=2)i[s]=o.call(r,n+s*a),i[s+1]=o.call(r,n+(s*a+4));else for(let s=0;s<e;++s)i[s]=o.call(r,n+s*a);return t===te.ASCII?new TextDecoder("utf-8").decode(i):i}class ZE{constructor(t,e,n){this.fileDirectory=t,this.geoKeyDirectory=e,this.nextIFDByteOffset=n}}class Uo extends Error{constructor(t){super(`No image at index ${t}`);this.index=t}}class Fh{async readRasters(t={}){const{window:e,width:n,height:i}=t;let{resX:o,resY:a,bbox:s}=t;const l=await this.getImage();let u=l;const c=await this.getImageCount(),f=l.getBoundingBox();if(e&&s)throw new Error('Both "bbox" and "window" passed.');if(n||i){if(e){const[p,g]=l.getOrigin(),[_,x]=l.getResolution();s=[p+e[0]*_,g+e[1]*x,p+e[2]*_,g+e[3]*x]}const d=s||f;if(n){if(o)throw new Error("Both width and resX passed");o=(d[2]-d[0])/n}if(i){if(a)throw new Error("Both width and resY passed");a=(d[3]-d[1])/i}}if(o||a){const d=[];for(let p=0;p<c;++p){const g=await this.getImage(p),{SubfileType:_,NewSubfileType:x}=g.fileDirectory;(p===0||_===2||x&1)&&d.push(g)}d.sort((p,g)=>p.getWidth()-g.getWidth());for(let p=0;p<d.length;++p){const g=d[p],_=(f[2]-f[0])/g.getWidth(),x=(f[3]-f[1])/g.getHeight();if(u=g,o&&o>_||a&&a>x)break}}let h=e;if(s){const[d,p]=l.getOrigin(),[g,_]=u.getResolution(l);h=[Math.round((s[0]-d)/g),Math.round((s[1]-p)/_),Math.round((s[2]-d)/g),Math.round((s[3]-p)/_)],h=[Math.min(h[0],h[2]),Math.min(h[1],h[3]),Math.max(h[0],h[2]),Math.max(h[1],h[3])]}return u.readRasters(On(An({},t),{window:h}))}}class ii extends Fh{constructor(t,e,n,i,o={}){super();this.source=t,this.littleEndian=e,this.bigTiff=n,this.firstIFDOffset=i,this.cache=o.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,e){const n=this.bigTiff?4048:1024;return new pT((await this.source.fetch([{offset:t,length:typeof e!="undefined"?e:n}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const e=this.bigTiff?20:12,n=this.bigTiff?8:2;let i=await this.getSlice(t);const o=this.bigTiff?i.readUint64(t):i.readUint16(t),a=o*e+(this.bigTiff?16:6);i.covers(t,a)||(i=await this.getSlice(t,a));const s={};let l=t+(this.bigTiff?8:2);for(let f=0;f<o;l+=e,++f){const h=i.readUint16(l),d=i.readUint16(l+2),p=this.bigTiff?i.readUint64(l+4):i.readUint32(l+4);let g,_;const x=nl(d),T=l+(this.bigTiff?12:8);if(x*p<=(this.bigTiff?8:4))g=Cn(i,d,p,T);else{const E=i.readOffset(T),y=nl(d)*p;if(i.covers(E,y))g=Cn(i,d,p,E);else{const w=await this.getSlice(E,y);g=Cn(w,d,p,E)}}p===1&&K1.indexOf(h)===-1&&!(d===te.RATIONAL||d===te.SRATIONAL)?_=g[0]:_=g,s[Qn[h]]=_}const u=HE(s),c=i.readOffset(t+n+e*o);return new ZE(s,u,c)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(t===0)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(e){throw e instanceof Uo?new Uo(t):e}return this.ifdRequests[t]=(async()=>{const e=await this.ifdRequests[t-1];if(e.nextIFDByteOffset===0)throw new Uo(t);return this.parseFileDirectoryAt(e.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const e=await this.requestIFD(t);return new rh(e.fileDirectory,e.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,e=!0;for(;e;)try{await this.requestIFD(t),++t}catch(n){if(n instanceof Uo)e=!1;else throw n}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const e="GDAL_STRUCTURAL_METADATA_SIZE=",n=e.length+100;let i=await this.getSlice(t,n);if(e===Cn(i,te.ASCII,e.length,t)){const a=Cn(i,te.ASCII,n,t).split(`
`)[0],s=Number(a.split("=")[1].split(" ")[0])+a.length;s>n&&(i=await this.getSlice(t,s));const l=Cn(i,te.ASCII,s,t);this.ghostValues={},l.split(`
`).filter(u=>u.length>0).map(u=>u.split("=")).forEach(([u,c])=>{this.ghostValues[u]=c})}return this.ghostValues}static async fromSource(t,e,n){const i=(await t.fetch([{offset:0,length:1024}],n))[0],o=new dT(i),a=o.getUint16(0,0);let s;if(a===18761)s=!0;else if(a===19789)s=!1;else throw new TypeError("Invalid byte order value.");const l=o.getUint16(2,s);let u;if(l===42)u=!1;else if(l===43){if(u=!0,o.getUint16(4,s)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const c=u?o.getUint64(8,s):o.getUint32(4,s);return new ii(t,s,u,c,e)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class WE extends Fh{constructor(t,e){super();this.mainFile=t,this.overviewFiles=e,this.imageFiles=[t].concat(e),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const t=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(e=>e.parseFileDirectoryAt(e.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(t),this.fileDirectoriesPerFile}async getImage(t=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let e=0,n=0;for(let i=0;i<this.imageFiles.length;i++){const o=this.imageFiles[i];for(let a=0;a<this.imageCounts[i];a++){if(t===e){const s=await o.requestIFD(n);return new rh(s.fileDirectory,s.geoKeyDirectory,o.dataView,o.littleEndian,o.cache,o.source)}e++,n++}n=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const t=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(e=>e.getImageCount()));return this.imageCounts=await Promise.all(t),this.imageCount=this.imageCounts.reduce((e,n)=>e+n,0),this.imageCount}}async function YE(r,t={},e){return ii.fromSource(rl(r,t),e)}async function qE(r,t=[],e={},n){const i=await ii.fromSource(rl(r,e),n),o=await Promise.all(t.map(a=>ii.fromSource(rl(a,e))));return new WE(i,o)}function QE(){var r=`function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){asyncGeneratorStep(i,n,a,o,s,"next",e)}function s(e){asyncGeneratorStep(i,n,a,o,s,"throw",e)}o(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var runtime={exports:{}};!function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),o=new A(n||[]);return i._invoke=function(e,t,r){var n=u;return function(a,i){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===a)throw i;return I()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=x(o,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===u)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var l=c(e,t,r);if("normal"===l.type){if(n=r.done?p:d,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=p,r.method="throw",r.arg=l.arg)}}}(e,r,o),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var u="suspendedStart",d="suspendedYield",h="executing",p="completed",m={};function g(){}function y(){}function _(){}var b={};l(b,i,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(M([])));w&&w!==r&&n.call(w,i)&&(b=w);var k=_.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(a,i,o,s){var l=c(e[a],e,i);if("throw"!==l.type){var f=l.arg,u=f.value;return u&&"object"===_typeof(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(u).then((function(e){f.value=e,o(f)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=c(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function M(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:I}}function I(){return{value:t,done:!0}}return y.prototype=_,l(k,"constructor",_),l(_,"constructor",y),y.displayName=l(_,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new E(f(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(k),l(k,s,"Generator"),l(k,i,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=M,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),f=n.call(o,"finallyLoc");if(l&&f){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;D(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(runtime);var worker={},isObservable=function(e){return!!e&&("symbol"===_typeof(Symbol.observable)&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},common$1={},serializers={};function extendSerializer(e,t){var r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:function(e){return t.deserialize(e,r)},serialize:function(e){return t.serialize(e,n)}}}Object.defineProperty(serializers,"__esModule",{value:!0}),serializers.DefaultSerializer=serializers.extendSerializer=void 0,serializers.extendSerializer=extendSerializer;var DefaultErrorSerializer={deserialize:function(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize:function(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},isSerializedError=function(e){return e&&"object"===_typeof(e)&&"__error_marker"in e&&"$$error"===e.__error_marker};serializers.DefaultSerializer={deserialize:function(e){return isSerializedError(e)?DefaultErrorSerializer.deserialize(e):e},serialize:function(e){return e instanceof Error?DefaultErrorSerializer.serialize(e):e}},Object.defineProperty(common$1,"__esModule",{value:!0}),common$1.serialize=common$1.deserialize=common$1.registerSerializer=void 0;var serializers_1=serializers,registeredSerializer=serializers_1.DefaultSerializer;function registerSerializer(e){registeredSerializer=serializers_1.extendSerializer(registeredSerializer,e)}function deserialize(e){return registeredSerializer.deserialize(e)}function serialize(e){return registeredSerializer.serialize(e)}common$1.registerSerializer=registerSerializer,common$1.deserialize=deserialize,common$1.serialize=serialize;var transferable={},symbols={};Object.defineProperty(symbols,"__esModule",{value:!0}),symbols.$worker=symbols.$transferable=symbols.$terminate=symbols.$events=symbols.$errors=void 0,symbols.$errors=Symbol("thread.errors"),symbols.$events=Symbol("thread.events"),symbols.$terminate=Symbol("thread.terminate"),symbols.$transferable=Symbol("thread.transferable"),symbols.$worker=Symbol("thread.worker"),Object.defineProperty(transferable,"__esModule",{value:!0}),transferable.Transfer=transferable.isTransferDescriptor=void 0;var symbols_1=symbols;function isTransferable(e){return!(!e||"object"!==_typeof(e))}function isTransferDescriptor(e){return e&&"object"===_typeof(e)&&e[symbols_1.$transferable]}function Transfer$1(e,t){var r;if(!t){if(!isTransferable(e))throw Error();t=[e]}return _defineProperty(r={},symbols_1.$transferable,!0),_defineProperty(r,"send",e),_defineProperty(r,"transferables",t),r}transferable.isTransferDescriptor=isTransferDescriptor,transferable.Transfer=Transfer$1;var messages$1={},exports,MasterMessageType,WorkerMessageType;exports=messages$1,Object.defineProperty(exports,"__esModule",{value:!0}),exports.WorkerMessageType=exports.MasterMessageType=void 0,(MasterMessageType=exports.MasterMessageType||(exports.MasterMessageType={})).cancel="cancel",MasterMessageType.run="run",(WorkerMessageType=exports.WorkerMessageType||(exports.WorkerMessageType={})).error="error",WorkerMessageType.init="init",WorkerMessageType.result="result",WorkerMessageType.running="running",WorkerMessageType.uncaughtError="uncaughtError";var implementation$1={},implementation_browser={};Object.defineProperty(implementation_browser,"__esModule",{value:!0});var isWorkerRuntime$2=function(){var e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster$2=function(e,t){self.postMessage(e,t)},subscribeToMasterMessages$2=function(e){var t=function(t){e(t.data)};return self.addEventListener("message",t),function(){self.removeEventListener("message",t)}};implementation_browser.default={isWorkerRuntime:isWorkerRuntime$2,postMessageToMaster:postMessageToMaster$2,subscribeToMasterMessages:subscribeToMasterMessages$2};var implementation_tinyWorker={};Object.defineProperty(implementation_tinyWorker,"__esModule",{value:!0}),"undefined"==typeof self&&(commonjsGlobal.self=commonjsGlobal);var isWorkerRuntime$1=function(){return!("undefined"==typeof self||!self.postMessage)},postMessageToMaster$1=function(e){self.postMessage(e)},muxingHandlerSetUp=!1,messageHandlers=new Set,subscribeToMasterMessages$1=function(e){muxingHandlerSetUp||(self.addEventListener("message",(function(e){messageHandlers.forEach((function(t){return t(e.data)}))})),muxingHandlerSetUp=!0),messageHandlers.add(e);return function(){return messageHandlers.delete(e)}};implementation_tinyWorker.default={isWorkerRuntime:isWorkerRuntime$1,postMessageToMaster:postMessageToMaster$1,subscribeToMasterMessages:subscribeToMasterMessages$1};var implementation_worker_threads={},worker_threads={},implementation;function selectImplementation(){return"function"==typeof __non_webpack_require__?__non_webpack_require__("worker_threads"):eval("require")("worker_threads")}function getImplementation(){return implementation||(implementation=selectImplementation()),implementation}Object.defineProperty(worker_threads,"__esModule",{value:!0}),worker_threads.default=getImplementation;var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(implementation_worker_threads,"__esModule",{value:!0});var worker_threads_1=__importDefault$1(worker_threads);function assertMessagePort(e){if(!e)throw Error("Invariant violation: MessagePort to parent is not available.");return e}var isWorkerRuntime=function(){return!worker_threads_1.default().isMainThread},postMessageToMaster=function(e,t){assertMessagePort(worker_threads_1.default().parentPort).postMessage(e,t)},subscribeToMasterMessages=function(e){var t=worker_threads_1.default().parentPort;if(!t)throw Error("Invariant violation: MessagePort to parent is not available.");var r=function(t){e(t)};return assertMessagePort(t).on("message",r),function(){assertMessagePort(t).off("message",r)}};function testImplementation(){worker_threads_1.default()}implementation_worker_threads.default={isWorkerRuntime:isWorkerRuntime,postMessageToMaster:postMessageToMaster,subscribeToMasterMessages:subscribeToMasterMessages,testImplementation:testImplementation};var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(implementation$1,"__esModule",{value:!0});var implementation_browser_1=__importDefault(implementation_browser),implementation_tiny_worker_1=__importDefault(implementation_tinyWorker),implementation_worker_threads_1=__importDefault(implementation_worker_threads),runningInNode="undefined"!=typeof process&&"browser"!==process.arch&&"pid"in process;function selectNodeImplementation(){try{return implementation_worker_threads_1.default.testImplementation(),implementation_worker_threads_1.default}catch(e){return implementation_tiny_worker_1.default}}implementation$1.default=runningInNode?selectNodeImplementation():implementation_browser_1.default,function(e){var t=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.expose=e.isWorkerRuntime=e.Transfer=e.registerSerializer=void 0;var n=r(isObservable),a=common$1,i=transferable,o=messages$1,s=r(implementation$1),l=common$1;Object.defineProperty(e,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var f=transferable;Object.defineProperty(e,"Transfer",{enumerable:!0,get:function(){return f.Transfer}}),e.isWorkerRuntime=s.default.isWorkerRuntime;var c=!1,u=new Map,d=function(e){return e&&e.type===o.MasterMessageType.run},h=function(e){return n.default(e)||function(e){return e&&"object"===_typeof(e)&&"function"==typeof e.subscribe}(e)};function p(e){return i.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function m(e,t){var r=p(t),n=r.payload,i=r.transferables,l={type:o.WorkerMessageType.error,uid:e,error:a.serialize(n)};s.default.postMessageToMaster(l,i)}function g(e,t,r){var n=p(r),a=n.payload,i=n.transferables,l={type:o.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:a};s.default.postMessageToMaster(l,i)}function y(e,t){var r={type:o.WorkerMessageType.running,uid:e,resultType:t};s.default.postMessageToMaster(r)}function _(e){try{var t={type:o.WorkerMessageType.uncaughtError,error:a.serialize(e)};s.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\\nLatest error:",t,"\\nOriginal error:",e)}}function b(e,r,n){return t(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,o,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=r.apply(void 0,_toConsumableArray(n)),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",m(e,t.t0));case 7:if(o=h(i)?"observable":"promise",y(e,o),!h(i)){t.next=14;break}s=i.subscribe((function(t){return g(e,!1,a.serialize(t))}),(function(t){m(e,a.serialize(t)),u.delete(e)}),(function(){g(e,!0),u.delete(e)})),u.set(e,s),t.next=24;break;case 14:return t.prev=14,t.next=17,i;case 17:l=t.sent,g(e,!0,a.serialize(l)),t.next=24;break;case 21:t.prev=21,t.t1=t.catch(14),m(e,a.serialize(t.t1));case 24:case"end":return t.stop()}}),t,null,[[0,4],[14,21]])})))}e.expose=function(e){if(!s.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(c)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(c=!0,"function"==typeof e)s.default.subscribeToMasterMessages((function(t){d(t)&&!t.method&&b(t.uid,e,t.args.map(a.deserialize))})),t={type:o.WorkerMessageType.init,exposed:{type:"function"}},s.default.postMessageToMaster(t);else{if("object"!==_typeof(e)||!e)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: ".concat(e));s.default.subscribeToMasterMessages((function(t){d(t)&&t.method&&b(t.uid,e[t.method],t.args.map(a.deserialize))})),function(e){var t={type:o.WorkerMessageType.init,exposed:{type:"module",methods:e}};s.default.postMessageToMaster(t)}(Object.keys(e).filter((function(t){return"function"==typeof e[t]})))}var t;s.default.subscribeToMasterMessages((function(e){if((n=e)&&n.type===o.MasterMessageType.cancel){var t=e.uid,r=u.get(t);r&&(r.unsubscribe(),u.delete(t))}var n}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&s.default.isWorkerRuntime()&&(self.addEventListener("error",(function(e){setTimeout((function(){return _(e.error||e)}),250)})),self.addEventListener("unhandledrejection",(function(e){var t=e.reason;t&&"string"==typeof t.message&&setTimeout((function(){return _(t)}),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&s.default.isWorkerRuntime()&&(process.on("uncaughtException",(function(e){setTimeout((function(){return _(e)}),250)})),process.on("unhandledRejection",(function(e){e&&"string"==typeof e.message&&setTimeout((function(){return _(e)}),250)})))}(worker);var WorkerContext=getDefaultExportFromCjs(worker),expose=WorkerContext.expose;WorkerContext.registerSerializer;var Transfer=WorkerContext.Transfer,registry=new Map;function addDecoder(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){return registry.set(e,t)}))}function getDecoder(e){return _getDecoder.apply(this,arguments)}function _getDecoder(){return(_getDecoder=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=registry.get(t.Compression)){e.next=3;break}throw new Error("Unknown compression method identifier: ".concat(t.Compression));case 3:return e.next=5,r();case 5:return n=e.sent,e.abrupt("return",new n(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function decode(e,t){return _decode.apply(this,arguments)}function _decode(){return(_decode=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getDecoder(t);case 2:return n=e.sent,e.next=5,n.decode(t,r);case 5:return a=e.sent,e.abrupt("return",Transfer(a));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function decodeRowAcc(e,t){var r=e.length-t,n=0;do{for(var a=t;a>0;a--)e[n+t]+=e[n],n++;r-=t}while(r>0)}function decodeRowFloatingPoint(e,t,r){for(var n=0,a=e.length,i=a/r;a>t;){for(var o=t;o>0;--o)e[n+t]+=e[n],++n;a-=t}for(var s=e.slice(),l=0;l<i;++l)for(var f=0;f<r;++f)e[r*l+f]=s[(r-f-1)*i+l]}function applyPredictor(e,t,r,n,a,i){if(!t||1===t)return e;for(var o=0;o<a.length;++o){if(a[o]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(a[o]!==a[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var s=a[0]/8,l=2===i?1:a.length,f=0;f<n&&!(f*l*r*s>=e.byteLength);++f){var c=void 0;if(2===t){switch(a[0]){case 8:c=new Uint8Array(e,f*l*r*s,l*r*s);break;case 16:c=new Uint16Array(e,f*l*r*s,l*r*s/2);break;case 32:c=new Uint32Array(e,f*l*r*s,l*r*s/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(a[0]," bits per sample."))}decodeRowAcc(c,l)}else 3===t&&decodeRowFloatingPoint(c=new Uint8Array(e,f*l*r*s,l*r*s),l,s)}return e}addDecoder([void 0,1],(function(){return Promise.resolve().then((function(){return raw})).then((function(e){return e.default}))})),addDecoder(5,(function(){return Promise.resolve().then((function(){return lzw})).then((function(e){return e.default}))})),addDecoder(6,(function(){throw new Error("old style JPEG compression is not supported.")})),addDecoder(7,(function(){return Promise.resolve().then((function(){return jpeg})).then((function(e){return e.default}))})),addDecoder([8,32946],(function(){return Promise.resolve().then((function(){return deflate})).then((function(e){return e.default}))})),addDecoder(32773,(function(){return Promise.resolve().then((function(){return packbits})).then((function(e){return e.default}))})),addDecoder(34887,(function(){return Promise.resolve().then((function(){return lerc})).then((function(e){return e.default}))})),expose(decode);var BaseDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"decode",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decodeBlock(r);case 2:if(n=e.sent,1===(a=t.Predictor||1)){e.next=9;break}return i=!t.StripOffsets,o=i?t.TileWidth:t.ImageWidth,s=i?t.TileLength:t.RowsPerStrip||t.ImageLength,e.abrupt("return",applyPredictor(n,a,o,s,t.BitsPerSample,t.PlanarConfiguration));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),RawDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return e}}]),r}(),raw=Object.freeze({__proto__:null,default:RawDecoder}),MIN_BITS=9,CLEAR_CODE=256,EOI_CODE=257,MAX_BYTELENGTH=12;function getByte(e,t,r){var n=t%8,a=Math.floor(t/8),i=8-n,o=t+r-8*(a+1),s=8*(a+2)-(t+r),l=8*(a+2)-t;if(s=Math.max(0,s),a>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),EOI_CODE;var f=e[a]&Math.pow(2,8-n)-1,c=f<<=r-i;if(a+1<e.length){var u=e[a+1]>>>s;c+=u<<=Math.max(0,r-l)}if(o>8&&a+2<e.length){var d=8*(a+3)-(t+r);c+=e[a+2]>>>d}return c}function appendReversed(e,t){for(var r=t.length-1;r>=0;r--)e.push(t[r]);return e}function decompress(e){for(var t=new Uint16Array(4093),r=new Uint8Array(4093),n=0;n<=257;n++)t[n]=4096,r[n]=n;var a=258,i=MIN_BITS,o=0;function s(){a=258,i=MIN_BITS}function l(e){var t=getByte(e,o,i);return o+=i,t}function f(e,n){return r[a]=n,t[a]=e,++a-1}function c(e){for(var n=[],a=e;4096!==a;a=t[a])n.push(r[a]);return n}var u=[];s();for(var d,h=new Uint8Array(e),p=l(h);p!==EOI_CODE;){if(p===CLEAR_CODE){for(s(),p=l(h);p===CLEAR_CODE;)p=l(h);if(p===EOI_CODE)break;if(p>CLEAR_CODE)throw new Error("corrupted code at scanline ".concat(p));appendReversed(u,c(p)),d=p}else if(p<a){var m=c(p);appendReversed(u,m),f(d,m[m.length-1]),d=p}else{var g=c(d);if(!g)throw new Error("Bogus entry. Not in dictionary, ".concat(d," / ").concat(a,", position: ").concat(o));appendReversed(u,g),u.push(g[g.length-1]),f(d,g[g.length-1]),d=p}a+1>=Math.pow(2,i)&&(i===MAX_BYTELENGTH?d=void 0:i++),p=l(h)}return new Uint8Array(u)}var LZWDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return decompress(e).buffer}}]),r}(),lzw=Object.freeze({__proto__:null,default:LZWDecoder}),dctZigZag=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),dctCos1=4017,dctSin1=799,dctCos3=3406,dctSin3=2276,dctCos6=1567,dctSin6=3784,dctSqrt2=5793,dctSqrt1d2=2896;function buildHuffmanTable(e,t){for(var r=0,n=[],a=16;a>0&&!e[a-1];)--a;n.push({children:[],index:0});for(var i,o=n[0],s=0;s<a;s++){for(var l=0;l<e[s];l++){for((o=n.pop()).children[o.index]=t[r];o.index>0;)o=n.pop();for(o.index++,n.push(o);n.length<=s;)n.push(i={children:[],index:0}),o.children[o.index]=i.children,o=i;r++}s+1<a&&(n.push(i={children:[],index:0}),o.children[o.index]=i.children,o=i)}return n[0].children}function decodeScan(e,t,r,n,a,i,o,s,l){var f=r.mcusPerLine,c=r.progressive,u=t,d=t,h=0,p=0;function m(){if(p>0)return p--,h>>p&1;if(255===(h=e[d++])){var t=e[d++];if(t)throw new Error("unexpected marker: ".concat((h<<8|t).toString(16)))}return p=7,h>>>7}function g(e){for(var t,r=e;null!==(t=m());){if("number"==typeof(r=r[t]))return r;if("object"!==_typeof(r))throw new Error("invalid huffman sequence")}return null}function y(e){for(var t=e,r=0;t>0;){var n=m();if(null===n)return;r=r<<1|n,--t}return r}function _(e){var t=y(e);return t>=1<<e-1?t:t+(-1<<e)+1}var b=0;var v,w=0;function k(e,t,r,n,a){var i=r%f,o=(r/f|0)*e.v+n,s=i*e.h+a;t(e,e.blocks[o][s])}function T(e,t,r){var n=r/e.blocksPerLine|0,a=r%e.blocksPerLine;t(e,e.blocks[n][a])}var E,x,S,D,A,M,I=n.length;M=c?0===i?0===s?function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:_(r)<<l;e.pred+=n,t[0]=e.pred}:function(e,t){t[0]|=m()<<l}:0===s?function(e,t){if(b>0)b--;else for(var r=i,n=o;r<=n;){var a=g(e.huffmanTableAC),s=15&a,f=a>>4;if(0===s){if(f<15){b=y(f)+(1<<f)-1;break}r+=16}else t[dctZigZag[r+=f]]=_(s)*(1<<l),r++}}:function(e,t){for(var r=i,n=o,a=0;r<=n;){var s=dctZigZag[r],f=t[s]<0?-1:1;switch(w){case 0:var c=g(e.huffmanTableAC),u=15&c;if(a=c>>4,0===u)a<15?(b=y(a)+(1<<a),w=4):(a=16,w=1);else{if(1!==u)throw new Error("invalid ACn encoding");v=_(u),w=a?2:3}continue;case 1:case 2:t[s]?t[s]+=(m()<<l)*f:0==--a&&(w=2===w?3:0);break;case 3:t[s]?t[s]+=(m()<<l)*f:(t[s]=v<<l,w=0);break;case 4:t[s]&&(t[s]+=(m()<<l)*f)}r++}4===w&&0==--b&&(w=0)}:function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:_(r);e.pred+=n,t[0]=e.pred;for(var a=1;a<64;){var i=g(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15)break;a+=16}else t[dctZigZag[a+=s]]=_(o),a++}};var R,O,C=0;O=1===I?n[0].blocksPerLine*n[0].blocksPerColumn:f*r.mcusPerColumn;for(var P=a||O;C<O;){for(x=0;x<I;x++)n[x].pred=0;if(b=0,1===I)for(E=n[0],A=0;A<P;A++)T(E,M,C),C++;else for(A=0;A<P;A++){for(x=0;x<I;x++){var L=E=n[x],U=L.h,B=L.v;for(S=0;S<B;S++)for(D=0;D<U;D++)k(E,M,C,S,D)}if(++C===O)break}if(p=0,(R=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(R>=65488&&R<=65495))break;d+=2}return d-u}function buildComponentData(e,t){var r=[],n=t.blocksPerLine,a=t.blocksPerColumn,i=n<<3,o=new Int32Array(64),s=new Uint8Array(64);function l(e,r,n){var a,i,o,s,l,f,c,u,d,h,p=t.quantizationTable,m=n;for(h=0;h<64;h++)m[h]=e[h]*p[h];for(h=0;h<8;++h){var g=8*h;0!==m[1+g]||0!==m[2+g]||0!==m[3+g]||0!==m[4+g]||0!==m[5+g]||0!==m[6+g]||0!==m[7+g]?(a=dctSqrt2*m[0+g]+128>>8,i=dctSqrt2*m[4+g]+128>>8,o=m[2+g],s=m[6+g],l=dctSqrt1d2*(m[1+g]-m[7+g])+128>>8,u=dctSqrt1d2*(m[1+g]+m[7+g])+128>>8,f=m[3+g]<<4,c=m[5+g]<<4,d=a-i+1>>1,a=a+i+1>>1,i=d,d=o*dctSin6+s*dctCos6+128>>8,o=o*dctCos6-s*dctSin6+128>>8,s=d,d=l-c+1>>1,l=l+c+1>>1,c=d,d=u+f+1>>1,f=u-f+1>>1,u=d,d=a-s+1>>1,a=a+s+1>>1,s=d,d=i-o+1>>1,i=i+o+1>>1,o=d,d=l*dctSin3+u*dctCos3+2048>>12,l=l*dctCos3-u*dctSin3+2048>>12,u=d,d=f*dctSin1+c*dctCos1+2048>>12,f=f*dctCos1-c*dctSin1+2048>>12,c=d,m[0+g]=a+u,m[7+g]=a-u,m[1+g]=i+c,m[6+g]=i-c,m[2+g]=o+f,m[5+g]=o-f,m[3+g]=s+l,m[4+g]=s-l):(d=dctSqrt2*m[0+g]+512>>10,m[0+g]=d,m[1+g]=d,m[2+g]=d,m[3+g]=d,m[4+g]=d,m[5+g]=d,m[6+g]=d,m[7+g]=d)}for(h=0;h<8;++h){var y=h;0!==m[8+y]||0!==m[16+y]||0!==m[24+y]||0!==m[32+y]||0!==m[40+y]||0!==m[48+y]||0!==m[56+y]?(a=dctSqrt2*m[0+y]+2048>>12,i=dctSqrt2*m[32+y]+2048>>12,o=m[16+y],s=m[48+y],l=dctSqrt1d2*(m[8+y]-m[56+y])+2048>>12,u=dctSqrt1d2*(m[8+y]+m[56+y])+2048>>12,f=m[24+y],c=m[40+y],d=a-i+1>>1,a=a+i+1>>1,i=d,d=o*dctSin6+s*dctCos6+2048>>12,o=o*dctCos6-s*dctSin6+2048>>12,s=d,d=l-c+1>>1,l=l+c+1>>1,c=d,d=u+f+1>>1,f=u-f+1>>1,u=d,d=a-s+1>>1,a=a+s+1>>1,s=d,d=i-o+1>>1,i=i+o+1>>1,o=d,d=l*dctSin3+u*dctCos3+2048>>12,l=l*dctCos3-u*dctSin3+2048>>12,u=d,d=f*dctSin1+c*dctCos1+2048>>12,f=f*dctCos1-c*dctSin1+2048>>12,c=d,m[0+y]=a+u,m[56+y]=a-u,m[8+y]=i+c,m[48+y]=i-c,m[16+y]=o+f,m[40+y]=o-f,m[24+y]=s+l,m[32+y]=s-l):(d=dctSqrt2*n[h+0]+8192>>14,m[0+y]=d,m[8+y]=d,m[16+y]=d,m[24+y]=d,m[32+y]=d,m[40+y]=d,m[48+y]=d,m[56+y]=d)}for(h=0;h<64;++h){var _=128+(m[h]+8>>4);r[h]=_<0?0:_>255?255:_}}for(var f=0;f<a;f++){for(var c=f<<3,u=0;u<8;u++)r.push(new Uint8Array(i));for(var d=0;d<n;d++){l(t.blocks[f][d],s,o);for(var h=0,p=d<<3,m=0;m<8;m++)for(var g=r[c+m],y=0;y<8;y++)g[p+y]=s[h++]}}return r}var JpegStreamReader=function(){function e(){_classCallCheck(this,e),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return _createClass(e,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(e){var t=0;function r(){var r=e[t]<<8|e[t+1];return t+=2,r}function n(e){var t,r,n=0,a=0;for(r in e.components)e.components.hasOwnProperty(r)&&(n<(t=e.components[r]).h&&(n=t.h),a<t.v&&(a=t.v));var i=Math.ceil(e.samplesPerLine/8/n),o=Math.ceil(e.scanLines/8/a);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];for(var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/n),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/a),f=i*t.h,c=o*t.v,u=[],d=0;d<c;d++){for(var h=[],p=0;p<f;p++)h.push(new Int32Array(64));u.push(h)}t.blocksPerLine=s,t.blocksPerColumn=l,t.blocks=u}e.maxH=n,e.maxV=a,e.mcusPerLine=i,e.mcusPerColumn=o}var a,i,o=r();if(65496!==o)throw new Error("SOI not found");for(o=r();65497!==o;){switch(o){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var s=(a=void 0,i=void 0,a=r(),i=e.subarray(t,t+a-2),t+=i.length,i);65504===o&&74===s[0]&&70===s[1]&&73===s[2]&&70===s[3]&&0===s[4]&&(this.jfif={version:{major:s[5],minor:s[6]},densityUnits:s[7],xDensity:s[8]<<8|s[9],yDensity:s[10]<<8|s[11],thumbWidth:s[12],thumbHeight:s[13],thumbData:s.subarray(14,14+3*s[12]*s[13])}),65518===o&&65===s[0]&&100===s[1]&&111===s[2]&&98===s[3]&&101===s[4]&&0===s[5]&&(this.adobe={version:s[6],flags0:s[7]<<8|s[8],flags1:s[9]<<8|s[10],transformCode:s[11]});break;case 65499:for(var l=r()+t-2;t<l;){var f=e[t++],c=new Int32Array(64);if(f>>4==0)for(var u=0;u<64;u++){c[dctZigZag[u]]=e[t++]}else{if(f>>4!=1)throw new Error("DQT: invalid table spec");for(var d=0;d<64;d++){c[dctZigZag[d]]=r()}}this.quantizationTables[15&f]=c}break;case 65472:case 65473:case 65474:r();for(var h={extended:65473===o,progressive:65474===o,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},p=e[t++],m=void 0,g=0;g<p;g++){m=e[t];var y=e[t+1]>>4,_=15&e[t+1],b=e[t+2];h.componentsOrder.push(m),h.components[m]={h:y,v:_,quantizationIdx:b},t+=3}n(h),this.frames.push(h);break;case 65476:for(var v=r(),w=2;w<v;){for(var k=e[t++],T=new Uint8Array(16),E=0,x=0;x<16;x++,t++)T[x]=e[t],E+=T[x];for(var S=new Uint8Array(E),D=0;D<E;D++,t++)S[D]=e[t];w+=17+E,k>>4==0?this.huffmanTablesDC[15&k]=buildHuffmanTable(T,S):this.huffmanTablesAC[15&k]=buildHuffmanTable(T,S)}break;case 65501:r(),this.resetInterval=r();break;case 65498:r();for(var A=e[t++],M=[],I=this.frames[0],R=0;R<A;R++){var O=I.components[e[t++]],C=e[t++];O.huffmanTableDC=this.huffmanTablesDC[C>>4],O.huffmanTableAC=this.huffmanTablesAC[15&C],M.push(O)}var P=e[t++],L=e[t++],U=e[t++],B=decodeScan(e,t,I,M,this.resetInterval,P,L,U>>4,15&U);t+=B;break;case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error("unknown JPEG marker ".concat(o.toString(16)))}o=r()}}},{key:"getResult",value:function(){var e=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var t=0;t<this.frames.length;t++)for(var r=this.frames[t].components,n=0,a=Object.keys(r);n<a.length;n++){var i=a[n];r[i].quantizationTable=this.quantizationTables[r[i].quantizationIdx],delete r[i].quantizationIdx}for(var o=e[0],s=o.components,l=o.componentsOrder,f=[],c=o.samplesPerLine,u=o.scanLines,d=0;d<l.length;d++){var h=s[l[d]];f.push({lines:buildComponentData(o,h),scaleX:h.h/o.maxH,scaleY:h.v/o.maxV})}for(var p=new Uint8Array(c*u*f.length),m=0,g=0;g<u;++g)for(var y=0;y<c;++y)for(var _=0;_<f.length;++_){var b=f[_];p[m]=b.lines[0|g*b.scaleY][0|y*b.scaleX],++m}return p}}]),e}(),JpegDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).reader=new JpegStreamReader,e.JPEGTables&&n.reader.parse(e.JPEGTables),n}return _createClass(r,[{key:"decodeBlock",value:function(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}]),r}(),jpeg=Object.freeze({__proto__:null,default:JpegDecoder});function zero$1(e){for(var t=e.length;--t>=0;)e[t]=0}var MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES$1+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES$1);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);var adler32=function(e,t,r,n){for(var a=65535&e|0,i=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{i=i+(a=a+t[n++]|0)|0}while(--o);a%=65521,i%=65521}return a|i<<16|0},adler32_1=adler32,makeTable=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t},crcTable=new Uint32Array(makeTable()),crc32=function(e,t,r,n){var a=crcTable,i=n+r;e^=-1;for(var o=n;o<i;o++)e=e>>>8^a[255&(e^t[o])];return-1^e},crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},_has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==_typeof(r))throw new TypeError(r+"must be non-object");for(var n in r)_has(r,n)&&(e[n]=r[n])}}return e},flattenChunks=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var a=new Uint8Array(t),i=0,o=0,s=e.length;i<s;i++){var l=e[i];a.set(l,o),o+=l.length}return a},common={assign:assign,flattenChunks:flattenChunks},STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new Uint8Array(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,r,n,a,i,o=e.length,s=0;for(a=0;a<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),i=0,a=0;i<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|63&r):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|63&r):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|63&r);return t},buf2binstring=function(e,t){if(t<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},buf2string=function(e,t){var r,n,a=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var i=new Array(2*a);for(n=0,r=0;r<a;){var o=e[r++];if(o<128)i[n++]=o;else{var s=_utf8len[o];if(s>4)i[n++]=65533,r+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&r<a;)o=o<<6|63&e[r++],s--;s>1?i[n++]=65533:o<65536?i[n++]=o:(o-=65536,i[n++]=55296|o>>10&1023,i[n++]=56320|1023&o)}}}return buf2binstring(i,n)},utf8border=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+_utf8len[e[r]]>t?r:t},strings={string2buf:string2buf,buf2string:buf2string,utf8border:utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream,BAD$1=30,TYPE$1=12,inffast=function(e,t){var r,n,a,i,o,s,l,f,c,u,d,h,p,m,g,y,_,b,v,w,k,T,E,x,S=e.state;r=e.next_in,E=e.input,n=r+(e.avail_in-5),a=e.next_out,x=e.output,i=a-(t-e.avail_out),o=a+(e.avail_out-257),s=S.dmax,l=S.wsize,f=S.whave,c=S.wnext,u=S.window,d=S.hold,h=S.bits,p=S.lencode,m=S.distcode,g=(1<<S.lenbits)-1,y=(1<<S.distbits)-1;e:do{h<15&&(d+=E[r++]<<h,h+=8,d+=E[r++]<<h,h+=8),_=p[d&g];t:for(;;){if(d>>>=b=_>>>24,h-=b,0===(b=_>>>16&255))x[a++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=p[(65535&_)+(d&(1<<b)-1)];continue t}if(32&b){S.mode=TYPE$1;break e}e.msg="invalid literal/length code",S.mode=BAD$1;break e}v=65535&_,(b&=15)&&(h<b&&(d+=E[r++]<<h,h+=8),v+=d&(1<<b)-1,d>>>=b,h-=b),h<15&&(d+=E[r++]<<h,h+=8,d+=E[r++]<<h,h+=8),_=m[d&y];r:for(;;){if(d>>>=b=_>>>24,h-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=m[(65535&_)+(d&(1<<b)-1)];continue r}e.msg="invalid distance code",S.mode=BAD$1;break e}if(w=65535&_,h<(b&=15)&&(d+=E[r++]<<h,(h+=8)<b&&(d+=E[r++]<<h,h+=8)),(w+=d&(1<<b)-1)>s){e.msg="invalid distance too far back",S.mode=BAD$1;break e}if(d>>>=b,h-=b,w>(b=a-i)){if((b=w-b)>f&&S.sane){e.msg="invalid distance too far back",S.mode=BAD$1;break e}if(k=0,T=u,0===c){if(k+=l-b,b<v){v-=b;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}}else if(c<b){if(k+=l+c-b,(b-=c)<v){v-=b;do{x[a++]=u[k++]}while(--b);if(k=0,c<v){v-=b=c;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}}}else if(k+=c-b,b<v){v-=b;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}for(;v>2;)x[a++]=T[k++],x[a++]=T[k++],x[a++]=T[k++],v-=3;v&&(x[a++]=T[k++],v>1&&(x[a++]=T[k++]))}else{k=a-w;do{x[a++]=x[k++],x[a++]=x[k++],x[a++]=x[k++],v-=3}while(v>2);v&&(x[a++]=x[k++],v>1&&(x[a++]=x[k++]))}break}}break}}while(r<n&&a<o);r-=v=h>>3,d&=(1<<(h-=v<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=a<o?o-a+257:257-(a-o),S.hold=d,S.bits=h},MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=function(e,t,r,n,a,i,o,s){var l,f,c,u,d,h,p,m,g,y=s.bits,_=0,b=0,v=0,w=0,k=0,T=0,E=0,x=0,S=0,D=0,A=null,M=0,I=new Uint16Array(MAXBITS+1),R=new Uint16Array(MAXBITS+1),O=null,C=0;for(_=0;_<=MAXBITS;_++)I[_]=0;for(b=0;b<n;b++)I[t[r+b]]++;for(k=y,w=MAXBITS;w>=1&&0===I[w];w--);if(k>w&&(k=w),0===w)return a[i++]=20971520,a[i++]=20971520,s.bits=1,0;for(v=1;v<w&&0===I[v];v++);for(k<v&&(k=v),x=1,_=1;_<=MAXBITS;_++)if(x<<=1,(x-=I[_])<0)return-1;if(x>0&&(e===CODES$1||1!==w))return-1;for(R[1]=0,_=1;_<MAXBITS;_++)R[_+1]=R[_]+I[_];for(b=0;b<n;b++)0!==t[r+b]&&(o[R[t[r+b]]++]=b);if(e===CODES$1?(A=O=o,h=19):e===LENS$1?(A=lbase,M-=257,O=lext,C-=257,h=256):(A=dbase,O=dext,h=-1),D=0,b=0,_=v,d=i,T=k,E=0,c=-1,u=(S=1<<k)-1,e===LENS$1&&S>ENOUGH_LENS$1||e===DISTS$1&&S>ENOUGH_DISTS$1)return 1;for(;;){p=_-E,o[b]<h?(m=0,g=o[b]):o[b]>h?(m=O[C+o[b]],g=A[M+o[b]]):(m=96,g=0),l=1<<_-E,v=f=1<<T;do{a[d+(D>>E)+(f-=l)]=p<<24|m<<16|g|0}while(0!==f);for(l=1<<_-1;D&l;)l>>=1;if(0!==l?(D&=l-1,D+=l):D=0,b++,0==--I[_]){if(_===w)break;_=t[r+o[b]]}if(_>k&&(D&u)!==c){for(0===E&&(E=k),d+=v,x=1<<(T=_-E);T+E<w&&!((x-=I[T+E])<=0);)T++,x<<=1;if(S+=1<<T,e===LENS$1&&S>ENOUGH_LENS$1||e===DISTS$1&&S>ENOUGH_DISTS$1)return 1;a[c=D&u]=k<<24|T<<16|d-i|0}}return 0!==D&&(a[d+D]=_-E<<24|64<<16|0),s.bits=k,0},inftrees=inflate_table,CODES=0,LENS=1,DISTS=2,Z_FINISH$1=constants$2.Z_FINISH,Z_BLOCK=constants$2.Z_BLOCK,Z_TREES=constants$2.Z_TREES,Z_OK$1=constants$2.Z_OK,Z_STREAM_END$1=constants$2.Z_STREAM_END,Z_NEED_DICT$1=constants$2.Z_NEED_DICT,Z_STREAM_ERROR$1=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR$1=constants$2.Z_DATA_ERROR,Z_MEM_ERROR$1=constants$2.Z_MEM_ERROR,Z_BUF_ERROR=constants$2.Z_BUF_ERROR,Z_DEFLATED=constants$2.Z_DEFLATED,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var inflateResetKeep=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK$1},inflateReset=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)},inflateReset2=function(e,t){var r;if(!e||!e.state)return Z_STREAM_ERROR$1;var n=e.state;return t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,inflateReset(e))},inflateInit2=function(e,t){if(!e)return Z_STREAM_ERROR$1;var r=new InflateState;e.state=r,r.window=null;var n=inflateReset2(e,t);return n!==Z_OK$1&&(e.state=null),n},inflateInit=function(e){return inflateInit2(e,DEF_WBITS)},virgin=!0,lenfix,distfix,fixedtables=function(e){if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=function(e,t,r,n){var a,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):((a=i.wsize-i.wnext)>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),(n-=a)?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},inflate$2=function(e,t){var r,n,a,i,o,s,l,f,c,u,d,h,p,m,g,y,_,b,v,w,k,T,E,x,S=0,D=new Uint8Array(4),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;(r=e.state).mode===TYPE&&(r.mode=TYPEDO),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,f=r.hold,c=r.bits,u=s,d=l,T=Z_OK$1;e:for(;;)switch(r.mode){case HEAD:if(0===r.wrap){r.mode=TYPEDO;break}for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(2&r.wrap&&35615===f){r.check=0,D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0),f=0,c=0,r.mode=FLAGS;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=BAD;break}if((15&f)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(c-=4,k=8+(15&(f>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg="invalid window size",r.mode=BAD;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=512&f?DICTID:TYPE,f=0,c=0;break;case FLAGS:for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(r.flags=f,(255&r.flags)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=BAD;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0,r.mode=TIME;case TIME:for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.head&&(r.head.time=f),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,D[2]=f>>>16&255,D[3]=f>>>24&255,r.check=crc32_1(r.check,D,4,0)),f=0,c=0,r.mode=OS;case OS:for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0,r.mode=EXLEN;case EXLEN:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0}else r.head&&(r.head.extra=null);r.mode=EXTRA;case EXTRA:if(1024&r.flags&&((h=r.length)>s&&(h=s),h&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),k)),512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=NAME;case NAME:if(2048&r.flags){if(0===s)break e;h=0;do{k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&h<s);if(512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=COMMENT;case COMMENT:if(4096&r.flags){if(0===s)break e;h=0;do{k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&h<s);if(512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,k)break e}else r.head&&(r.head.comment=null);r.mode=HCRC;case HCRC:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f!==(65535&r.check)){e.msg="header crc mismatch",r.mode=BAD;break}f=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=TYPE;break;case DICTID:for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}e.adler=r.check=zswap32(f),f=0,c=0,r.mode=DICT;case DICT:if(0===r.havedict)return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,Z_NEED_DICT$1;e.adler=r.check=1,r.mode=TYPE;case TYPE:if(t===Z_BLOCK||t===Z_TREES)break e;case TYPEDO:if(r.last){f>>>=7&c,c-=7&c,r.mode=CHECK;break}for(;c<3;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}switch(r.last=1&f,c-=1,3&(f>>>=1)){case 0:r.mode=STORED;break;case 1:if(fixedtables(r),r.mode=LEN_,t===Z_TREES){f>>>=2,c-=2;break e}break;case 2:r.mode=TABLE;break;case 3:e.msg="invalid block type",r.mode=BAD}f>>>=2,c-=2;break;case STORED:for(f>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=BAD;break}if(r.length=65535&f,f=0,c=0,r.mode=COPY_,t===Z_TREES)break e;case COPY_:r.mode=COPY;case COPY:if(h=r.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break e;a.set(n.subarray(i,i+h),o),s-=h,i+=h,l-=h,o+=h,r.length-=h;break}r.mode=TYPE;break;case TABLE:for(;c<14;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(r.nlen=257+(31&f),f>>>=5,c-=5,r.ndist=1+(31&f),f>>>=5,c-=5,r.ncode=4+(15&f),f>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=BAD;break}r.have=0,r.mode=LENLENS;case LENLENS:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.lens[A[r.have++]]=7&f,f>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},T=inftrees(CODES,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,T){e.msg="invalid code lengths set",r.mode=BAD;break}r.have=0,r.mode=CODELENS;case CODELENS:for(;r.have<r.nlen+r.ndist;){for(;y=(S=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(_<16)f>>>=g,c-=g,r.lens[r.have++]=_;else{if(16===_){for(x=g+2;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=BAD;break}k=r.lens[r.have-1],h=3+(3&f),f>>>=2,c-=2}else if(17===_){for(x=g+3;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}c-=g,k=0,h=3+(7&(f>>>=g)),f>>>=3,c-=3}else{for(x=g+7;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}c-=g,k=0,h=11+(127&(f>>>=g)),f>>>=7,c-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=BAD;break}for(;h--;)r.lens[r.have++]=k}}if(r.mode===BAD)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=BAD;break}if(r.lenbits=9,E={bits:r.lenbits},T=inftrees(LENS,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,T){e.msg="invalid literal/lengths set",r.mode=BAD;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},T=inftrees(DISTS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,T){e.msg="invalid distances set",r.mode=BAD;break}if(r.mode=LEN_,t===Z_TREES)break e;case LEN_:r.mode=LEN;case LEN:if(s>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,inffast(e,d),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,f=r.hold,c=r.bits,r.mode===TYPE&&(r.back=-1);break}for(r.back=0;y=(S=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(y&&0==(240&y)){for(b=g,v=y,w=_;y=(S=r.lencode[w+((f&(1<<b+v)-1)>>b)])>>>16&255,_=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}f>>>=b,c-=b,r.back+=b}if(f>>>=g,c-=g,r.back+=g,r.length=_,0===y){r.mode=LIT;break}if(32&y){r.back=-1,r.mode=TYPE;break}if(64&y){e.msg="invalid literal/length code",r.mode=BAD;break}r.extra=15&y,r.mode=LENEXT;case LENEXT:if(r.extra){for(x=r.extra;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DIST;case DIST:for(;y=(S=r.distcode[f&(1<<r.distbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(0==(240&y)){for(b=g,v=y,w=_;y=(S=r.distcode[w+((f&(1<<b+v)-1)>>b)])>>>16&255,_=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}f>>>=b,c-=b,r.back+=b}if(f>>>=g,c-=g,r.back+=g,64&y){e.msg="invalid distance code",r.mode=BAD;break}r.offset=_,r.extra=15&y,r.mode=DISTEXT;case DISTEXT:if(r.extra){for(x=r.extra;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=BAD;break}r.mode=MATCH;case MATCH:if(0===l)break e;if(h=d-l,r.offset>h){if((h=r.offset-h)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=BAD;break}h>r.wnext?(h-=r.wnext,p=r.wsize-h):p=r.wnext-h,h>r.length&&(h=r.length),m=r.window}else m=a,p=o-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do{a[o++]=m[p++]}while(--h);0===r.length&&(r.mode=LEN);break;case LIT:if(0===l)break e;a[o++]=r.length,l--,r.mode=LEN;break;case CHECK:if(r.wrap){for(;c<32;){if(0===s)break e;s--,f|=n[i++]<<c,c+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?crc32_1(r.check,a,d,o-d):adler32_1(r.check,a,d,o-d)),d=l,(r.flags?f:zswap32(f))!==r.check){e.msg="incorrect data check",r.mode=BAD;break}f=0,c=0}r.mode=LENGTH;case LENGTH:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=BAD;break}f=0,c=0}r.mode=DONE;case DONE:T=Z_STREAM_END$1;break e;case BAD:T=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,(r.wsize||d!==e.avail_out&&r.mode<BAD&&(r.mode<CHECK||t!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,d-e.avail_out),u-=e.avail_in,d-=e.avail_out,e.total_in+=u,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?crc32_1(r.check,a,d,e.next_out-d):adler32_1(r.check,a,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===TYPE?128:0)+(r.mode===LEN_||r.mode===COPY_?256:0),(0===u&&0===d||t===Z_FINISH$1)&&T===Z_OK$1&&(T=Z_BUF_ERROR),T},inflateEnd=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$1},inflateGetHeader=function(e,t){if(!e||!e.state)return Z_STREAM_ERROR$1;var r=e.state;return 0==(2&r.wrap)?Z_STREAM_ERROR$1:(r.head=t,t.done=!1,Z_OK$1)},inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==DICT?Z_STREAM_ERROR$1:r.mode===DICT&&adler32_1(1,t,n,0)!==r.check?Z_DATA_ERROR$1:updatewindow(e,t,n,n)?(r.mode=MEM,Z_MEM_ERROR$1):(r.havedict=1,Z_OK$1):Z_STREAM_ERROR$1},inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo:inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader,toString=Object.prototype.toString,Z_NO_FLUSH=constants$2.Z_NO_FLUSH,Z_FINISH=constants$2.Z_FINISH,Z_OK=constants$2.Z_OK,Z_STREAM_END=constants$2.Z_STREAM_END,Z_NEED_DICT=constants$2.Z_NEED_DICT,Z_STREAM_ERROR=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR=constants$2.Z_DATA_ERROR,Z_MEM_ERROR=constants$2.Z_MEM_ERROR;function Inflate$1(e){this.options=common.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var r=inflate_1$2.inflateInit2(this.strm,t.windowBits);if(r!==Z_OK)throw new Error(messages[r]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=inflate_1$2.inflateSetDictionary(this.strm,t.dictionary))!==Z_OK))throw new Error(messages[r])}function inflate$1(e,t){var r=new Inflate$1(t);if(r.push(e),r.err)throw r.msg||messages[r.err];return r.result}function inflateRaw$1(e,t){return(t=t||{}).raw=!0,inflate$1(e,t)}Inflate$1.prototype.push=function(e,t){var r,n,a,i=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===toString.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(r=inflate_1$2.inflate(i,n))===Z_NEED_DICT&&s&&((r=inflate_1$2.inflateSetDictionary(i,s))===Z_OK?r=inflate_1$2.inflate(i,n):r===Z_DATA_ERROR&&(r=Z_NEED_DICT));i.avail_in>0&&r===Z_STREAM_END&&i.state.wrap>0&&0!==e[i.next_in];)inflate_1$2.inflateReset(i),r=inflate_1$2.inflate(i,n);switch(r){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(r),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||r===Z_STREAM_END))if("string"===this.options.to){var l=strings.utf8border(i.output,i.next_out),f=i.next_out-l,c=strings.buf2string(i.output,l);i.next_out=f,i.avail_out=o-f,f&&i.output.set(i.output.subarray(l,l+f),0),this.onData(c)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==Z_OK||0!==a){if(r===Z_STREAM_END)return r=inflate_1$2.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},Inflate$1.prototype.onData=function(e){this.chunks.push(e)},Inflate$1.prototype.onEnd=function(e){e===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants:constants},inflate=inflate_1$1.inflate,inflate_1=inflate,DeflateDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return inflate_1(new Uint8Array(e)).buffer}}]),r}(),deflate=Object.freeze({__proto__:null,default:DeflateDecoder}),PackbitsDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){for(var t=new DataView(e),r=[],n=0;n<e.byteLength;++n){var a=t.getInt8(n);if(a<0){var i=t.getUint8(n+1);a=-a;for(var o=0;o<=a;++o)r.push(i);n+=1}else{for(var s=0;s<=a;++s)r.push(t.getUint8(n+s+1));n+=a+1}}return new Uint8Array(r).buffer}}]),r}(),packbits=Object.freeze({__proto__:null,default:PackbitsDecoder}),LercDecode={exports:{}},module;module=LercDecode,
/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */
function(){var e,t,r,n,a,i,o,s,l,f,c,u,d,h,p,m,g=(e={defaultNoDataValue:-34027999387901484e22,decode:function(i,o){var s=(o=o||{}).encodedMaskData||null===o.encodedMaskData,l=a(i,o.inputOffset||0,s),f=null!==o.noDataValue?o.noDataValue:e.defaultNoDataValue,c=t(l,o.pixelType||Float32Array,o.encodedMaskData,f,o.returnMask),u={width:l.width,height:l.height,pixelData:c.resultPixels,minValue:c.minValue,maxValue:l.pixels.maxValue,noDataValue:f};return c.resultMask&&(u.maskData=c.resultMask),o.returnEncodedMask&&l.mask&&(u.encodedMaskData=l.mask.bitset?l.mask.bitset:null),o.returnFileInfo&&(u.fileInfo=r(l),o.computeUsedBitDepths&&(u.fileInfo.bitDepths=n(l))),u}},t=function(e,t,r,n,a){var o,s,l,f=0,c=e.pixels.numBlocksX,u=e.pixels.numBlocksY,d=Math.floor(e.width/c),h=Math.floor(e.height/u),p=2*e.maxZError,m=Number.MAX_VALUE;r=r||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),a&&r&&(l=new Uint8Array(e.width*e.height));for(var g,y,_=new Float32Array(d*h),b=0;b<=u;b++){var v=b!==u?h:e.height%u;if(0!==v)for(var w=0;w<=c;w++){var k=w!==c?d:e.width%c;if(0!==k){var T,E,x,S,D=b*e.width*h+w*d,A=e.width-k,M=e.pixels.blocks[f];if(M.encoding<2?(0===M.encoding?T=M.rawData:(i(M.stuffedData,M.bitsPerPixel,M.numValidPixels,M.offset,p,_,e.pixels.maxValue),T=_),E=0):x=2===M.encoding?0:M.offset,r)for(y=0;y<v;y++){for(7&D&&(S=r[D>>3],S<<=7&D),g=0;g<k;g++)7&D||(S=r[D>>3]),128&S?(l&&(l[D]=1),m=m>(o=M.encoding<2?T[E++]:x)?o:m,s[D++]=o):(l&&(l[D]=0),s[D++]=n),S<<=1;D+=A}else if(M.encoding<2)for(y=0;y<v;y++){for(g=0;g<k;g++)m=m>(o=T[E++])?o:m,s[D++]=o;D+=A}else for(m=m>x?x:m,y=0;y<v;y++){for(g=0;g<k;g++)s[D++]=x;D+=A}if(1===M.encoding&&E!==M.numValidPixels)throw"Block and Mask do not match";f++}}}return{resultPixels:s,resultMask:l,minValue:m}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},n=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var a=e.pixels.blocks[n];0===a.encoding?r.float32=!0:1===a.encoding?r[a.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},a=function(e,t,r){var n={},a=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,a),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var i=new DataView(e,t,24);if(n.fileVersion=i.getInt32(0,!0),n.imageType=i.getInt32(4,!0),n.height=i.getUint32(8,!0),n.width=i.getUint32(12,!0),n.maxZError=i.getFloat64(16,!0),t+=24,!r)if(i=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=i.getUint32(0,!0),n.mask.numBlocksX=i.getUint32(4,!0),n.mask.numBytes=i.getUint32(8,!0),n.mask.maxValue=i.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(i=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),l=2,f=0;do{if(s>0)for(;s--;)o[f++]=i.getUint8(l++);else{var c=i.getUint8(l++);for(s=-s;s--;)o[f++]=c}s=i.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==s||f<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));i=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=i.getUint32(0,!0),n.pixels.numBlocksX=i.getUint32(4,!0),n.pixels.numBytes=i.getUint32(8,!0),n.pixels.maxValue=i.getFloat32(12,!0),t+=16;var u=n.pixels.numBlocksX,d=n.pixels.numBlocksY,h=u+(n.width%u>0?1:0),p=d+(n.height%d>0?1:0);n.pixels.blocks=new Array(h*p);for(var m=0,g=0;g<p;g++)for(var y=0;y<h;y++){var _=0,b=e.byteLength-t;i=new DataView(e,t,Math.min(10,b));var v={};n.pixels.blocks[m++]=v;var w=i.getUint8(0);if(_++,v.encoding=63&w,v.encoding>3)throw"Invalid block encoding ("+v.encoding+")";if(2!==v.encoding){if(0!==w&&2!==w){if(w>>=6,v.offsetType=w,2===w)v.offset=i.getInt8(1),_++;else if(1===w)v.offset=i.getInt16(1,!0),_+=2;else{if(0!==w)throw"Invalid block offset type";v.offset=i.getFloat32(1,!0),_+=4}if(1===v.encoding)if(w=i.getUint8(_),_++,v.bitsPerPixel=63&w,w>>=6,v.numValidPixelsType=w,2===w)v.numValidPixels=i.getUint8(_),_++;else if(1===w)v.numValidPixels=i.getUint16(_,!0),_+=2;else{if(0!==w)throw"Invalid valid pixel count type";v.numValidPixels=i.getUint32(_,!0),_+=4}}var k;if(t+=_,3!==v.encoding)if(0===v.encoding){var T=(n.pixels.numBytes-1)/4;if(T!==Math.floor(T))throw"uncompressed block has invalid length";k=new ArrayBuffer(4*T),new Uint8Array(k).set(new Uint8Array(e,t,4*T));var E=new Float32Array(k);v.rawData=E,t+=4*T}else if(1===v.encoding){var x=Math.ceil(v.numValidPixels*v.bitsPerPixel/8),S=Math.ceil(x/4);k=new ArrayBuffer(4*S),new Uint8Array(k).set(new Uint8Array(e,t,x)),v.stuffedData=new Uint32Array(k),t+=x}}else t++}return n.eofOffset=t,n},i=function(e,t,r,n,a,i,o){var s,l,f,c=(1<<t)-1,u=0,d=0,h=Math.ceil((o-n)/a),p=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*p,s=0;s<r;s++){if(0===d&&(f=e[u++],d=32),d>=t)l=f>>>d-t&c,d-=t;else{var m=t-d;l=(f&c)<<m&c,l+=(f=e[u++])>>>(d=32-m)}i[s]=l<h?n+l*a:o}return i},e),y=(o=function(e,t,r,n,a,i,o,s){var l,f,c,u,d,h=(1<<r)-1,p=0,m=0,g=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*g,a)for(l=0;l<n;l++)0===m&&(c=e[p++],m=32),m>=r?(f=c>>>m-r&h,m-=r):(f=(c&h)<<(u=r-m)&h,f+=(c=e[p++])>>>(m=32-u)),t[l]=a[f];else for(d=Math.ceil((s-i)/o),l=0;l<n;l++)0===m&&(c=e[p++],m=32),m>=r?(f=c>>>m-r&h,m-=r):(f=(c&h)<<(u=r-m)&h,f+=(c=e[p++])>>>(m=32-u)),t[l]=f<d?i+f*o:s},s=function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,f=0,c=0,u=0,d=0,h=[],p=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*p;var m=Math.ceil((i-n)/a);for(f=0;f<r;f++)0===u&&(o=e[l++],u=32),u>=t?(d=o>>>u-t&s,u-=t):(d=(o&s)<<(c=t-u)&s,d+=(o=e[l++])>>>(u=32-c)),h[f]=d<m?n+d*a:i;return h.unshift(n),h},l=function(e,t,r,n,a,i,o,s){var l,f,c,u,d=(1<<r)-1,h=0,p=0,m=0;if(a)for(l=0;l<n;l++)0===p&&(c=e[h++],p=32,m=0),p>=r?(f=c>>>m&d,p-=r,m+=r):(f=c>>>m&d,p=32-(u=r-p),f|=((c=e[h++])&(1<<u)-1)<<r-u,m=u),t[l]=a[f];else{var g=Math.ceil((s-i)/o);for(l=0;l<n;l++)0===p&&(c=e[h++],p=32,m=0),p>=r?(f=c>>>m&d,p-=r,m+=r):(f=c>>>m&d,p=32-(u=r-p),f|=((c=e[h++])&(1<<u)-1)<<r-u,m=u),t[l]=f<g?i+f*o:s}return t},f=function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,f=0,c=0,u=0,d=0,h=0,p=[],m=Math.ceil((i-n)/a);for(f=0;f<r;f++)0===u&&(o=e[l++],u=32,h=0),u>=t?(d=o>>>h&s,u-=t,h+=t):(d=o>>>h&s,u=32-(c=t-u),d|=((o=e[l++])&(1<<c)-1)<<t-c,h=c),p[f]=d<m?n+d*a:i;return p.unshift(n),p},c=function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,f=0,c=0,u=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*u,a=0;a<n;a++)0===c&&(o=e[f++],c=32),c>=r?(i=o>>>c-r&l,c-=r):(i=(o&l)<<(s=r-c)&l,i+=(o=e[f++])>>>(c=32-s)),t[a]=i;return t},u=function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,f=0,c=0,u=0;for(a=0;a<n;a++)0===c&&(o=e[f++],c=32,u=0),c>=r?(i=o>>>u&l,c-=r,u+=r):(i=o>>>u&l,c=32-(s=r-c),i|=((o=e[f++])&(1<<s)-1)<<r-s,u=s),t[a]=i;return t},d={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,a=Math.floor(n/2),i=0;a;){var o=a>=359?359:a;a-=o;do{t+=e[i++]<<8,r+=t+=e[i++]}while(--o);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[i]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),a={};if(a.fileIdentifierString=String.fromCharCode.apply(null,n),0!==a.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;r+=6;var i,o=new DataView(e,r,8),s=o.getInt32(0,!0);if(a.fileVersion=s,r+=4,s>=3&&(a.checksum=o.getUint32(4,!0),r+=4),o=new DataView(e,r,12),a.height=o.getUint32(0,!0),a.width=o.getUint32(4,!0),r+=8,s>=4?(a.numDims=o.getUint32(8,!0),r+=4):a.numDims=1,o=new DataView(e,r,40),a.numValidPixel=o.getUint32(0,!0),a.microBlockSize=o.getInt32(4,!0),a.blobSize=o.getInt32(8,!0),a.imageType=o.getInt32(12,!0),a.maxZError=o.getFloat64(16,!0),a.zMin=o.getFloat64(24,!0),a.zMax=o.getFloat64(32,!0),r+=40,t.headerInfo=a,t.ptr=r,s>=3&&(i=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-i,a.blobSize-14))!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),a=r.numDims*this.getDataTypeSize(r.imageType),i=this.readSubArray(e,t.ptr,n,a),o=this.readSubArray(e,t.ptr+a,n,a);t.ptr+=2*a;var s,l=!0;for(s=0;s<r.numDims;s++)if(i[s]!==o[s]){l=!1;break}return r.minValues=i,r.maxValues=o,l},readSubArray:function(e,t,r,n){var a;if(r===Uint8Array)a=new Uint8Array(e,t,n);else{var i=new ArrayBuffer(n);new Uint8Array(i).set(new Uint8Array(e,t,n)),a=new r(i)}return a},readMask:function(e,t){var r,n,a=t.ptr,i=t.headerInfo,o=i.width*i.height,s=i.numValidPixel,l=new DataView(e,a,4),f={};if(f.numBytes=l.getUint32(0,!0),a+=4,(0===s||o===s)&&0!==f.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(o/8)),f.bitset=r,n=new Uint8Array(o),t.pixels.resultMask=n,a+=f.numBytes;else if(f.numBytes>0){r=new Uint8Array(Math.ceil(o/8));var c=(l=new DataView(e,a,f.numBytes)).getInt16(0,!0),u=2,d=0,h=0;do{if(c>0)for(;c--;)r[d++]=l.getUint8(u++);else for(h=l.getUint8(u++),c=-c;c--;)r[d++]=h;c=l.getInt16(u,!0),u+=2}while(u<f.numBytes);if(-32768!==c||d<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var p=0,m=0;for(m=0;m<o;m++)7&m?(p=r[m>>3],p<<=7&m):p=r[m>>3],128&p&&(n[m]=1);t.pixels.resultMask=n,f.bitset=r,a+=f.numBytes}return t.ptr=a,t.mask=f,!0},readDataOneSweep:function(e,t,r,n){var a,i=t.ptr,o=t.headerInfo,s=o.numDims,l=o.width*o.height,f=o.imageType,c=o.numValidPixel*d.getDataTypeSize(f)*s,u=t.pixels.resultMask;if(r===Uint8Array)a=new Uint8Array(e,i,c);else{var h=new ArrayBuffer(c);new Uint8Array(h).set(new Uint8Array(e,i,c)),a=new r(h)}if(a.length===l*s)t.pixels.resultPixels=n?d.swapDimensionOrder(a,l,s,r,!0):a;else{t.pixels.resultPixels=new r(l*s);var p=0,m=0,g=0,y=0;if(s>1){if(n){for(m=0;m<l;m++)if(u[m])for(y=m,g=0;g<s;g++,y+=l)t.pixels.resultPixels[y]=a[p++]}else for(m=0;m<l;m++)if(u[m])for(y=m*s,g=0;g<s;g++)t.pixels.resultPixels[y+g]=a[p++]}else for(m=0;m<l;m++)u[m]&&(t.pixels.resultPixels[m]=a[p++])}return i+=c,t.ptr=i,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var a=n.getInt32(4,!0),i=n.getInt32(8,!0),o=n.getInt32(12,!0);if(i>=o)return!1;var s=new Uint32Array(o-i);d.decodeBits(e,t,s);var l,f,c,u,p=[];for(l=i;l<o;l++)p[f=l-(l<a?0:a)]={first:s[l-i],second:null};var m=e.byteLength-t.ptr,g=Math.ceil(m/4),y=new ArrayBuffer(4*g);new Uint8Array(y).set(new Uint8Array(e,t.ptr,m));var _,b=new Uint32Array(y),v=0,w=0;for(_=b[0],l=i;l<o;l++)(u=p[f=l-(l<a?0:a)].first)>0&&(p[f].second=_<<v>>>32-u,32-v>=u?32===(v+=u)&&(v=0,_=b[++w]):(v+=u-32,_=b[++w],p[f].second|=_>>>32-v));var k=0,T=0,E=new h;for(l=0;l<p.length;l++)void 0!==p[l]&&(k=Math.max(k,p[l].first));T=k>=r?r:k;var x,S,D,A,M,I=[];for(l=i;l<o;l++)if((u=p[f=l-(l<a?0:a)].first)>0)if(x=[u,f],u<=T)for(S=p[f].second<<T-u,D=1<<T-u,c=0;c<D;c++)I[S|c]=x;else for(S=p[f].second,M=E,A=u-1;A>=0;A--)S>>>A&1?(M.right||(M.right=new h),M=M.right):(M.left||(M.left=new h),M=M.left),0!==A||M.val||(M.val=x[1]);return{decodeLut:I,numBitsLUTQick:T,numBitsLUT:k,tree:E,stuffedData:b,srcPtr:w,bitPos:v}},readHuffman:function(e,t,r,n){var a,i,o,s,l,f,c,u,h,p=t.headerInfo.numDims,m=t.headerInfo.height,g=t.headerInfo.width,y=g*m,_=this.readHuffmanTree(e,t),b=_.decodeLut,v=_.tree,w=_.stuffedData,k=_.srcPtr,T=_.bitPos,E=_.numBitsLUTQick,x=_.numBitsLUT,S=0===t.headerInfo.imageType?128:0,D=t.pixels.resultMask,A=0;T>0&&(k++,T=0);var M,I=w[k],R=1===t.encodeMode,O=new r(y*p),C=O;if(p<2||R){for(M=0;M<p;M++)if(p>1&&(C=new r(O.buffer,y*M,y),A=0),t.headerInfo.numValidPixel===g*m)for(u=0,f=0;f<m;f++)for(c=0;c<g;c++,u++){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,R?(o+=c>0?A:f>0?C[u-g]:A,o&=255,C[u]=o,A=o):C[u]=o}else for(u=0,f=0;f<m;f++)for(c=0;c<g;c++,u++)if(D[u]){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,R?(c>0&&D[u-1]?o+=A:f>0&&D[u-g]?o+=C[u-g]:o+=A,o&=255,C[u]=o,A=o):C[u]=o}}else for(u=0,f=0;f<m;f++)for(c=0;c<g;c++)if(u=f*g+c,!D||D[u])for(M=0;M<p;M++,u+=y){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,C[u]=o}t.ptr=t.ptr+4*(k+1)+(T>0?4:0),t.pixels.resultPixels=O,p>1&&!n&&(t.pixels.resultPixels=d.swapDimensionOrder(O,y,p,r))},decodeBits:function(e,t,r,n,a){var i=t.headerInfo,d=i.fileVersion,h=0,p=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,m=new DataView(e,t.ptr,p),g=m.getUint8(0);h++;var y=g>>6,_=0===y?4:3-y,b=(32&g)>0,v=31&g,w=0;if(1===_)w=m.getUint8(h),h++;else if(2===_)w=m.getUint16(h,!0),h+=2;else{if(4!==_)throw"Invalid valid pixel count type";w=m.getUint32(h,!0),h+=4}var k,T,E,x,S,D,A,M,I,R=2*i.maxZError,O=i.numDims>1?i.maxValues[a]:i.zMax;if(b){for(t.counter.lut++,M=m.getUint8(h),h++,x=Math.ceil((M-1)*v/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),E=new Uint8Array(T),t.ptr+=h,E.set(new Uint8Array(e,t.ptr,x)),A=new Uint32Array(T),t.ptr+=x,I=0;M-1>>>I;)I++;x=Math.ceil(w*I/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),(E=new Uint8Array(T)).set(new Uint8Array(e,t.ptr,x)),k=new Uint32Array(T),t.ptr+=x,D=d>=3?f(A,v,M-1,n,R,O):s(A,v,M-1,n,R,O),d>=3?l(k,r,I,w,D):o(k,r,I,w,D)}else t.counter.bitstuffer++,I=v,t.ptr+=h,I>0&&(x=Math.ceil(w*I/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),(E=new Uint8Array(T)).set(new Uint8Array(e,t.ptr,x)),k=new Uint32Array(T),t.ptr+=x,d>=3?null==n?u(k,r,I,w):l(k,r,I,w,!1,n,R,O):null==n?c(k,r,I,w):o(k,r,I,w,!1,n,R,O))},readTiles:function(e,t,r,n){var a=t.headerInfo,i=a.width,o=a.height,s=i*o,l=a.microBlockSize,f=a.imageType,c=d.getDataTypeSize(f),u=Math.ceil(i/l),h=Math.ceil(o/l);t.pixels.numBlocksY=h,t.pixels.numBlocksX=u,t.pixels.ptr=0;var p,m,g,y,_,b,v,w,k,T,E=0,x=0,S=0,D=0,A=0,M=0,I=0,R=0,O=0,C=0,P=0,L=0,U=0,B=0,$=0,N=new r(l*l),z=o%l||l,Z=i%l||l,G=a.numDims,j=t.pixels.resultMask,V=t.pixels.resultPixels,F=a.fileVersion>=5?14:15,K=a.zMax;for(S=0;S<h;S++)for(A=S!==h-1?l:z,D=0;D<u;D++)for(C=S*i*l+D*l,P=i-(M=D!==u-1?l:Z),w=0;w<G;w++){if(G>1?(T=V,C=S*i*l+D*l,V=new r(t.pixels.resultPixels.buffer,s*w*c,s),K=a.maxValues[w]):T=null,I=e.byteLength-t.ptr,m={},$=0,R=(p=new DataView(e,t.ptr,Math.min(10,I))).getUint8(0),$++,k=a.fileVersion>=5?4&R:0,O=R>>6&255,(R>>2&F)!=(D*l>>3&F))throw"integrity issue";if(k&&0===w)throw"integrity issue";if((_=3&R)>3)throw t.ptr+=$,"Invalid block encoding ("+_+")";if(2!==_)if(0===_){if(k)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=$,L=(L=A*M*c)<(U=e.byteLength-t.ptr)?L:U,g=new ArrayBuffer(L%c==0?L:L+c-L%c),new Uint8Array(g).set(new Uint8Array(e,t.ptr,L)),y=new r(g),B=0,j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=y[B++]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C++]=y[B++];C+=P}t.ptr+=B*c}else if(b=d.getDataTypeUsed(k&&f<6?4:f,O),v=d.getOnePixel(m,$,b,p),$+=d.getDataTypeSize(b),3===_)if(t.ptr+=$,t.counter.constantoffset++,j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=k?Math.min(K,T[C]+v):v),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C]=k?Math.min(K,T[C]+v):v,C++;C+=P}else if(t.ptr+=$,d.decodeBits(e,t,N,v,w),$=0,k)if(j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=N[$++]+T[C]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C]=N[$++]+T[C],C++;C+=P}else if(j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=N[$++]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C++]=N[$++];C+=P}else{if(k)if(j)for(E=0;E<A;E++)for(x=0;x<M;x++)j[C]&&(V[C]=T[C]),C++;else for(E=0;E<A;E++)for(x=0;x<M;x++)V[C]=T[C],C++;t.counter.constant++,t.ptr+=$}}G>1&&!n&&(t.pixels.resultPixels=d.swapDimensionOrder(t.pixels.resultPixels,s,G,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:d.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,a=e.headerInfo.maxValues,i=e.headerInfo.numDims,o=e.headerInfo.height*e.headerInfo.width,s=0,l=0,f=0,c=e.pixels.resultMask,u=e.pixels.resultPixels;if(c)if(i>1){if(t)for(s=0;s<i;s++)for(f=s*o,r=a[s],l=0;l<o;l++)c[l]&&(u[f+l]=r);else for(l=0;l<o;l++)if(c[l])for(f=l*i,s=0;s<i;s++)u[f+i]=a[s]}else for(l=0;l<o;l++)c[l]&&(u[l]=r);else if(i>1&&n!==r)if(t)for(s=0;s<i;s++)for(f=s*o,r=a[s],l=0;l<o;l++)u[f+l]=r;else for(l=0;l<o;l++)for(f=l*i,s=0;s<i;s++)u[f+s]=a[s];else for(l=0;l<o*i;l++)u[l]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=-17976931348623157e292&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var a=0;switch(r){case 0:a=n.getInt8(t);break;case 1:a=n.getUint8(t);break;case 2:a=n.getInt16(t,!0);break;case 3:a=n.getUint16(t,!0);break;case 4:a=n.getInt32(t,!0);break;case 5:a=n.getUInt32(t,!0);break;case 6:a=n.getFloat32(t,!0);break;case 7:a=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return a},swapDimensionOrder:function(e,t,r,n,a){var i=0,o=0,s=0,l=0,f=e;if(r>1)if(f=new n(t*r),a)for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)f[l]=e[o++];else for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)f[o++]=e[l];return f}},h=function(e,t,r){this.val=e,this.left=t,this.right=r},{decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,a={};a.ptr=t.inputOffset||0,a.pixels={},d.readHeaderInfo(e,a);var i=a.headerInfo,o=i.fileVersion,s=d.getDataTypeArray(i.imageType);if(o>5)throw"unsupported lerc version 2."+o;d.readMask(e,a),i.numValidPixel===i.width*i.height||a.pixels.resultMask||(a.pixels.resultMask=t.maskData);var l=i.width*i.height;a.pixels.resultPixels=new s(l*i.numDims),a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var f,c=!t.returnPixelInterleavedDims;if(0!==i.numValidPixel)if(i.zMax===i.zMin)d.constructConstantSurface(a,c);else if(o>=4&&d.checkMinMaxRanges(e,a))d.constructConstantSurface(a,c);else{var u=new DataView(e,a.ptr,2),h=u.getUint8(0);if(a.ptr++,h)d.readDataOneSweep(e,a,s,c);else if(o>1&&i.imageType<=1&&Math.abs(i.maxZError-.5)<1e-5){var p=u.getUint8(1);if(a.ptr++,a.encodeMode=p,p>2||o<4&&p>1)throw"Invalid Huffman flag "+p;p?d.readHuffman(e,a,s,c):d.readTiles(e,a,s,c)}else d.readTiles(e,a,s,c)}a.eofOffset=a.ptr,t.inputOffset?(f=a.headerInfo.blobSize+t.inputOffset-a.ptr,Math.abs(f)>=1&&(a.eofOffset=t.inputOffset+a.headerInfo.blobSize)):(f=a.headerInfo.blobSize-a.ptr,Math.abs(f)>=1&&(a.eofOffset=a.headerInfo.blobSize));var m={width:i.width,height:i.height,pixelData:a.pixels.resultPixels,minValue:i.zMin,maxValue:i.zMax,validPixelCount:i.numValidPixel,dimCount:i.numDims,dimStats:{minValues:i.minValues,maxValues:i.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&d.isValidPixelValue(i.imageType,r)){var g=a.pixels.resultMask;for(n=0;n<l;n++)g[n]||(m.pixelData[n]=r);m.noDataValue=r}return a.noDataValue=r,t.returnFileInfo&&(m.fileInfo=d.formatFileInfo(a)),m},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)d.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}}),_=(p=new ArrayBuffer(4),m=new Uint8Array(p),new Uint32Array(p)[0]=1,1===m[0]),b={decode:function(e,t){if(!_)throw"Big endian system is not supported.";var r,n,a=(t=t||{}).inputOffset||0,i=new Uint8Array(e,a,10),o=String.fromCharCode.apply(null,i);if("CntZImage"===o.trim())r=g,n=1;else{if("Lerc2"!==o.substring(0,5))throw"Unexpected file identifier string: "+o;r=y,n=2}for(var s,l,f,c,u,d,h=0,p=e.byteLength-10,m=[],b={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]},v=0;a<p;){var w=r.decode(e,{inputOffset:a,encodedMaskData:s,maskData:f,returnMask:0===h,returnEncodedMask:0===h,returnFileInfo:!0,returnPixelInterleavedDims:t.returnPixelInterleavedDims,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});a=w.fileInfo.eofOffset,f=w.maskData,0===h&&(s=w.encodedMaskData,b.width=w.width,b.height=w.height,b.dimCount=w.dimCount||1,b.pixelType=w.pixelType||w.fileInfo.pixelType,b.mask=f),n>1&&(f&&m.push(f),w.fileInfo.mask&&w.fileInfo.mask.numBytes>0&&v++),h++,b.pixels.push(w.pixelData),b.statistics.push({minValue:w.minValue,maxValue:w.maxValue,noDataValue:w.noDataValue,dimStats:w.dimStats})}if(n>1&&v>1){for(d=b.width*b.height,b.bandMasks=m,(f=new Uint8Array(d)).set(m[0]),c=1;c<m.length;c++)for(l=m[c],u=0;u<d;u++)f[u]=f[u]&l[u];b.maskData=f}return b}};module.exports?module.exports=b:this.Lerc=b}();var Lerc=LercDecode.exports,fieldTagNames={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},fieldTags={};for(var key in fieldTagNames)fieldTagNames.hasOwnProperty(key)&&(fieldTags[fieldTagNames[key]]=parseInt(key,10));fieldTags.BitsPerSample,fieldTags.ExtraSamples,fieldTags.SampleFormat,fieldTags.StripByteCounts,fieldTags.StripOffsets,fieldTags.StripRowCounts,fieldTags.TileByteCounts,fieldTags.TileOffsets,fieldTags.SubIFDs;var fieldTypeNames={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},fieldTypes={};for(var _key in fieldTypeNames)fieldTypeNames.hasOwnProperty(_key)&&(fieldTypes[fieldTypeNames[_key]]=parseInt(_key,10));var LercParameters={Version:0,AddCompression:1},LercAddCompression={None:0,Deflate:1},geoKeyNames={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},geoKeys={};for(var _key2 in geoKeyNames)geoKeyNames.hasOwnProperty(_key2)&&(geoKeys[geoKeyNames[_key2]]=parseInt(_key2,10));var LercDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).planarConfiguration=void 0!==e.PlanarConfiguration?e.PlanarConfiguration:1,n.samplesPerPixel=void 0!==e.SamplesPerPixel?e.SamplesPerPixel:1,n.addCompression=e.LercParameters[LercParameters.AddCompression],n}return _createClass(r,[{key:"decodeBlock",value:function(e){switch(this.addCompression){case LercAddCompression.None:break;case LercAddCompression.Deflate:e=inflate_1(new Uint8Array(e)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return Lerc.decode(e,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}]),r}(),lerc=Object.freeze({__proto__:null,default:LercDecoder});`;return new Worker(typeof Blob=="undefined"?"data:application/javascript;base64,"+Buffer.from(r,"binary").toString("base64"):URL.createObjectURL(new Blob([r],{type:"application/javascript"})))}var JE=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Uh="STATISTICS_MAXIMUM",Gh="STATISTICS_MINIMUM",il;function ex(){return il||(il=new EE(void 0,QE())),il}function tx(r){try{return r.getBoundingBox()}catch{var t=r.fileDirectory;return[0,0,t.ImageWidth,t.ImageLength]}}function rx(r){try{return r.getOrigin().slice(0,2)}catch{return[0,r.fileDirectory.ImageLength]}}function nx(r,t){try{return r.getResolution(t)[0]}catch{return t.fileDirectory.ImageWidth/r.fileDirectory.ImageWidth}}function ix(r){var t=r.geoKeys;if(!t)return null;if(t.ProjectedCSTypeGeoKey){var e="EPSG:"+t.ProjectedCSTypeGeoKey,n=Ue(e);if(!n){var i=yc(t.ProjLinearUnitsGeoKey);i&&(n=new co({code:e,units:i}))}return n}if(t.GeographicTypeGeoKey){var e="EPSG:"+t.GeographicTypeGeoKey,n=Ue(e);if(!n){var i=yc(t.GeogAngularUnitsGeoKey);i&&(n=new co({code:e,units:i}))}return n}return null}function ox(r){return r.getImageCount().then(function(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=r.getImage(n);return Promise.all(e)})}function ax(r){var t;return r.overviews?t=qE(r.url,r.overviews):t=YE(r.url),t.then(ox)}function Go(r,t,e,n,i){if(Array.isArray(r)){var o=r.length;if(!Array.isArray(t)||o!=t.length){var a=new Error(n);throw i(a),a}for(var s=0;s<o;++s)Go(r[s],t[s],e,n,i);return}if(t=t,Math.abs(r-t)>e*r)throw new Error(n)}function sx(r){return r instanceof Int8Array?-128:r instanceof Int16Array?-32768:r instanceof Int32Array?-2147483648:r instanceof Float32Array?12e-39:0}function lx(r){return r instanceof Int8Array?127:r instanceof Uint8Array||r instanceof Uint8ClampedArray?255:r instanceof Int16Array?32767:r instanceof Uint16Array?65535:r instanceof Int32Array?2147483647:r instanceof Uint32Array?4294967295:r instanceof Float32Array?34e37:255}var jh=function(r){JE(t,r);function t(e){var n=r.call(this,{state:Dt.LOADING,tileGrid:null,projection:null,opaque:e.opaque,transition:e.transition,interpolate:e.interpolate!==!1,wrapX:e.wrapX})||this;n.sourceInfo_=e.sources;var i=n.sourceInfo_.length;n.sourceImagery_=new Array(i),n.resolutionFactors_=new Array(i),n.samplesPerPixel_,n.nodataValues_,n.metadata_,n.normalize_=e.normalize!==!1,n.addAlpha_=!1,n.error_=null,n.readMethod_=e.convertToRGB?"readRGB":"readRasters",n.setKey(n.sourceInfo_.map(function(l){return l.url}).join(","));for(var o=n,a=new Array(i),s=0;s<i;++s)a[s]=ax(n.sourceInfo_[s]);return Promise.all(a).then(function(l){o.configure_(l)}).catch(function(l){console.error(l),o.error_=l,o.setState(Dt.ERROR)}),n}return t.prototype.getError=function(){return this.error_},t.prototype.configure_=function(e){for(var n,i,o,a,s=new Array(e.length),l=new Array(e.length),u=new Array(e.length),c=0,f=e.length,h=function(N){var j=e[N],W=j.length,ne=void 0,se=void 0,V=new Array(W),G=new Array(W);l[N]=new Array(W),u[N]=new Array(W);for(var F=0;F<W;++F){var U=j[F],oe=U.getGDALNoData();u[N][F]=U.getGDALMetadata(),l[N][F]=oe===null?NaN:oe;var me=d.sourceInfo_[N].bands;s[N]=me?me.length:U.getSamplesPerPixel();var Ie=W-(F+1);ne||(ne=tx(U)),se||(se=rx(U)),G[Ie]=nx(U,j[0]),V[Ie]=[U.getTileWidth(),U.getTileHeight()]}if(n?ir(n,ne,n):n=ne,!i)i=se;else{var Y="Origin mismatch for source "+N+", got ["+se+"] but expected ["+i+"]";Go(i,se,0,Y,d.viewRejector)}if(!a)a=G,d.resolutionFactors_[N]=1;else{a.length-c>G.length&&(c=a.length-G.length);var xe=a[a.length-1]/G[G.length-1];d.resolutionFactors_[N]=xe;var J=G.map(function(Te){return Te*=xe}),Y="Resolution mismatch for source "+N+", got ["+J+"] but expected ["+a+"]";Go(a.slice(c,a.length),J,.005,Y,d.viewRejector)}o?Go(o.slice(c,o.length),V,0,"Tile size mismatch for source "+N,d.viewRejector):o=V,d.sourceImagery_[N]=j.reverse()},d=this,p=0;p<f;++p)h(p);for(var g=0,_=this.sourceImagery_.length;g<_;++g)for(var x=this.sourceImagery_[g];x.length<a.length;)x.unshift(void 0);if(!this.getProjection())for(var T=e[0],g=T.length-1;g>=0;--g){var E=T[g],y=ix(E);if(y){this.projection=y;break}}this.samplesPerPixel_=s,this.nodataValues_=l,this.metadata_=u;e:for(var p=0;p<f;++p){if(this.sourceInfo_[p].nodata!==void 0){this.addAlpha_=!0;break}var w=l[p],O=this.sourceInfo_[p].bands;if(O){for(var g=0;g<O.length;++g)if(!isNaN(w[O[g]-1])){this.addAlpha_=!0;break e}continue}for(var S=0;S<w.length;++S)if(!isNaN(w[S])){this.addAlpha_=!0;break e}}var P=this.addAlpha_?1:0;this.bandCount=s.reduce(function(N,j){return N+=j,N},0)+P;var L=new xo({extent:n,minZoom:c,origin:i,resolutions:a,tileSizes:o});this.tileGrid=L,this.setLoader(this.loadTile_.bind(this)),this.setState(Dt.READY),this.viewResolver({projection:this.projection,resolutions:a,center:po(en(n),this.projection),extent:Rc(n,this.projection),zoom:0})},t.prototype.loadTile_=function(e,n,i){for(var o=bt(this.tileGrid.getTileSize(e)),a=this.sourceImagery_.length,s=new Array(a),l=this.addAlpha_,u=this.bandCount,c=this.samplesPerPixel_,f=this.nodataValues_,h=this.sourceInfo_,d=function(y){var w=h[y],O=p.resolutionFactors_[y],S=[Math.round(n*(o[0]*O)),Math.round(i*(o[1]*O)),Math.round((n+1)*(o[0]*O)),Math.round((i+1)*(o[1]*O))],P=p.sourceImagery_[y][e],L=void 0;w.bands&&(L=w.bands.map(function(j){return j-1}));var N=void 0;isNaN(w.nodata)?L?N=L.map(function(j){return f[y][j]}):N=f[y]:N=w.nodata,s[y]=P[p.readMethod_]({window:S,width:o[0],height:o[1],samples:L,fillValue:N,pool:ex(),interleave:!1})},p=this,g=0;g<a;++g)d(g);var _=o[0]*o[1],x=_*u,T=this.normalize_,E=this.metadata_;return Promise.all(s).then(function(y){var w;T?w=new Uint8Array(x):w=new Float32Array(x);for(var O=0,S=0;S<_;++S){for(var P=l,L=0;L<a;++L){var N=h[L],j=N.min,W=N.max,ne=void 0,se=void 0;if(T){var V=E[L][0];j===void 0&&(V&&Gh in V?j=parseFloat(V[Gh]):j=sx(y[L][0])),W===void 0&&(V&&Uh in V?W=parseFloat(V[Uh]):W=lx(y[L][0])),ne=255/(W-j),se=-j*ne}for(var G=0;G<c[L];++G){var F=y[L][G][S],U=void 0;if(T?U=Fe(ne*F+se,0,255):U=F,!l)w[O]=U;else{var oe=N.nodata;if(oe===void 0){var me=void 0;N.bands?me=N.bands[G]-1:me=G,oe=f[L][me]}F!==oe&&(P=!1,w[O]=U)}O++}}l&&(P||(w[O]=255),O++)}return w})},t}(d1);jh.prototype.getView;var nw=jh;function Bh(r,t){var e=[];Object.keys(t).forEach(function(i){t[i]!==null&&t[i]!==void 0&&e.push(i+"="+encodeURIComponent(t[i]))});var n=e.join("&");return r=r.replace(/[?&]$/,""),r=r.indexOf("?")===-1?r+"?":r+"&",r+n}var hr={KVP:"KVP",REST:"REST"},ux=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),cx=function(r){ux(t,r);function t(e){var n=r.call(this,{extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes})||this;return n.matrixIds_=e.matrixIds,n}return t.prototype.getMatrixId=function(e){return this.matrixIds_[e]},t.prototype.getMatrixIds=function(){return this.matrixIds_},t}(xo);function fx(r,t,e){var n=[],i=[],o=[],a=[],s=[],l=e!==void 0?e:[],u="SupportedCRS",c="TileMatrix",f="Identifier",h="ScaleDenominator",d="TopLeftCorner",p="TileWidth",g="TileHeight",_=r[u],x=Ue(_),T=x.getMetersPerUnit(),E=x.getAxisOrientation().substr(0,2)=="ne";return r[c].sort(function(y,w){return w[h]-y[h]}),r[c].forEach(function(y){var w;if(l.length>0?w=Qr(l,function(L){return y[f]==L[c]?!0:y[f].indexOf(":")===-1?r[f]+":"+y[f]===L[c]:!1}):w=!0,w){i.push(y[f]);var O=y[h]*28e-5/T,S=y[p],P=y[g];E?o.push([y[d][1],y[d][0]]):o.push(y[d]),n.push(O),a.push(S==P?S:[S,P]),s.push([y.MatrixWidth,y.MatrixHeight])}}),new cx({extent:t,origins:o,resolutions:n,matrixIds:i,tileSizes:a,sizes:s})}var hx=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),dx=function(r){hx(t,r);function t(e){var n=this,i=e.imageSmoothing!==void 0?e.imageSmoothing:!0;e.interpolate!==void 0&&(i=e.interpolate);var o=e.requestEncoding!==void 0?e.requestEncoding:hr.KVP,a=e.tileGrid,s=e.urls;return s===void 0&&e.url!==void 0&&(s=bf(e.url)),n=r.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:i,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:a,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:s,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection})||this,n.version_=e.version!==void 0?e.version:"1.0.0",n.format_=e.format!==void 0?e.format:"image/jpeg",n.dimensions_=e.dimensions!==void 0?e.dimensions:{},n.layer_=e.layer,n.matrixSet_=e.matrixSet,n.style_=e.style,n.requestEncoding_=o,n.setKey(n.getKeyForDimensions_()),s&&s.length>0&&(n.tileUrlFunction=Cs(s.map(n.createFromWMTSTemplate.bind(n)))),n}return t.prototype.setUrls=function(e){this.urls=e;var n=e.join(`
`);this.setTileUrlFunction(Cs(e.map(this.createFromWMTSTemplate.bind(this))),n)},t.prototype.getDimensions=function(){return this.dimensions_},t.prototype.getFormat=function(){return this.format_},t.prototype.getLayer=function(){return this.layer_},t.prototype.getMatrixSet=function(){return this.matrixSet_},t.prototype.getRequestEncoding=function(){return this.requestEncoding_},t.prototype.getStyle=function(){return this.style_},t.prototype.getVersion=function(){return this.version_},t.prototype.getKeyForDimensions_=function(){var e=0,n=[];for(var i in this.dimensions_)n[e++]=i+"-"+this.dimensions_[i];return n.join("/")},t.prototype.updateDimensions=function(e){Pe(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())},t.prototype.createFromWMTSTemplate=function(e){var n=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};n==hr.KVP&&Pe(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=n==hr.KVP?Bh(e,i):e.replace(/\{(\w+?)\}/g,function(s,l){return l.toLowerCase()in i?i[l.toLowerCase()]:s});var o=this.tileGrid,a=this.dimensions_;return function(s,l,u){if(s){var c={TileMatrix:o.getMatrixId(s[0]),TileCol:s[1],TileRow:s[2]};Pe(c,a);var f=e;return n==hr.KVP?f=Bh(f,c):f=f.replace(/\{(\w+?)\}/g,function(h,d){return c[d]}),f}else return}},t}(Bm),iw=dx;function ow(r,t){var e=r.Contents.Layer,n=Qr(e,function(Y,xe,J){return Y.Identifier==t.layer});if(n===null)return null;var i=r.Contents.TileMatrixSet,o;n.TileMatrixSetLink.length>1?"projection"in t?o=Fa(n.TileMatrixSetLink,function(Y,xe,J){var be=Qr(i,function(de){return de.Identifier==Y.TileMatrixSet}),Te=be.SupportedCRS,Ce=Ue(Te),Oe=Ue(t.projection);return Ce&&Oe?ur(Ce,Oe):Te==t.projection}):o=Fa(n.TileMatrixSetLink,function(Y,xe,J){return Y.TileMatrixSet==t.matrixSet}):o=0,o<0&&(o=0);var a=n.TileMatrixSetLink[o].TileMatrixSet,s=n.TileMatrixSetLink[o].TileMatrixSetLimits,l=n.Format[0];"format"in t&&(l=t.format),o=Fa(n.Style,function(Y,xe,J){return"style"in t?Y.Title==t.style:Y.isDefault}),o<0&&(o=0);var u=n.Style[o].Identifier,c={};"Dimension"in n&&n.Dimension.forEach(function(Y,xe,J){var be=Y.Identifier,Te=Y.Default;Te===void 0&&(Te=Y.Value[0]),c[be]=Te});var f=r.Contents.TileMatrixSet,h=Qr(f,function(Y,xe,J){return Y.Identifier==a}),d,p=h.SupportedCRS;if(p&&(d=Ue(p)),"projection"in t){var g=Ue(t.projection);g&&(!d||ur(g,d))&&(d=g)}var _=!1,x=d.getAxisOrientation().substr(0,2)=="ne",T=h.TileMatrix[0],E={MinTileCol:0,MinTileRow:0,MaxTileCol:T.MatrixWidth-1,MaxTileRow:T.MatrixHeight-1};if(s){E=s[s.length-1];var y=Qr(h.TileMatrix,function(Y){return Y.Identifier===E.TileMatrix||h.Identifier+":"+Y.Identifier===E.TileMatrix});y&&(T=y)}var w=T.ScaleDenominator*28e-5/d.getMetersPerUnit(),O=x?[T.TopLeftCorner[1],T.TopLeftCorner[0]]:T.TopLeftCorner,S=T.TileWidth*w,P=T.TileHeight*w,L=h.BoundingBox,N=[O[0]+S*E.MinTileCol,O[1]-P*(1+E.MaxTileRow),O[0]+S*(1+E.MaxTileCol),O[1]-P*E.MinTileRow];if(L!==void 0&&!Wu(L,N)){var j=n.WGS84BoundingBox,W=Ue("EPSG:4326").getExtent();if(N=L,j)_=j[0]===W[0]&&j[2]===W[2];else{var ne=T_(L,h.SupportedCRS,"EPSG:4326");_=ne[0]-1e-10<=W[0]&&ne[2]+1e-10>=W[2]}}var se=fx(h,N,s),V=[],G=t.requestEncoding;if(G=G!==void 0?G:"","OperationsMetadata"in r&&"GetTile"in r.OperationsMetadata)for(var F=r.OperationsMetadata.GetTile.DCP.HTTP.Get,U=0,oe=F.length;U<oe;++U)if(F[U].Constraint){var me=Qr(F[U].Constraint,function(Y){return Y.name=="GetEncoding"}),Ie=me.AllowedValues.Value;if(G===""&&(G=Ie[0]),G===hr.KVP)Ag(Ie,hr.KVP)&&V.push(F[U].href);else break}else F[U].href&&(G=hr.KVP,V.push(F[U].href));return V.length===0&&(G=hr.REST,n.ResourceURL.forEach(function(Y){Y.resourceType==="tile"&&(l=Y.format,V.push(Y.template))})),{urls:V,layer:t.layer,matrixSet:a,format:l,projection:d,requestEncoding:G,tileGrid:se,style:u,dimensions:c,wrapX:_,crossOrigin:t.crossOrigin}}function ol(r,t){return $h(r,t,[]).join("")}function $h(r,t,e){if(r.nodeType==Node.CDATA_SECTION_NODE||r.nodeType==Node.TEXT_NODE)t?e.push(String(r.nodeValue).replace(/(\r\n|\r|\n)/g,"")):e.push(r.nodeValue);else{var n=void 0;for(n=r.firstChild;n;n=n.nextSibling)$h(n,t,e)}return e}function px(r){return"documentElement"in r}function gx(r){return new DOMParser().parseFromString(r,"application/xml")}function al(r,t){return function(e,n){var i=r.call(t!==void 0?t:this,e,n);if(i!==void 0){var o=n[n.length-1];o.push(i)}}}function ut(r,t,e){return function(n,i){var o=r.call(e!==void 0?e:this,n,i);if(o!==void 0){var a=i[i.length-1],s=t!==void 0?t:n.localName,l=void 0;s in a?l=a[s]:(l=[],a[s]=l),l.push(o)}}}function Z(r,t,e){return function(n,i){var o=r.call(e!==void 0?e:this,n,i);if(o!==void 0){var a=i[i.length-1],s=t!==void 0?t:n.localName;a[s]=o}}}function ge(r,t,e){var n=e!==void 0?e:{},i,o;for(i=0,o=r.length;i<o;++i)n[r[i]]=t;return n}function vx(r,t,e,n){var i;for(i=t.firstElementChild;i;i=i.nextElementSibling){var o=r[i.namespaceURI];if(o!==void 0){var a=o[i.localName];a!==void 0&&a.call(n,i,e)}}}function Ae(r,t,e,n,i){return n.push(r),vx(t,e,n,i),n.pop()}var _x=function(){function r(){}return r.prototype.read=function(t){if(t)if(typeof t=="string"){var e=gx(t);return this.readFromDocument(e)}else return px(t)?this.readFromDocument(t):this.readFromNode(t);else return null},r.prototype.readFromDocument=function(t){for(var e=t.firstChild;e;e=e.nextSibling)if(e.nodeType==Node.ELEMENT_NODE)return this.readFromNode(e);return null},r.prototype.readFromNode=function(t){},r}(),zh=_x,yx="http://www.w3.org/1999/xlink";function sl(r){return r.getAttributeNS(yx,"href")}function mx(r){var t=ol(r,!1);return Tx(t)}function Tx(r){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(r);if(t)return parseFloat(t[1])}function dr(r){var t=ol(r,!1);return Ex(t)}function Ex(r){var t=/^\s*(\d+)\s*$/.exec(r);if(t)return parseInt(t[1],10)}function le(r){return ol(r,!1).trim()}var xx=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),rt=[null,"http://www.opengis.net/ows/1.1"],bx=ge(rt,{ServiceIdentification:Z(Zx),ServiceProvider:Z(Yx),OperationsMetadata:Z(Xx)}),wx=function(r){xx(t,r);function t(){return r.call(this)||this}return t.prototype.readFromNode=function(e){var n=Ae({},bx,e,[]);return n||null},t}(zh),Cx=ge(rt,{DeliveryPoint:Z(le),City:Z(le),AdministrativeArea:Z(le),PostalCode:Z(le),Country:Z(le),ElectronicMailAddress:Z(le)}),Rx=ge(rt,{Value:ut(qx)}),Sx=ge(rt,{AllowedValues:Z(Gx)}),Ax=ge(rt,{Phone:Z(Hx),Address:Z(Ux)}),Ox=ge(rt,{HTTP:Z(Kx)}),Px=ge(rt,{Get:ut(zx),Post:void 0}),Ix=ge(rt,{DCP:Z($x)}),Mx=ge(rt,{Operation:Vx}),Dx=ge(rt,{Voice:Z(le),Facsimile:Z(le)}),Lx=ge(rt,{Constraint:ut(jx)}),kx=ge(rt,{IndividualName:Z(le),PositionName:Z(le),ContactInfo:Z(Bx)}),Nx=ge(rt,{Abstract:Z(le),AccessConstraints:Z(le),Fees:Z(le),Title:Z(le),ServiceTypeVersion:Z(le),ServiceType:Z(le)}),Fx=ge(rt,{ProviderName:Z(le),ProviderSite:Z(sl),ServiceContact:Z(Wx)});function Ux(r,t){return Ae({},Cx,r,t)}function Gx(r,t){return Ae({},Rx,r,t)}function jx(r,t){var e=r.getAttribute("name");if(!!e)return Ae({name:e},Sx,r,t)}function Bx(r,t){return Ae({},Ax,r,t)}function $x(r,t){return Ae({},Ox,r,t)}function zx(r,t){var e=sl(r);if(!!e)return Ae({href:e},Lx,r,t)}function Kx(r,t){return Ae({},Px,r,t)}function Vx(r,t){var e=r.getAttribute("name"),n=Ae({},Ix,r,t);if(!!n){var i=t[t.length-1];i[e]=n}}function Xx(r,t){return Ae({},Mx,r,t)}function Hx(r,t){return Ae({},Dx,r,t)}function Zx(r,t){return Ae({},Nx,r,t)}function Wx(r,t){return Ae({},kx,r,t)}function Yx(r,t){return Ae({},Fx,r,t)}function qx(r,t){return le(r)}var Qx=wx,Jx=globalThis&&globalThis.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Gt=[null,"http://www.opengis.net/wmts/1.0"],Rn=[null,"http://www.opengis.net/ows/1.1"],eb=ge(Gt,{Contents:Z(hb)}),tb=function(r){Jx(t,r);function t(){var e=r.call(this)||this;return e.owsParser_=new Qx,e}return t.prototype.readFromNode=function(e){var n=e.getAttribute("version");n&&(n=n.trim());var i=this.owsParser_.readFromNode(e);return i?(i.version=n,i=Ae(i,eb,e,[]),i||null):null},t}(zh),rb=ge(Gt,{Layer:ut(db),TileMatrixSet:ut(pb)}),nb=ge(Gt,{Style:ut(gb),Format:ut(le),TileMatrixSetLink:ut(vb),Dimension:ut(_b),ResourceURL:ut(yb)},ge(Rn,{Title:Z(le),Abstract:Z(le),WGS84BoundingBox:Z(Kh),Identifier:Z(le)})),ib=ge(Gt,{LegendURL:ut(mb)},ge(Rn,{Title:Z(le),Identifier:Z(le)})),ob=ge(Gt,{TileMatrixSet:Z(le),TileMatrixSetLimits:Z(Eb)}),ab=ge(Gt,{TileMatrixLimits:al(xb)}),sb=ge(Gt,{TileMatrix:Z(le),MinTileRow:Z(dr),MaxTileRow:Z(dr),MinTileCol:Z(dr),MaxTileCol:Z(dr)}),lb=ge(Gt,{Default:Z(le),Value:ut(le)},ge(Rn,{Identifier:Z(le)})),ub=ge(Rn,{LowerCorner:al(ll),UpperCorner:al(ll)}),cb=ge(Gt,{WellKnownScaleSet:Z(le),TileMatrix:ut(Tb)},ge(Rn,{SupportedCRS:Z(le),Identifier:Z(le),BoundingBox:Z(Kh)})),fb=ge(Gt,{TopLeftCorner:Z(ll),ScaleDenominator:Z(mx),TileWidth:Z(dr),TileHeight:Z(dr),MatrixWidth:Z(dr),MatrixHeight:Z(dr)},ge(Rn,{Identifier:Z(le)}));function hb(r,t){return Ae({},rb,r,t)}function db(r,t){return Ae({},nb,r,t)}function pb(r,t){return Ae({},cb,r,t)}function gb(r,t){var e=Ae({},ib,r,t);if(!!e){var n=r.getAttribute("isDefault")==="true";return e.isDefault=n,e}}function vb(r,t){return Ae({},ob,r,t)}function _b(r,t){return Ae({},lb,r,t)}function yb(r,t){var e=r.getAttribute("format"),n=r.getAttribute("template"),i=r.getAttribute("resourceType"),o={};return e&&(o.format=e),n&&(o.template=n),i&&(o.resourceType=i),o}function Kh(r,t){var e=Ae([],ub,r,t);if(e.length==2)return ja(e)}function mb(r,t){var e={};return e.format=r.getAttribute("format"),e.href=sl(r),e}function ll(r,t){var e=le(r).split(/\s+/);if(!(!e||e.length!=2)){var n=+e[0],i=+e[1];if(!(isNaN(n)||isNaN(i)))return[n,i]}}function Tb(r,t){return Ae({},fb,r,t)}function Eb(r,t){return Ae([],ab,r,t)}function xb(r,t){return Ae({},sb,r,t)}var aw=tb,ul={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]},sw=Object.freeze(Wh({__proto__:null,[Symbol.toStringTag]:"Module",default:ul},[ul]));function bb(r,t,e){return r*(1-e)+t*e}var wb=bb,Vh=ul,jo=wb,lw=Cb;function Cb(r){var t,e,n,i,o,a,s,l,u,c,f;if(r||(r={}),l=(r.nshades||72)-1,s=r.format||"hex",a=r.colormap,a||(a="jet"),typeof a=="string"){if(a=a.toLowerCase(),!Vh[a])throw Error(a+" not a supported colorscale");o=Vh[a]}else if(Array.isArray(a))o=a.slice();else throw Error("unsupported colormap option",a);if(o.length>l+1)throw new Error(a+" map requires nshades to be at least size "+o.length);Array.isArray(r.alpha)?r.alpha.length!==2?c=[1,1]:c=r.alpha.slice():typeof r.alpha=="number"?c=[r.alpha,r.alpha]:c=[1,1],t=o.map(function(g){return Math.round(g.index*l)}),c[0]=Math.min(Math.max(c[0],0),1),c[1]=Math.min(Math.max(c[1],0),1);var h=o.map(function(g,_){var x=o[_].index,T=o[_].rgb.slice();return T.length===4&&T[3]>=0&&T[3]<=1||(T[3]=c[0]+(c[1]-c[0])*x),T}),u=[];for(f=0;f<t.length-1;++f){i=t[f+1]-t[f],e=h[f],n=h[f+1];for(var d=0;d<i;d++){var p=d/i;u.push([Math.round(jo(e[0],n[0],p)),Math.round(jo(e[1],n[1],p)),Math.round(jo(e[2],n[2],p)),jo(e[3],n[3],p)])}}return u.push(o[o.length-1].rgb.concat(c[1])),s==="hex"?u=u.map(Sb):s==="rgbaString"?u=u.map(Ab):s==="float"&&(u=u.map(Rb)),u}function Rb(r){return[r[0]/255,r[1]/255,r[2]/255,r[3]]}function Sb(r){for(var t,e="#",n=0;n<3;++n)t=r[n],t=t.toString(16),e+=("00"+t).substr(t.length);return e}function Ab(r){return"rgba("+r.join(",")+")"}export{At as F,nw as G,ew as L,Bb as M,$b as T,Mr as V,zb as W,aw as a,iw as b,lw as c,Iy as d,Ip as e,kb as f,sw as g,vu as h,Gb as i,Nb as j,Fp as k,Mb as l,Lb as m,$t as n,ow as o,Ib as p,jb as q,Fb as r,tw as s,Pb as t,Ub as v,Db as w};
