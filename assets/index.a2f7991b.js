var B=Object.defineProperty;var M=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var U=(s,t,e)=>t in s?B(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,L=(s,t)=>{for(var e in t||(t={}))F.call(t,e)&&U(s,e,t[e]);if(M)for(var e of M(t))O.call(t,e)&&U(s,e,t[e]);return s};import{c as V,G as A,W,a as G,o as R,T as q,b as K,M as Z,d as J,V as Q,e as u,f as d,r as X,g as l,t as x,h as Y,i as w,w as f,v as $,j as g,k as c,F as E,l as I,m as h,p as ee,n as te,q as H,s as se,u as ae}from"./vendor.a0180028.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=e(a);fetch(a.href,n)}};ie();const k=["band",1];function N(s,t,e){return["/",["-",s,["var",t]],["-",["var",e],["var",t]]]}function v(s,t){return["band",1,s,t]}function P(s){const t=1/s.length,e=[];e.push(0),e.push([0,0,0,0]);for(let r=0;r<s.length;++r)e.push(r*t),e.push(s[r]);return e.push(1),e.push([0,0,0,0]),e}function le(s){return["-",s,["%",s,1]]}function D(s,t){return["abs",["-",s,t]]}function b(s,t,e){return le(["/",["+",s,["var",t]],["var",e]])}function ne(s,t="offset",e="spacing",r="min",a="max"){return["interpolate",["linear"],["*",["clamp",["+",D(b(["band",1],t,e),b(v(1,0),t,e)),D(b(["band",1],t,e),b(v(0,1),t,e))],0,1],N(k,r,a)],...P(s)]}function oe(s="vert",t="sunEl",e="sunAz"){const r=["*",2,["resolution"]],a=["*",["var",s],v(-1,0)],n=["*",["var",s],v(1,0)],o=["/",["-",n,a],r],i=["*",["var",s],v(0,-1)],p=["*",["var",s],v(0,1)],z=["/",["-",p,i],r],C=["atan",["^",["+",["^",o,2],["^",z,2]],.5]],T=["clamp",["atan",["-",0,o],z],-Math.PI,Math.PI],S=["*",Math.PI/180,["var",t]],j=["*",Math.PI/180,["var",e]],y=["+",["*",["sin",S],["cos",C]],["*",["*",["cos",S],["sin",C]],["cos",["-",j,T]]]];return["color",["*",255,y],["*",255,y],["*",255,y]]}function re(s,t="min",e="max"){return["interpolate",["linear"],N(k,t,e),...P(s)]}var _=(s,t)=>{const e=s.__vccOpts||s;for(const[r,a]of t)e[r]=a;return e};const ue={props:{variables:Object,tiffUrl:String},async mounted(){await this.initiateMap()},computed:{renderVariables(){if(this.variables.visualization=="relief")return{vert:this.variables.vert,sunEl:this.variables.sunEl,sunAz:this.variables.sunAz};if(this.variables.visualization=="contours")return{offset:this.variables.offset,spacing:this.variables.spacing,min:this.variables.min,max:this.variables.max};if(this.variables.visualization=="shaded")return{min:this.variables.min,max:this.variables.max}},renderStyle(){if(this.variables.visualization=="relief")return oe("vert","sunEl","sunAz");if(this.variables.visualization=="contours"){const s=V({colormap:this.variables.colorscale,format:"rgba",nshades:16});return ne(s,"offset","spacing","min","max")}else if(this.variables.visualization=="shaded"){const s=V({colormap:this.variables.colorscale,format:"rgba",nshades:16});return re(s,"min","max")}}},watch:{"variables.visualization"(){this.demLayer.setStyle({color:this.renderStyle,variables:this.renderVariables})},"variables.colorscale"(){this.variables.visualization!=="relief"&&this.demLayer.setStyle({color:this.renderStyle,variables:this.renderVariables})},renderVariables(s){this.demLayer.updateStyleVariables(s)}},methods:{resetDemSource(){this.demSource=new A({normalize:!1,sources:[{url:this.tiffUrl}]}),this.demSource.setAttributions("European Environment Agency (EAA)"),this.demLayer&&this.demLayer.setSource(this.demSource)},resetDemLayer(){this.demLayer&&this.map.removeLayer(this.demLayer),this.demLayer=new W({source:this.source,style:{variables:this.renderVariables,color:this.renderStyle}}),this.map.addLayer(this.demLayer)},async initiateMap(){const s=await fetch("https://tiles.maps.eox.at/wmts/1.0.0/WMTSCapabilities.xml"),t=new G().read(await s.text()),e="s2cloudless-2020",r=t.Contents.Layer.filter(i=>i.Identifier===e)[0].Abstract,a=R(t,{layer:e,matrixSet:"EPSG:4326"}),n=new q({source:new K(L({attributions:r},a))});this.source=new A({normalize:!1,sources:[{url:this.tiffUrl}]}),this.source.setAttributions("European Environment Agency (EAA)"),this.map=new Z({target:this.$refs.map,controls:J({attribution:!0}),layers:[n],view:new Q({projection:"EPSG:4326",center:[0,0],zoom:2})});const o=await this.source.getView();this.map.getView().fit(o.extent),this.resetDemLayer()}}},de={id:"map",ref:"map"};function ce(s,t,e,r,a,n){return u(),d("div",de,[X(s.$slots,"default")],512)}var me=_(ue,[["render",ce]]);const ve={props:{modelValue:Number,label:String,min:Number,max:Number,step:Number},methods:{handleInput(s){this.$emit("update:modelValue",parseInt(s.target.value))}}},fe={class:"mui-textfield",style:{display:"flex"}},he=["value","min","max","step"],be=["value","min","max","step"];function _e(s,t,e,r,a,n){return u(),d("div",fe,[l("input",{value:e.modelValue,type:"range",min:e.min,max:e.max,step:e.step,style:{cursor:"initial","flex-grow":"2"},onInput:t[0]||(t[0]=(...o)=>n.handleInput&&n.handleInput(...o))},null,40,he),l("input",{value:e.modelValue,type:"number",min:e.min,max:e.max,step:e.step,style:{width:"auto","flex-grow":"0","margin-left":"20px"},onInput:t[1]||(t[1]=(...o)=>n.handleInput&&n.handleInput(...o))},null,40,be),l("label",null,x(e.label),1)])}var pe=_(ve,[["render",_e],["__scopeId","data-v-1fb7a1ba"]]);const ye={props:{tiffUrl:String,variables:Object},components:{InputSlider:pe},data(){return{availableColormaps:Object.keys(Y).sort()}},mounted(){this.renderColorscalePreview()},methods:{renderColorscalePreview(){const s=this.variables.colorscale,t=this.$refs["colormap-preview"],e=t.getContext("2d"),r=48,a=V({colormap:s,nshades:r,format:"rgbaString"});t.width=480,t.height=90;for(let n=0;n<r;n++)e.fillStyle=a[n],e.fillRect(n*10,0,10,90)}},watch:{"variables.visualization"(s){s!=="relief"&&this.$nextTick(()=>{this.renderColorscalePreview()})},"variables.colorscale"(){this.renderColorscalePreview()}}},m=s=>(ee("data-v-1ce45a50"),s=s(),te(),s),Ve={class:"container mui-panel mui-container mui-form"},xe=m(()=>l("legend",null,"Visualization Settings",-1)),we={class:"mui-textfield"},ge=m(()=>l("label",null,"URL",-1)),ze={class:"mui-select"},Ce=m(()=>l("option",{value:"relief"},"Relief",-1)),Se=m(()=>l("option",{value:"contours"},"Contours",-1)),Me=m(()=>l("option",{value:"shaded"},"Shaded",-1)),Ue=[Ce,Se,Me],Le=m(()=>l("label",null,"Mode",-1)),Ae={key:0},Ee={key:1},Ie={class:"mui-row"},He={class:"mui-col-md-4"},ke={class:"mui-select"},Ne=["value"],Pe=m(()=>l("label",null," Colorscale ",-1)),De={class:"mui-col-md-8"},Te={ref:"colormap-preview",style:{width:"100%"}},je={key:2},Be={class:"mui-row"},Fe={class:"mui-col-md-4"},Oe={class:"mui-select"},We=["value"],Ge=m(()=>l("label",null," Colorscale ",-1)),Re={class:"mui-col-md-8"},qe={ref:"colormap-preview",style:{width:"100%"}};function Ke(s,t,e,r,a,n){const o=w("input-slider");return u(),d("div",Ve,[xe,l("div",we,[ge,f(l("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.tiffUrl=i),type:"text"},null,512),[[$,e.tiffUrl]])]),l("div",ze,[f(l("select",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.variables.visualization=i)},Ue,512),[[g,e.variables.visualization]]),Le]),e.variables.visualization=="relief"?(u(),d("div",Ae,[c(o,{modelValue:e.variables.vert,"onUpdate:modelValue":t[2]||(t[2]=i=>e.variables.vert=i),label:"Vertical Exaggeration",min:"1",max:"5"},null,8,["modelValue"]),c(o,{modelValue:e.variables.sunEl,"onUpdate:modelValue":t[3]||(t[3]=i=>e.variables.sunEl=i),label:"Sun Elevation",min:"0",max:"90"},null,8,["modelValue"]),c(o,{modelValue:e.variables.sunAz,"onUpdate:modelValue":t[4]||(t[4]=i=>e.variables.sunAz=i),label:"Sun Azimuth",min:"0",max:"360"},null,8,["modelValue"])])):e.variables.visualization=="contours"?(u(),d("div",Ee,[l("div",Ie,[l("div",He,[l("div",ke,[f(l("select",{"onUpdate:modelValue":t[5]||(t[5]=i=>e.variables.colorscale=i)},[(u(!0),d(E,null,I(a.availableColormaps,i=>(u(),d("option",{key:i,value:i},x(i),9,Ne))),128))],512),[[g,e.variables.colorscale]]),Pe])]),l("div",De,[l("canvas",Te,null,512)])]),c(o,{modelValue:e.variables.offset,"onUpdate:modelValue":t[6]||(t[6]=i=>e.variables.offset=i),label:"Offset",min:"0",max:"200"},null,8,["modelValue"]),c(o,{modelValue:e.variables.spacing,"onUpdate:modelValue":t[7]||(t[7]=i=>e.variables.spacing=i),label:"Spacing",min:"0",max:"500"},null,8,["modelValue"]),c(o,{modelValue:e.variables.min,"onUpdate:modelValue":t[8]||(t[8]=i=>e.variables.min=i),label:"Elevation Minimum",min:"0",max:"8800"},null,8,["modelValue"]),c(o,{modelValue:e.variables.max,"onUpdate:modelValue":t[9]||(t[9]=i=>e.variables.max=i),label:"Elevation Maximum",min:"0",max:"8800",step:"10"},null,8,["modelValue"])])):e.variables.visualization=="shaded"?(u(),d("div",je,[l("div",Be,[l("div",Fe,[l("div",Oe,[f(l("select",{"onUpdate:modelValue":t[10]||(t[10]=i=>e.variables.colorscale=i)},[(u(!0),d(E,null,I(a.availableColormaps,i=>(u(),d("option",{key:i,value:i},x(i),9,We))),128))],512),[[g,e.variables.colorscale]]),Ge])]),l("div",Re,[l("canvas",qe,null,512)])]),c(o,{modelValue:e.variables.min,"onUpdate:modelValue":t[11]||(t[11]=i=>e.variables.min=i),label:"Elevation Minimum",min:"0",max:"8800"},null,8,["modelValue"]),c(o,{modelValue:e.variables.max,"onUpdate:modelValue":t[12]||(t[12]=i=>e.variables.max=i),label:"Elevation Maximum",min:"0",max:"8800",step:"10"},null,8,["modelValue"])])):h("",!0)])}var Ze=_(ye,[["render",Ke],["__scopeId","data-v-1ce45a50"]]);const Je={name:"App",components:{Map:me,DemControl:Ze},data(){return{tiffUrl:"./src/assets/Copernicus_DSM_30_N03_00_E016_00_DEM.tif",variables:{visualization:"shaded",colorscale:"jet",min:360,max:700,offset:0,spacing:100,vert:1,sunEl:45,sunAz:45},showControls:window.innerWidth>700}}},Qe={id:"dem-control"},Xe={class:"ol-control",style:{top:"0",right:"0"}},Ye=l("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M3,17V19H9V17H3M3,5V7H13V5H3M13,21V19H21V17H13V15H11V21H13M7,9V11H3V13H7V15H9V9H7M21,13V11H11V13H21M15,9H17V7H21V5H17V3H15V9Z"})],-1),$e=[Ye],et=l("svg",{style:{width:"24px",height:"24px"},viewBox:"0 0 24 24"},[l("path",{fill:"currentColor",d:"M20,14H4V10H20"})],-1),tt=[et];function st(s,t,e,r,a,n){const o=w("DemControl"),i=w("Map");return u(),H(i,{variables:a.variables,tiffUrl:a.tiffUrl},{default:se(()=>[l("aside",Qe,[l("div",Xe,[a.showControls?h("",!0):(u(),d("button",{key:0,id:"expand-control",class:"mui-btn mui-btn--primary",onClick:t[0]||(t[0]=p=>a.showControls=!0)},$e))]),a.showControls?(u(),H(o,{key:0,variables:a.variables,tiffUrl:a.tiffUrl},null,8,["variables","tiffUrl"])):h("",!0),a.showControls?(u(),d("button",{key:1,id:"contract-control",class:"mui-btn",onClick:t[1]||(t[1]=p=>a.showControls=!1)},tt)):h("",!0)])]),_:1},8,["variables","tiffUrl"])}var at=_(Je,[["render",st]]);ae(at).mount("#app");
