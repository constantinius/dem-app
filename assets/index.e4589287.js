var G=Object.defineProperty;var A=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var E=(a,t,e)=>t in a?G(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,C=(a,t)=>{for(var e in t||(t={}))W.call(t,e)&&E(a,e,t[e]);if(A)for(var e of A(t))B.call(t,e)&&E(a,e,t[e]);return a};import{c as y,G as M,W as R,a as q,o as K,T as H,b as J,M as Q,d as X,V as Y,e as c,f as d,g as Z,h as s,w as r,v as m,i as w,t as u,F as b,r as V,j as x,k as v,p as $,l as ee,m as k,n as D,q as te}from"./vendor.5f2e7337.js";const se=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(n){if(n.ep)return;n.ep=!0;const l=e(n);fetch(n.href,l)}};se();const I=["band",1];function P(a,t,e){return["/",["-",a,["var",t]],["-",["var",e],["var",t]]]}function f(a,t){return["band",1,a,t]}function N(a){const t=1/a.length,e=[];e.push(0),e.push([0,0,0,0]);for(let o=0;o<a.length;++o)e.push(o*t),e.push(a[o]);return e.push(1),e.push([0,0,0,0]),e}function ae(a){return["-",a,["%",a,1]]}function T(a,t){return["abs",["-",a,t]]}function h(a,t,e){return ae(["/",["+",a,["var",t]],["var",e]])}function ie(a,t="offset",e="spacing",o="min",n="max"){return["interpolate",["linear"],["*",["clamp",["+",T(h(["band",1],t,e),h(f(1,0),t,e)),T(h(["band",1],t,e),h(f(0,1),t,e))],0,1],P(I,o,n)],...N(a)]}function ne(a="vert",t="sunEl",e="sunAz"){const o=["*",2,["resolution"]],n=["*",["var",a],f(-1,0)],l=["*",["var",a],f(1,0)],i=["/",["-",l,n],o],_=["*",["var",a],f(0,-1)],j=["*",["var",a],f(0,1)],U=["/",["-",j,_],o],S=["atan",["^",["+",["^",i,2],["^",U,2]],.5]],F=["clamp",["atan",["-",0,i],U],-Math.PI,Math.PI],L=["*",Math.PI/180,["var",t]],O=["*",Math.PI/180,["var",e]],p=["+",["*",["sin",L],["cos",S]],["*",["*",["cos",L],["sin",S]],["cos",["-",O,F]]]];return["color",["*",255,p],["*",255,p],["*",255,p]]}function le(a,t="min",e="max"){return["interpolate",["linear"],P(I,t,e),...N(a)]}var g=(a,t)=>{const e=a.__vccOpts||a;for(const[o,n]of t)e[o]=n;return e};const oe={props:{variables:Object,tiffUrl:String},async mounted(){await this.initiateMap()},computed:{renderVariables(){if(this.variables.visualization=="relief")return{vert:this.variables.vert,sunEl:this.variables.sunEl,sunAz:this.variables.sunAz};if(this.variables.visualization=="contours")return{offset:this.variables.offset,spacing:this.variables.spacing,min:this.variables.min,max:this.variables.max};if(this.variables.visualization=="shaded")return{min:this.variables.min,max:this.variables.max}},renderStyle(){if(this.variables.visualization=="relief")return ne("vert","sunEl","sunAz");if(this.variables.visualization=="contours"){const a=y({colormap:this.variables.colorscale,format:"rgba",nshades:16});return ie(a,"offset","spacing","min","max")}else if(this.variables.visualization=="shaded"){const a=y({colormap:this.variables.colorscale,format:"rgba",nshades:16});return le(a,"min","max")}}},watch:{"variables.visualization"(){this.resetDemLayer()},"variables.colorscale"(){this.variables.visualization!=="relief"&&this.resetDemLayer()},renderVariables(a){this.demLayer.updateStyleVariables(a)}},methods:{resetDemSource(){this.demSource=new M({normalize:!1,sources:[{url:this.tiffUrl}]}),this.demSource.setAttributions("European Environment Agency (EAA)"),this.demLayer&&this.demLayer.setSource(this.demSource)},resetDemLayer(){this.demLayer&&this.map.removeLayer(this.demLayer),this.demLayer=new R({source:this.source,style:{variables:this.renderVariables,color:this.renderStyle}}),this.map.addLayer(this.demLayer)},async initiateMap(){const a=await fetch("https://tiles.maps.eox.at/wmts/1.0.0/WMTSCapabilities.xml"),t=new q().read(await a.text()),e="s2cloudless-2020",o=t.Contents.Layer.filter(_=>_.Identifier===e)[0].Abstract,n=K(t,{layer:e,matrixSet:"EPSG:4326"}),l=new H({source:new J(C({attributions:o},n))});this.source=new M({normalize:!1,sources:[{url:this.tiffUrl}]}),this.source.setAttributions("European Environment Agency (EAA)"),this.map=new Q({target:this.$refs.map,controls:X({attribution:!0}),layers:[l],view:new Y({projection:"EPSG:4326",center:[0,0],zoom:2})});const i=await this.source.getView();this.map.getView().fit(i.extent),this.resetDemLayer()}}},re={id:"map",ref:"map"};function ue(a,t,e,o,n,l){return c(),d("div",re,null,512)}var ce=g(oe,[["render",ue]]);const de={props:{tiffUrl:String,variables:Object},data(){return{availableColormaps:Object.keys(Z).sort()}},mounted(){this.renderColorscalePreview()},methods:{renderColorscalePreview(){const a=this.variables.colorscale,t=this.$refs["colormap-preview"],e=t.getContext("2d"),o=48,n=y({colormap:a,nshades:o,format:"rgbaString"});t.width=480,t.height=40;for(let l=0;l<o;l++)e.fillStyle=n[l],e.fillRect(l*10,0,10,40)}},watch:{"variables.colorscale"(){this.renderColorscalePreview()}}},z=a=>($("data-v-52290972"),a=a(),ee(),a),ve={class:"input-row"},me=v(" URL "),fe=z(()=>s("option",{value:"relief"},"Relief",-1)),_e=z(()=>s("option",{value:"contours"},"Contours",-1)),be=z(()=>s("option",{value:"shaded"},"Shaded",-1)),he=[fe,_e,be],pe={key:0},ye={class:"input-row"},we=v(" Vertical Exaggeration "),xe={class:"input-value"},ge={class:"input-row"},ze=v(" Sun Elevation "),Ue={class:"input-value"},Se={class:"input-row"},Le=v(" Sun Azimuth "),Ae={class:"input-value"},Ee={key:1},Ce={class:"input-row"},Me=v(" Colorscale "),Ve=["value"],ke={key:0,ref:"colormap-preview"},De={class:"input-row"},Ie=v(" Offset "),Pe={class:"input-value"},Ne={class:"input-row"},Te=v(" Spacing "),je={class:"input-value"},Fe={class:"input-row"},Oe=v(" Elevation Minimum "),Ge={class:"input-value"},We={class:"input-row"},Be=v(" Elevation Maximum "),Re={class:"input-value"},qe={key:2},Ke={class:"input-row"},He=v(" Colorscale "),Je=["value"],Qe={key:0,ref:"colormap-preview"},Xe={class:"input-row"},Ye=v(" Elevation Minimum "),Ze={class:"input-value"},$e={class:"input-row"},et=v(" Elevation Maximum "),tt={class:"input-value"};function st(a,t,e,o,n,l){return c(),d(b,null,[s("div",ve,[s("label",null,[me,r(s("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>e.tiffUrl=i),type:"text"},null,512),[[m,e.tiffUrl]])])]),r(s("select",{"onUpdate:modelValue":t[1]||(t[1]=i=>e.variables.visualization=i)},he,512),[[w,e.variables.visualization]]),e.variables.visualization=="relief"?(c(),d("div",pe,[s("div",ye,[s("label",null,[we,r(s("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>e.variables.vert=i),type:"range",min:"1",max:"5"},null,512),[[m,e.variables.vert,void 0,{number:!0}]])]),s("span",xe,u(e.variables.vert),1)]),s("div",ge,[s("label",null,[ze,r(s("input",{"onUpdate:modelValue":t[3]||(t[3]=i=>e.variables.sunEl=i),type:"range",min:"0",max:"90"},null,512),[[m,e.variables.sunEl,void 0,{number:!0}]])]),s("span",Ue,u(e.variables.sunEl),1)]),s("div",Se,[s("label",null,[Le,r(s("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>e.variables.sunAz=i),type:"range",min:"0",max:"360"},null,512),[[m,e.variables.sunAz,void 0,{number:!0}]])]),s("span",Ae,u(e.variables.sunAz),1)])])):e.variables.visualization=="contours"?(c(),d("div",Ee,[s("div",Ce,[s("label",null,[Me,r(s("select",{"onUpdate:modelValue":t[5]||(t[5]=i=>e.variables.colorscale=i)},[(c(!0),d(b,null,V(n.availableColormaps,i=>(c(),d("option",{key:i,value:i},u(i),9,Ve))),128))],512),[[w,e.variables.colorscale]])]),e.variables.visualization!=="relief"?(c(),d("canvas",ke,null,512)):x("",!0)]),s("div",De,[s("label",null,[Ie,r(s("input",{"onUpdate:modelValue":t[6]||(t[6]=i=>e.variables.offset=i),type:"range",min:"0",max:"200"},null,512),[[m,e.variables.offset,void 0,{number:!0}]])]),s("span",Pe,u(e.variables.offset),1)]),s("div",Ne,[s("label",null,[Te,r(s("input",{"onUpdate:modelValue":t[7]||(t[7]=i=>e.variables.spacing=i),type:"range",min:"0",max:"500"},null,512),[[m,e.variables.spacing,void 0,{number:!0}]])]),s("span",je,u(e.variables.spacing),1)]),s("div",Fe,[s("label",null,[Oe,r(s("input",{"onUpdate:modelValue":t[8]||(t[8]=i=>e.variables.min=i),type:"range",min:"0",max:"8800"},null,512),[[m,e.variables.min,void 0,{number:!0}]])]),s("span",Ge,u(e.variables.min),1)]),s("div",We,[s("label",null,[Be,r(s("input",{"onUpdate:modelValue":t[9]||(t[9]=i=>e.variables.max=i),type:"range",min:"0",max:"8800",step:"10"},null,512),[[m,e.variables.max,void 0,{number:!0}]])]),s("span",Re,u(e.variables.max),1)])])):e.variables.visualization=="shaded"?(c(),d("div",qe,[s("div",Ke,[s("label",null,[He,r(s("select",{"onUpdate:modelValue":t[10]||(t[10]=i=>e.variables.colorscale=i)},[(c(!0),d(b,null,V(n.availableColormaps,i=>(c(),d("option",{key:i,value:i},u(i),9,Je))),128))],512),[[w,e.variables.colorscale]])]),e.variables.visualization!=="relief"?(c(),d("canvas",Qe,null,512)):x("",!0)]),s("div",Xe,[s("label",null,[Ye,r(s("input",{"onUpdate:modelValue":t[11]||(t[11]=i=>e.variables.min=i),type:"range",min:"0",max:"8800"},null,512),[[m,e.variables.min,void 0,{number:!0}]])]),s("span",Ze,u(e.variables.min),1)]),s("div",$e,[s("label",null,[et,r(s("input",{"onUpdate:modelValue":t[12]||(t[12]=i=>e.variables.max=i),type:"range",min:"0",max:"8800",step:"10"},null,512),[[m,e.variables.max,void 0,{number:!0}]])]),s("span",tt,u(e.variables.max),1)])])):x("",!0)],64)}var at=g(de,[["render",st],["__scopeId","data-v-52290972"]]);const it={name:"App",components:{Map:ce,DemControl:at},data(){return{tiffUrl:"./src/assets/Copernicus_DSM_30_N03_00_E016_00_DEM.tif",variables:{visualization:"shaded",colorscale:"jet",min:360,max:700,offset:0,spacing:100,vert:1,sunEl:45,sunAz:45}}}},nt={class:"cell cell-map"},lt={class:"cell cell-edit"},ot={class:"cell cell-inspect"};function rt(a,t,e,o,n,l){const i=k("Map"),_=k("DemControl");return c(),d(b,null,[s("div",nt,[D(i,{variables:n.variables,tiffUrl:n.tiffUrl},null,8,["variables","tiffUrl"])]),s("div",lt,[D(_,{variables:n.variables,tiffUrl:n.tiffUrl},null,8,["variables","tiffUrl"])]),s("div",ot,[s("div",null,u(n.tiffUrl)+u(n.variables),1)])],64)}var ut=g(it,[["render",rt]]);te(ut).mount("#app");
